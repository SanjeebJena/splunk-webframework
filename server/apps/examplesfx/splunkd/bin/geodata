#!/usr/bin/env node

http = require('http');
util = require('util');

http.get("http://earthquake.usgs.gov/earthquakes/feed/geojson/2.5/month", function(res) {
    body = [];
    
    res.on('data', function(data) {
        body.push(data);
    });
    
    res.on('end', function() {
        var features = JSON.parse(body.join("")).features;
        for(var i = 0, l = features.length; i < l; ++i) {
            feature = features[i];
            console.log([
                "timestamp=" + feature.properties.time,
                "latitude=" + feature.geometry.coordinates[1],
                "longitude=" + feature.geometry.coordinates[0],
                "depth=" + feature.geometry.coordinates[2],
                "magnitude=" + feature.properties.mag,
                "location='" + feature.properties.place + "'"
            ].join(" "));
        }
    });
    
}).on('error', function(e) {
    console.log("Got error: " + e.message);
});
