define("splunkjs/mvc/dataview",["require","exports","module","underscore","./mvc","./basesplunkview","./messages"],function(e,t,n){var r=e("underscore"),i=e("./mvc"),s=e("./basesplunkview"),o=e("./messages"),u=s.extend({moduleId:n.id,className:"splunk-dataview",options:{managerid:null,data:"preview",template:"",templateName:"",messages:!1},initialize:function(){this.configure(),this.settings.on("change:template",this.render,this),this.bindToComponent(this.settings.get("managerid"),this._onManagerChange,this)},_onManagerChange:function(e,t){this.manager&&(this.manager.off(null,null,this),this.manager=null),this.resultsModel&&(this.resultsModel.off(null,null,this),this.resultsModel.destroy(),this.resultsModel=null);if(!t){this.message("no-search");return}this.manager=t,this.resultsModel=t.data(this.settings.get("data"),{output_mode:"json"}),t.on("search:start",this._onSearchStart,this),t.on("search:progress",this._onSearchProgress,this),t.on("search:cancelled",this._onSearchCancelled,this),this.resultsModel.on("data",this.render,this)},_onSearchCancelled:function(){this.message("cancelled",this.$el)},_onSearchProgress:function(e,t){e=e||{};var n=e.content||{},r=n.resultPreviewCount||0,i=n.isDone||!1;if(r===0&&i){this.message("no-results",this.$el);return}if(r===0){this.message("waiting",this.$el);return}},_onSearchStart:function(){this.message("waiting",this.$el)},message:function(e){this.settings.get("messages")&&o.render(e,this.$el)},render:function(){if(!this.resultsModel||!this.resultsModel.hasData())return this;var e=this.settings.get("template")||"",t=this.settings.get("templateName")||"";e||$("#"+t).length>0&&(e=$("#"+t).html());var n=r.template(e,this.resultsModel.data());return this.$el.html(n),this}});return u});