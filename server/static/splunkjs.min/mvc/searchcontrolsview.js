define("views/shared/jobstatus/Spinner",["underscore","module","views/shared/WaitSpinner"],function(e,t,n){return n.extend({className:"pull-left",moduleId:t.id,initialize:function(){var t={top:"3",left:"3"};e.defaults(this.options,t),n.prototype.initialize.apply(this,arguments),this.model.entry.content.on("change:dispatchState change:isDone change:isPaused",this.debouncedRender,this)},render:function(){var e=!(this.model.entry.content.get("isDone")||this.model.entry.content.get("isPaused")||this.model.isNew());return this.active===e?this:(this.$el[e?"show":"hide"]()[e?"addClass":"removeClass"]("active"),this[e?"start":"stop"](),this.active=e,this)}})}),define("views/shared/jobstatus/Count",["underscore","module","views/Base","util/time_utils","splunk.i18n","splunk.util"],function(e,t,n,r,i,s){return n.extend({className:"status",moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.on("jobProgress prepared sync",this.render,this),this.model.on("destroy",this.empty,this)},empty:function(){return this.$el.empty(),this},render:function(){this.canvasLoader&&(this.canvasLoader.kill(),this.canvasLoader=null);var t=e("Starting job...").t(),n=this.model.entry.content.get("isRealTimeSearch");this.model.entry.content.get("isDone")?t=e("Complete").t():this.model.isFinalizing()?t=e("Finalizing job...").t():this.model.entry.content.get("isPaused")?t=e("Paused").t():n?t=e("Real-time").t():this.model.isQueued()?t=e("Queued").t():this.model.isParsing()&&(t=e("Parsing job...").t());var o="loader-"+this.cid,u=this.model.entry.content.get("earliestTime"),a=this.model.latestTimeSafe(),f=this.compiledTemplate({progress:t,earliest_date:u?r.isoToDateObject(u):new Date(0),latest_date:a?r.isoToDateObject(a):new Date(0),eventCount:i.format_decimal(this.model.entry.content.get("eventCount")||0),scanCount:i.format_decimal(this.model.entry.content.get("scanCount")||0),model:this.model,loaderId:o,time_utils:r,i18n:i,splunkUtil:s,_:e});return this.$el.html(f),this},template:'            <% if (!model.isNew()) { %>                <% if (model.entry.content.get("isDone")) { %>                    <%= splunkUtil.sprintf(i18n.ungettext("%s event", "%s events", eventCount), \'<span class="number">\' + eventCount + \'</span>\') %>                    <%if (model.entry.content.get("isFinalized")) { %>                        <%- splunkUtil.sprintf(_("(Partial results for %s to %s)").t(), i18n.format_datetime_microseconds(time_utils.jsDateToSplunkDateTimeWithMicroseconds(earliest_date), "short", "full"), i18n.format_datetime_microseconds(time_utils.jsDateToSplunkDateTimeWithMicroseconds(latest_date), "short", "full")) %>                    <% } else { %>                        <%- splunkUtil.sprintf(_("(%s to %s)").t(), i18n.format_datetime_microseconds(time_utils.jsDateToSplunkDateTimeWithMicroseconds(earliest_date), "short", "full"), i18n.format_datetime_microseconds(time_utils.jsDateToSplunkDateTimeWithMicroseconds(latest_date), "short", "full")) %>                    <% } %>                <% } else if (model.isRunning()) { %>                    <%= splunkUtil.sprintf(i18n.ungettext("%s of %s event matched", "%s of %s events matched", scanCount), \'<span class="number">\' + eventCount + \'</span>\', \'<span class="number">\' + scanCount + \'</span>\') %>                <% } else if (model.entry.content.get("isPaused")) { %>                    <i class="icon-alert icon-alert-paused"></i><%- _("Your search is paused.").t() %>                <% } else { %>                    <%- progress %>                <% } %>            <% } %>        '})}),define("views/shared/jobstatus/controls/Progress",["underscore","module","views/Base","bootstrap.tooltip"],function(e,t,n){return n.extend({moduleId:t.id,className:"progress-bar",tagName:"div",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.entry.content.on("change",this.render,this),this.model.on("change:id",this.render,this)},render:function(){this.el.innerHTML||(this.$el.html(this.compiledTemplate({_:e})),this.$(".progress-label-percentage").tooltip({animation:!1,title:e("Percentage of the time range scanned.").t()}));if(this.model.isNew())return this.$el.hide(),this;var t=this.model.entry.content.get("isRealTimeSearch");if(this.model.isRunning()&&!t){this.$el.show().children('span[class!="progress-label-percentage"]').hide();var n=(this.model.entry.content.get("doneProgress")*100).toFixed(1);this.$(".progress-animation").show().css("width",n+"%"),this.$(".progress-label-percentage").text(n+e("%").t()).show()}else this.$el.show().children().hide(),this.model.entry.content.get("isDone")?this.$(".progress-label-complete").show():this.model.isFinalizing()?(this.$(".progress-label-finalizing").show(),this.$(".progress-animation-wrapper").show().css("width","")):this.model.entry.content.get("isPaused")?this.$(".progress-label-paused").show():t?(this.$(".progress-animation-wrapper").show().css("width",""),this.$(".progress-label-realtime").show()):this.model.isQueued()?(this.$(".progress-animation-wrapper").show().css("width",""),this.$(".progress-label-queued").show()):this.model.isParsing()?(this.$(".progress-animation-wrapper").show().css("width",""),this.$(".progress-label-parsing").show()):this.$el.hide();return this},template:'                <div class="progress-animation"></div>                <span class="progress-label progress-label-complete"><%- _("Complete").t() %></span>                <span class="progress-label progress-label-finalizing"><%- _("Finalizing...").t() %></span>                <span class="progress-label progress-label-paused"><%- _("Paused").t() %></span>                <span class="progress-label progress-label-realtime"><%- _("Real-time").t() %></span>        		<span class="progress-label progress-label-queued"><%- _("Queued").t() %></span>        		<span class="progress-label progress-label-parsing"><%- _("Parsing").t() %></span>                <span class="progress-label progress-label-percentage"><%- _("0%").t() %></span>        '})}),define("views/shared/jobstatus/controls/Cancel",["underscore","module","views/Base"],function(e,t,n){return n.extend({moduleId:t.id,className:"cancel btn btn-small btn-square",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{click:function(){this.model.destroy(),this.model.clear()}},isActive:function(){return!this.model.isNew()&&!this.model.entry.content.get("isDone")},render:function(){return this.$el.html('<i class="icon-trash"></i><span class="hide-text">'+e("Cancel").t()+"</span>"),this}})}),define("views/shared/jobstatus/controls/Stop",["underscore","module","views/Base"],function(e,t,n){return n.extend({moduleId:t.id,className:"stop btn btn-small btn-square",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{click:function(){this.model.isQueued()||this.model.isParsing()?this.model.destroy({success:function(){this.model.clear()}.bind(this)}):this.model.finalize({success:function(){this.model.fetch()}.bind(this)})}},isActive:function(){return!this.model.isNew()&&!this.model.entry.content.get("isDone")},render:function(){return this.$el.html('<i class="icon-stop"></i><span class="hide-text">'+e("Stop").t()+"</span>"),this}})}),define("views/shared/jobstatus/controls/PlayPause",["jquery","underscore","module","views/Base"],function(e,t,n,r){return r.extend({moduleId:n.id,className:"playpause btn btn-small btn-square",tagName:"a",initialize:function(){r.prototype.initialize.apply(this,arguments),this.model.entry.content.on("change",this.render,this)},events:{click:function(t){var n=e(t.currentTarget).data("mode"),r={success:function(){this.model.fetch()}.bind(this)};n==="pause"?this.model.pause(r):n==="unpause"&&this.model.unpause(r)}},isActive:function(){return this.model.isRunning()||this.model.entry.content.get("isPaused")},render:function(){return this.model.entry.content.get("isPaused")?this.$el.data("mode","unpause").html('<i class="icon-play"></i><span class="hide-text">'+t("Unpause").t()+"</span>"):this.$el.data("mode","pause").html('<i class="icon-pause"></i><span class="hide-text">'+t("Pause").t()+"</span>"),this.$el.show(),this}})}),define("views/shared/jobstatus/controls/Reload",["underscore","module","views/Base"],function(e,t,n){return n.extend({moduleId:t.id,className:"reload btn btn-small btn-square",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{click:function(e){e.preventDefault(),this.model.trigger("reload")}},isActive:function(){return this.model.entry.content.get("isDone")},render:function(){return this.$el.html('<i class="icon-rotate-counter"></i><span class="hide-text">'+e("Reload").t()+"</span>"),this}})}),define("views/shared/jobstatus/controls/menu/Messages",["underscore","module","views/Base","util/splunkd_utils"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"job_messages",tagName:"ul",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.searchJob.on("serverValidated",this.checkMessages,this)},checkMessages:function(e,t,n){var i=r.filterMessagesByTypes(n,[r.INFO,r.WARNING]);i.length?this.showMessages(i):this.$el.empty()},showMessages:function(t){this.$el.empty(),e.each(t,function(t,n){this.$el.append(e.template(this.messagesTemplate,{message:t}))}.bind(this))},render:function(){return this.checkMessages(),this},messagesTemplate:'                <li class="job_message"><%- message.text %></li>            '})}),define("views/shared/jobstatus/controls/menu/EditModal",["underscore","backbone","module","views/shared/Modal","views/shared/FlashMessages","views/shared/controls/ControlGroup","uri/route","util/splunkd_utils","util/time_utils"],function(e,t,n,r,i,s,o,u,a){return r.extend({moduleId:n.id,initialize:function(){r.prototype.initialize.apply(this,arguments),this.model.inmem=this.model.searchJob.clone(),this.children.flashMessages=new i({model:this.model.inmem});var t=this.model.application.get("app"),n=this.model.application.get("owner"),u=this.model.inmem.entry.acl.permsToObj(),f=u.read;this.everyoneRead=e.indexOf(f,"*")!=-1,this.model.inmem.set("everyoneRead",this.everyoneRead),this.startTTL=this.model.inmem.entry.content.get("ttl"),this.defaultTTL=parseInt(this.model.searchJob.entry.content.get("defaultTTL"),10),this.defaultSaveTTL=parseInt(this.model.searchJob.entry.content.get("defaultSaveTTL"),10),this.linkToJob=o.search(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),{data:{sid:this.model.inmem.id},absolute:!0}),this.children.owner=new s({label:e("Owner").t(),controlType:"Label",controlOptions:{model:this.model.inmem.entry.acl,modelAttribute:"owner"}}),this.children.app=new s({label:e("App").t(),controlType:"Label",controlOptions:{model:this.model.inmem.entry.acl,modelAttribute:"app"}}),this.children.permissions=new s({label:e("Read Permissions").t(),controlType:"SyntheticRadio",controlOptions:{className:"btn-group btn-group-2",items:[{value:!1,label:e("Private").t()},{value:!0,label:e("Everyone").t()}],model:this.model.inmem,modelAttribute:"everyoneRead"}}),this.children.lifetime=new s({label:e("Lifetime").t(),controlType:"SyntheticRadio",tooltip:e("The job will be deleted if it's not accessed in its lifetime.  Calculated from the time the job finishes.").t(),controlOptions:{className:"btn-group btn-group-2",items:[{value:this.defaultTTL,label:a.getRelativeStringFromSeconds(this.defaultTTL,!0)},{value:this.defaultSaveTTL,label:a.getRelativeStringFromSeconds(this.defaultSaveTTL,!0)}],model:this.model.inmem.entry.content,modelAttribute:"ttl"}}),this.children.link=new s({label:e("Link To Job").t(),controlType:"Text",help:e("Copy or bookmark the link by right-clicking the icon, or drag the icon into your bookmarks bar.").t(),controlOptions:{defaultValue:this.linkToJob,append:'<a class="add-on bookmark" href="'+this.linkToJob+'"><i class="icon-bookmark ir">'+e("Splunk Search Job").t()+"</i></a>"}}),this.on("hidden",function(){this.model.searchJob.fetch()},this)},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){e.preventDefault();var t=this.model.inmem.get("everyoneRead"),n=this.model.inmem.entry.content.get("ttl"),r=this.model.inmem.entry.content.get("isRealTimeSearch"),i,s;this.everyoneRead!==t?t?i=this.model.inmem.makeWorldReadable():i=this.model.inmem.undoWorldReadable():i=!0,this.startTTL===n||n!==this.defaultTTL&&n!==this.defaultSaveTTL?s=!0:(n===this.defaultTTL&&(s=this.model.inmem.unsaveJob({auto_cancel:100})),n===this.defaultSaveTTL&&(r?s=this.model.inmem.saveJob({auto_cancel:100}):s=this.model.inmem.saveJob())),$.when(i,s).then(function(){this.hide()}.bind(this))},"click a.bookmark":function(e){e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Job Settings").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.owner.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.app.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.permissions.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.lifetime.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.link.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this}})}),define("views/shared/jobstatus/controls/menu/Edit",["underscore","module","views/Base","views/shared/jobstatus/controls/menu/EditModal"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"edit",tagName:"li",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{'click a[class!="disabled"]':function(e){this.children.editModal=new r({model:{searchJob:this.model.searchJob,application:this.model.application},onHiddenRemove:!0}),$("body").append(this.children.editModal.render().el),this.children.editModal.show(),e.preventDefault()},"click a.disabled":function(e){e.preventDefault()}},render:function(){var t=this.model.searchJob.entry.acl.canWrite();return t?this.$el.html('<a href="#">'+e("Edit Job Settings").t()+"</a>"):this.$el.html('<a href="#" class="disabled">'+e("Edit Job Settings").t()+"</a>"),this}})}),define("views/shared/jobstatus/controls/menu/sendbackgroundmodal/Settings",["underscore","module","views/Base","views/shared/controls/ControlGroup","views/shared/FlashMessages","views/shared/Modal","splunk.util","uri/route","util/console"],function(e,t,n,r,i,s,o,u,a){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.flashMessages=new i({model:{inmen:this.model.inmem}});var t="http://docs.splunk.com/";this.model.appLocal&&this.model.application?t=u.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email",this.model.application.get("app"),this.model.appLocal.entry.content.get("version"),this.model.appLocal.appAllowsDisable()):a.warn("The settings view needs the AppLocal and Application model passed to it"),this.children.email=new r({label:e("Email when complete").t(),controlType:"SyntheticCheckbox",controlOptions:{model:this.model.inmem,modelAttribute:"email",value:!0},help:o.sprintf(e("To send emails you must configure the settings in System Settings > Alert Email Settings. %s").t(),' <a href="'+t+'" target="_blank">'+e("Learn More").t()+"</a>")}),this.children.subject=new r({label:e("Email Subject Line").t(),controlType:"Text",controlOptions:{model:this.model.inmem,modelAttribute:"subject"}}),this.children.addresses=new r({label:e("Email Addresses").t(),controlType:"Textarea",controlOptions:{model:this.model.inmem,modelAttribute:"addresses"}}),this.model.inmem.on("change:email",function(){var e=this.model.inmem.get("email");e?(this.children.subject.$el.show(),this.children.addresses.$el.show()):(this.children.subject.$el.hide(),this.children.addresses.$el.hide())},this)},events:{"click .modal-btn-primary":function(e){e.preventDefault();var t=this.model.inmem.get("email"),n=this.model.inmem.get("subject"),r=this.model.inmem.get("addresses"),i,s,o;i=this.model.inmem.saveIsBackground(),t?s=this.model.inmem.saveJob({data:{email_list:r,email_subject:n}}):s=this.model.inmem.saveJob(),o=this.model.inmem.disablePreview(),$.when(i,s,o).then(function(){var e=this.model.inmem.fetch();$.when(e).then(function(){this.model.inmem.trigger("saveSuccess")}.bind(this))}.bind(this))}},render:function(){return this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(e("Send Job to Background").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.email.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.subject.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.addresses.render().el),this.children.subject.$el.hide(),this.children.addresses.$el.hide(),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append('<a class="btn btn-primary modal-btn-primary">'+e("Send to Background").t()+"</a>"),this}})}),define("views/shared/jobstatus/controls/menu/sendbackgroundmodal/Success",["underscore","module","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","uri/route","util/time_utils","splunk.util"],function(e,t,n,r,i,s,o,u){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments);var t=s.search(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),{data:{sid:this.model.inmem.id},absolute:!0});this.children.link=new i({label:e("Link To Job").t(),controlType:"Text",help:e("Copy or bookmark the link by right-clicking the icon, or drag the icon into your bookmarks bar.").t(),controlOptions:{defaultValue:t,append:'<a class="add-on bookmark" href="'+t+'"><i class="icon-bookmark ir">'+e("Splunk Search Job").t()+"</i></a>"}}),this.model.inmem.entry.content.on("change:ttl",this.updateTTL,this)},events:$.extend({},r.prototype.events,{"click a.bookmark":function(e){e.preventDefault()}}),updateTTL:function(){var e=this.model.inmem.entry.acl.get("ttl")||0,t=o.getRelativeStringFromSeconds(e,!0);this.$(".ttl").html(t)},render:function(){var t=this.compiledTemplate({_:e,splunkUtil:u});return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("The Job is Running in the Background").t()),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.link.render().el),this.$(r.BODY_SELECTOR).prepend(t),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_DONE),this.updateTTL(),this},template:'                <p>                    <%= splunkUtil.sprintf(_("The job&#39;s lifetime has been extended to %s.").t(), \'<span class="ttl">0</span>\') %>                </p>            '})}),define("views/shared/jobstatus/controls/menu/sendbackgroundmodal/Master",["underscore","backbone","module","views/shared/Modal","views/shared/jobstatus/controls/menu/sendbackgroundmodal/Settings","views/shared/jobstatus/controls/menu/sendbackgroundmodal/Success"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,initialize:function(){r.prototype.initialize.apply(this,arguments),this.model.inmem=this.model.searchJob.clone(),this.model.inmem.set({email:!1,results:"none",subject:e("Splunk Job Complete: $name$").t()}),this.children.settings=new i({model:{application:this.model.application,inmem:this.model.inmem,appLocal:this.model.appLocal}}),this.children.success=new s({model:{application:this.model.application,inmem:this.model.inmem}}),this.model.inmem.on("saveSuccess",function(){this.children.settings.$el.hide(),this.children.success.$el.show()},this),this.on("hidden",function(){this.model.inmem.isBackground()&&this.model.searchJob.trigger("close")},this)},render:function(){this.$el.append(this.children.settings.render().el),this.$el.append(this.children.success.render().el),this.children.success.$el.hide()}})}),define("views/shared/jobstatus/controls/menu/SendBackground",["underscore","module","views/Base","views/shared/jobstatus/controls/menu/sendbackgroundmodal/Master"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"send-background",tagName:"li",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.searchJob.entry.content.on("change",this.render,this)},events:{'click a[class!="disabled"]':function(e){this.children.sendBackgroundModal=new r({model:{searchJob:this.model.searchJob,application:this.model.application,appLocal:this.model.appLocal},onHiddenRemove:!0}),$("body").append(this.children.sendBackgroundModal.render().el),this.children.sendBackgroundModal.show(),e.preventDefault()},"click a.disabled":function(e){e.preventDefault()}},render:function(){var t=this.model.searchJob.entry.acl.canWrite(),n=this.model.searchJob.isBackground(),r=this.model.searchJob.entry.content.get("isRealTimeSearch");return this.$el.html('<a href="#">Send Job to Background</a>'),t&&this.model.searchJob.isRunning()&&!r&&!n?this.$el.html('<a href="#">'+e("Send Job to Background").t()+"</a>"):this.$el.html('<a href="#" class="disabled">'+e("Send Job to Background").t()+"</a>"),this}})}),define("views/shared/jobstatus/controls/menu/Inspect",["underscore","module","views/Base","uri/route","splunk.window"],function(e,t,n,r,i){return n.extend({moduleId:t.id,className:"inspect",tagName:"li",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{"click a":function(e){i.open(r.jobInspector(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),this.model.searchJob.id),"splunk_job_inspector",{width:870,height:560,menubar:!1}),e.preventDefault()}},render:function(){return this.$el.html('<a href="#">'+e("Inspect Job").t()+"</a>"),this}})}),define("views/shared/jobstatus/controls/menu/DeleteModal",["underscore","backbone","module","views/shared/Modal","views/shared/FlashMessages"],function(e,t,n,r,i){return r.extend({moduleId:n.id,initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.flashMessages=new i({model:this.model})},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.destroy({success:function(e,t){this.hide(),this.model.unset("id")}.bind(this)}),e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Delete Job").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append("<p>"+e("Are You Sure?").t()+"</p>"),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_DELETE),this}})}),define("views/shared/jobstatus/controls/menu/Delete",["underscore","module","views/Base","views/shared/jobstatus/controls/menu/DeleteModal"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"delete",tagName:"li",initialize:function(){n.prototype.initialize.apply(this,arguments)},events:{'click a[class!="disabled"]':function(e){this.children.deleteModal=new r({model:this.model.searchJob,onHiddenRemove:!0}),$("body").append(this.children.deleteModal.render().el),this.children.deleteModal.show(),e.preventDefault()},"click a.disabled":function(e){e.preventDefault()}},render:function(){var t=this.model.searchJob.entry.acl.canWrite();return t?this.$el.html('<a href="#">'+e("Delete Job").t()+"</a>"):this.$el.html('<a href="#" class="disabled">'+e("Delete Job").t()+"</a>"),this}})}),define("views/shared/jobstatus/controls/menu/Master",["underscore","module","views/Base","views/shared/jobstatus/controls/menu/Messages","views/shared/jobstatus/controls/menu/Edit","views/shared/jobstatus/controls/menu/SendBackground","views/shared/jobstatus/controls/menu/Inspect","views/shared/jobstatus/controls/menu/Delete","views/shared/delegates/Popdown","util/splunkd_utils"],function(e,t,n,r,i,s,o,u,a,f){return n.extend({moduleId:t.id,className:"job-menu btn-combo",initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.messages=new r({model:{searchJob:this.model.searchJob,application:this.model.application}}),this.children.edit=new i({model:{searchJob:this.model.searchJob,application:this.model.application}}),this.children.sendBackground=new s({model:{searchJob:this.model.searchJob,application:this.model.application,appLocal:this.model.appLocal}}),this.children.inspect=new o({model:{searchJob:this.model.searchJob,application:this.model.application}}),this.children.del=new u({model:{searchJob:this.model.searchJob,application:this.model.application}}),this.model.searchJob.on("serverValidated",this.checkMessages,this)},checkMessages:function(e,t,n){var r=f.messagesContainsOneOfTypes(n,[f.INFO]),i=f.messagesContainsOneOfTypes(n,[f.WARNING]);i?this.showMessageIndicator(f.WARNING):r?this.showMessageIndicator(f.INFO):(this.$(".message-indicator").hide(),this.children.messages.$el.hide())},showMessageIndicator:function(e){var t=f.normalizeType(e)=="info"?"icon-info-circle":"icon-alert";this.$(".message-indicator").attr("class","message-indicator "+t).show(),this.children.messages.$el.show()},render:function(){var t;return this.$el.html().length?this:(this.$el.html(this.compiledTemplate({_:e})),this.$(".dropdown-menu > .arrow").after(this.children.messages.render().el),t=this.$(".controls"),t.append(this.children.edit.render().el),t.append(this.children.sendBackground.render().el),t.append(this.children.inspect.render().el),this.options.allowDelete&&t.append(this.children.del.render().el),this.children.popdown=new a({el:this.el,attachDialogTo:"body"}),this.checkMessages(),this)},template:'                <a class="btn btn-small dropdown-toggle" href="#">                    <i class="message-indicator" style="display:none"></i>                    <%- _("Job").t() %><span class="caret"></span>                </a>                <div class="dropdown-menu">                    <div class="arrow"></div>                    <ul class="controls"></ul>                </div>            '})}),define("views/shared/jobstatus/controls/Master",["underscore","module","views/Base","views/shared/jobstatus/controls/Progress","views/shared/jobstatus/controls/Cancel","views/shared/jobstatus/controls/Stop","views/shared/jobstatus/controls/PlayPause","views/shared/jobstatus/controls/Reload","views/shared/jobstatus/controls/menu/Master","util/console"],function(e,t,n,r,i,s,o,u,a,f){return n.extend({moduleId:t.id,className:"views-shared-jobstatus-controls-master btn-group pull-right includes-job-menu",initialize:function(){n.prototype.initialize.apply(this,arguments),this.options.showJobMenu!==!1?this.children.menu=new a({model:{searchJob:this.model.searchJob,application:this.model.application,appLocal:this.model.appLocal},allowDelete:this.options.allowDelete}):this.$el.removeClass("includes-job-menu"),this.children.progress=new r({model:this.model.searchJob}),this.children.playPause=new o({model:this.model.searchJob}),this.children.stop=new s({model:this.model.searchJob}),this.options.enableReload&&(this.children.reload=new u({model:this.model.searchJob})),this.model.searchJob.entry.content.on("change",this.render,this)},render:function(){this.el.innerHTML||e.each(this.children,function(e){this.$el.append(e.render().$el)},this),this.model.searchJob.isNew()?this.$el.hide():this.$el.show();var t=[this.children.playPause,this.children.stop];return this.options.enableReload&&t.push(this.children.reload),e.each(t,function(e){e.isActive()?this.$el.append(e.$el):e.$el.detach()},this),this}})}),define("views/shared/jobstatus/buttons/ShareDialog",["jquery","underscore","module","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/jobstatus/controls/menu/EditModal","uri/route","util/time_utils","splunk.util"],function(e,t,n,r,i,s,o,u,a,f){return i.extend({moduleId:n.id,initialize:function(){r.prototype.initialize.apply(this,arguments),this.linkToJob=u.search(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),{data:{sid:this.model.searchJob.id},absolute:!0}),this.children.link=new s({label:t("Link To Job").t(),controlType:"Text",help:t("Copy or bookmark the link by right-clicking the icon, or drag the icon into your bookmarks bar.").t(),controlOptions:{defaultValue:this.linkToJob,append:'<a class="add-on bookmark" href="'+this.linkToJob+'"><i class="icon-bookmark ir">'+t("Splunk Search Job").t()+"</i></a>"}})},events:e.extend({},i.prototype.events,{"click .jobSettings":function(t){this.hide(),this.children.editModal=new o({model:{searchJob:this.model.searchJob,application:this.model.application},onHiddenRemove:!0}),e("body").append(this.children.editModal.render().el),this.children.editModal.show(),t.preventDefault()},"click a.bookmark":function(e){e.preventDefault()}}),render:function(){var e=this.model.searchJob.entry.acl.get("ttl")||0,n=a.getRelativeStringFromSeconds(e,!0),r=this.compiledTemplate({settingsAnchor:'<a class="jobSettings" href="#">'+t("Job&nbsp;Settings").t()+"</a>",time:n,_:t,splunkUtil:f});return this.$el.html(i.TEMPLATE),this.$(i.HEADER_TITLE_SELECTOR).html(t("Share Job").t()),this.$(i.BODY_SELECTOR).append(i.FORM_HORIZONTAL),this.$(i.BODY_FORM_SELECTOR).append(this.children.link.render().el),this.$(i.BODY_SELECTOR).prepend(r),this},template:'                <p>                    <%=  splunkUtil.sprintf(_("The job&#39;s lifetime has been extended to %s and read permissions have been set to Everyone. Manage the job via %s.").t(), time, settingsAnchor) %>                </p>            '})}),define("views/shared/jobstatus/buttons/ShareButton",["underscore","module","views/Base","views/shared/jobstatus/buttons/ShareDialog","bootstrap.tooltip"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"share btn btn-small btn-square disabled",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments),this.$el.html('<i class="icon-share"></i><span class="hide-text">'+e("Share").t()+"</span>"),this.$el.tooltip({animation:!1,title:e("Share").t(),container:"body"}),this.defaultSaveTTL=parseInt(this.model.searchJob.entry.content.get("defaultSaveTTL"),10),this.model.searchJob.entry.acl.on("change",this.render,this),this.model.searchJob.entry.content.on("change:ttl",this.render,this)},events:{click:function(e){var t=$(e.currentTarget),n=this.model.searchJob.entry.content.get("isRealTimeSearch"),i;e.preventDefault();if(t.hasClass("disabled"))return;n?i=this.model.searchJob.saveJob({auto_cancel:100}):i=this.model.searchJob.saveJob(),$.when(i).then(function(){this.model.searchJob.makeWorldReadable({success:function(){var e=this.model.searchJob.fetch();$.when(e).then(function(){this.children.shareDialog=new r({model:{searchJob:this.model.searchJob,application:this.model.application},onHiddenRemove:!0}),$("body").append(this.children.shareDialog.render().el),this.children.shareDialog.show()}.bind(this))}.bind(this)})}.bind(this))}},render:function(){var e=this.model.searchJob.entry.acl.canWrite(),t=this.model.searchJob.isSharedAccordingToTTL(this.defaultSaveTTL);return e?this.$el.removeClass("disabled"):this.$el.addClass("disabled"),this}})}),define("models/AlertAction",["underscore","models/SplunkDBase"],function(e,t){return t.extend({urlRoot:"configs/conf-alert_actions",getSetting:function(e,t){return this.entry.content.has(e)?this.entry.content.get(e):t},initialize:function(){t.prototype.initialize.apply(this,arguments)}})}),define("models/services/search/jobs/Control",["jquery","backbone","models/Base","util/splunkd_utils"],function(e,t,n,r){return n.extend({initialize:function(e,t){n.prototype.initialize.apply(this,arguments)},sync:function(n,i,s){var o={data:{output_mode:"json"}};switch(n){case"update":o.processData=!0,o.type="POST",o.url=r.fullpath(i.id),e.extend(!0,o,s);break;default:throw new Error("invalid method: "+n)}return t.sync.call(this,n,i,o)}})}),define("models/services/search/jobs/Summary",["jquery","underscore","backbone","models/Base","collections/Base","util/splunkd_utils"],function(e,t,n,r,i,s){var o=r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments)},isNumeric:function(){return this.get("numeric_count")>this.get("count")/2}}),u=i.extend({model:o}),a=r.extend({url:"",initialize:function(e,t){r.prototype.initialize.apply(this,arguments),this.initializeAssociated(),t&&t.splunkDPayload&&this.setFromSplunkD(t.splunkDPayload,{silent:!0})},initializeAssociated:function(){var e=this.constructor;this.associated=this.associated||{},this.fields=this.fields||new e.Fields,this.associated.fields=this.fields},sync:function(r,i,o){if(r!=="read")throw new Error("invalid method: "+r);o=o||{};var u={},a={data:{output_mode:"json"}},f=t.isFunction(i.url)?i.url():i.url||i.id;return o.data&&(u=e.extend(u,{app:o.data.app||undefined,owner:o.data.owner||undefined,sharing:o.data.sharing||undefined})),a.url=s.fullpath(f,u),e.extend(!0,a,o),delete a.data.app,delete a.data.owner,delete a.data.sharing,n.sync.call(this,r,i,a)},_fields:function(n){n=e.extend(!0,{},n);var r=[];return t.each(n,function(e,n){var i={name:n};t.each(e,function(e,t){i[t]=e}),r.push(i)},this),r},parse:function(t){t=e.extend(!0,{},t),this.initializeAssociated();if(!t)return{};var n=this._fields(t.fields);return delete t.fields,this.set(t),this.fields.reset(n),{}},setFromSplunkD:function(t,n){var r;t=e.extend(!0,{},t),this.attributes={},t&&(r=this._fields(t.fields),this.fields.reset(r,n),delete t.fields,this.set(t,n))},filterByMinFrequency:function(e){var t=this.get("event_count");return this.associated.fields.filter(function(n){return n.get("count")/t>=e})},frequency:function(e){var t=this.findByFieldName(e);return t?t.get("count")/this.get("event_count"):0},findByFieldName:function(e){return this.fields.where({name:e})[0]},distribution:function(e){var t,n=this.findByFieldName(e),r=this.get("histogram");if(!n)return[];t=n.get("histogram");if(!r||!t)return[];var i=Math.min(r.length,t.length),s=[],o=[],u;for(u=0;u<i;u++)s.push(t[u].count),o.push(r[u].count);var a=30,f,l;while(i>a){f=[],l=[];for(u=i-1;u>=0;u-=2)u>0?(f.unshift(s[u]+s[u-1]),l.unshift(o[u]+o[u-1])):(f.unshift(s[u]),l.unshift(o[u]));s=f,o=l,i=s.length}var c=[];for(u=0;u<i;u++)c.push(o[u]>0?Math.min(100,s[u]/o[u]*100):0);return c}},{Fields:u,Field:o});return a}),define("models/services/search/Job",["jquery","underscore","backbone","models/Base","models/ACLReadOnly","models/services/ACL","models/services/search/jobs/Control","models/services/search/jobs/Summary","util/splunkd_utils","splunk.util","util/console"],function(e,t,n,r,i,s,o,u,a,f,l){var c=function(t,n){var i=n,s=t,o=e.Deferred(),u=new r,l=new r,c={data:{rf:"*",auto_cancel:100,status_buckets:300,output_mode:"json"}},h={},p=this.getCustomDataPayload();n=n||{},n.data=n.data||{},h=e.extend(h,{app:n.data.app||undefined,owner:n.data.owner||undefined,sharing:n.data.sharing||undefined});var d=a.fullpath(t.url,h);return e.extend(!0,c.data,p||{}),e.extend(!0,c.data,n.data),delete c.data.app,delete c.data.owner,delete c.data.sharing,c.data.search&&(c.data.search=f.addLeadingSearchCommand(c.data.search,!0)),n.data=e.extend(!0,{},h),u.save({},{url:d,processData:!0,data:c.data,success:function(e,t,n){s.set("id",e.get("sid")),l.fetch({url:d+"/"+e.get("sid"),data:{output_mode:"json"},success:function(e,t,n){i.success.call(null,s,t,i),s.trigger("sync",s,t,i),o.resolve.apply(o,arguments)},error:function(e,t,n){i.error&&i.error.call(null,s,t,i),s.trigger("error",s,t,i),o.reject.apply(o,arguments)}})},error:function(e,t,n){i.error&&i.error.call(null,s,t,i),s.trigger("error",s,t,i),o.reject.apply(o,arguments)}}),o.promise()},h=function(t,r){var i={data:{output_mode:"json"}},s={};if(t.isNew())throw new Error("You cannot read a job without an id.");return r&&r.data&&(s=e.extend(s,{app:r.data.app||undefined,owner:r.data.owner||undefined,sharing:r.data.sharing||undefined})),i.url=a.fullpath(t.url+"/"+t.id,s),e.extend(!0,i,r||{}),delete i.data.app,delete i.data.owner,delete i.data.sharing,n.sync.call(this,"read",t,i)},p=function(t,r){var i={data:{output_mode:"json"}},s={},o=this.getCustomDataPayload();return r&&r.data&&(s=e.extend(s,{app:r.data.app||undefined,owner:r.data.owner||undefined,sharing:r.data.sharing||undefined})),e.extend(!0,i.data,o||{}),i.url=a.fullpath(t.url+"/"+t.id,s),i.processData=!0,i.type="POST",e.extend(!0,i,r||{}),delete i.data.app,delete i.data.owner,delete i.data.sharing,n.sync.call(this,"update",t,i)},d=function(t,r){var i={data:{output_mode:"json"}},s=t.url+"/"+t.id;return r.data&&r.data.output_mode?(i.url=a.fullpath(s,{})+"?output_mode="+encodeURIComponent(r.data.output_mode),delete r.data.output_mode):(i.url=a.fullpath(s,{})+"?output_mode="+encodeURIComponent(i.data.output_mode),delete i.data.output_mode),e.extend(!0,i,r),i.processData=!0,n.sync.call(this,"delete",t,i)},v=r.extend({url:"search/jobs",initialize:function(e,t){r.prototype.initialize.apply(this,arguments),this.initializeAssociated(),this.entry.links.on("change:control",function(){this.control.set("id",this.entry.links.get("control"))},this),this.entry.links.on("change:summary",function(){this.summary.set("id",this.entry.links.get("summary"))},this),this.entry.links.on("change:alternate",function(){var e=this.entry.links.get("alternate");e&&(e+="/acl"),this.acl.set("id",e)},this),t&&t.splunkDPayload&&this.setFromSplunkD(t.splunkDPayload,{silent:!0})},parseSplunkDMessages:function(e){var n=r.prototype.parseSplunkDMessages.call(this,e);if(e&&e.entry&&e.entry.length>0){var i=e.entry[0],s=i.content||{};n=t.union(n,a.parseMessagesObject(i.messages),a.parseMessagesObject(s.messages)),s.isZombie&&n.push(a.createMessageObject(a.FATAL,"Job terminated unexpectedly"))}return n},initializeAssociated:function(){var e=this.constructor;this.associated=this.associated||{},this.links=this.links||new e.Links,this.associated.links=this.links,this.generator=this.generator||new e.Generator,this.associated.generator=this.generator,this.paging=this.paging||new e.Paging,this.associated.paging=this.paging,this.entry||(this.entry=new e.Entry,this.entry.links=new e.Entry.Links,this.entry.associated.links=this.entry.links,this.entry.acl=new e.Entry.ACL,this.entry.associated.acl=this.entry.acl,this.entry.content=new e.Entry.Content,this.entry.content.performance=new e.Entry.Content.Performance,this.entry.content.associated.performance=this.entry.content.performance,this.entry.content.request=new e.Entry.Content.Request,this.entry.content.associated.request=this.entry.content.request,this.entry.content.runtime=new e.Entry.Content.Runtime,this.entry.content.associated.runtime=this.entry.content.runtime,this.entry.content.custom=new e.Entry.Content.Custom,this.entry.content.associated.custom=this.entry.content.custom,this.entry.associated.content=this.entry.content),this.associated.entry=this.entry,this.control=this.control||new o,this.associated.control=this.control,this.summary=this.summary||new u,this.associated.summary=this.summary,this.acl=this.acl||new s,this.associated.acl=this.acl},sync:function(e,t,n){switch(e){case"create":return c.call(this,t,n);case"read":return h.call(this,t,n);case"update":return p.call(this,t,n);case"delete":return d.call(this,t,n);default:throw new Error("invalid method: "+e)}},parse:function(t){t=e.extend(!0,{},t),this.initializeAssociated();if(!t||!t.entry||t.entry.length===0){l.log("Response has no content to parse");return}var n=t.entry[0];return this.id=n.content.sid,t.id=n.content.sid,this.links.set(t.links),delete t.links,this.generator.set(t.generator),delete t.generator,this.paging.set(t.paging),delete t.paging,this.entry.links.set(n.links),delete n.links,this.entry.acl.set(n.acl),delete n.acl,this.entry.content.performance.set(n.content.performance),delete n.content.performance,this.entry.content.request.set(n.content.request),delete n.content.request,this.entry.content.runtime.set(n.content.runtime),delete n.content.runtime,this.entry.content.custom.set(n.content.custom),delete n.content.custom,this.entry.content.set(n.content),delete n.content,this.entry.set(n),delete t.entry,t},setFromSplunkD:function(t,n){this.attributes={};var r=e.extend(!0,{},t),i=this.id;if(r){if(r.entry&&r.entry[0]){var s=r.entry[0];s.content&&(this.set({id:s.content.sid},{silent:!0}),r.id=s.content.sid,s.content.performance&&(this.entry.content.performance.set(s.content.performance,n),delete s.content.performance),s.content.request&&(this.entry.content.request.set(s.content.request,n),delete s.content.request),s.content.runtime&&(this.entry.content.runtime.set(s.content.runtime,n),delete s.content.runtime),s.content.custom&&(this.entry.content.custom.set(s.content.custom,n),delete s.content.custom),this.entry.content.set(s.content,n),delete s.content),s.links&&(this.entry.links.set(s.links,n),s.links.control&&this.control.set("id",s.links.control,n),s.links.summary&&this.summary.set("id",s.links.summary,n),s.links.alternate&&this.acl.set("id",s.links.alternate+"/acl",n),delete s.links),s.acl&&(this.entry.acl.set(s.acl,n),delete s.acl),this.entry.set(s,n),delete r.entry}r.links&&(this.links.set(r.links,n),delete r.links),r.generator&&(this.generator.set(r.generator,n),delete r.generator),r.paging&&(this.paging.set(r.paging,n),delete r.paging),this.set(r,n),this.id!==i&&this.trigger("change:"+this.idAttribute)}},toSplunkD:function(){var t={};return t=e.extend(!0,{},this.toJSON()),t.links=e.extend(!0,{},this.links.toJSON()),t.generator=e.extend(!0,{},this.generator.toJSON()),t.paging=e.extend(!0,{},this.paging.toJSON()),t.entry=[e.extend(!0,{},this.entry.toJSON())],t.entry[0].links=e.extend(!0,{},this.entry.links.toJSON()),t.entry[0].acl=e.extend(!0,{},this.entry.acl.toJSON()),t.entry[0].content=e.extend(!0,{},this.entry.content.toJSON()),t.entry[0].content.performance=e.extend(!0,{},this.entry.content.performance.toJSON()),t.entry[0].content.request=e.extend(!0,{},this.entry.content.request.toJSON()),t.entry[0].content.runtime=e.extend(!0,{},this.entry.content.runtime.toJSON()),t.entry[0].content.custom=e.extend(!0,{},this.entry.content.custom.toJSON()),delete t.id,t},getCustomDataPayload:function(){var n=e.extend(!0,{},this.entry.content.custom.toJSON()),r=t.keys(n);return t.each(r,function(e){var t="custom."+e;n[t]=n[e],delete n[e]}),n},canSummarize:function(){return f.normalizeBoolean(this.entry.content.get("canSummarize"))}},{QUEUED:"QUEUED",PARSING:"PARSING",RUNNING:"RUNNING",PAUSED:"PAUSED",FINALIZING:"FINALIZING",FAILED:"FAILED",DONE:"DONE",Links:r,Generator:r,Paging:r,Entry:r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments)}},{Links:r,ACL:i,Content:r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments)}},{Performance:r,Request:r,Runtime:r,Custom:r})})});return v}),define("util/Ticker",["underscore","backbone"],function(e,t){var n=function(e){this.delay=e||1e3};return e.extend(n.prototype,t.Events,{start:function(e){if(this._intervalId)return;e&&this.force(),this._intervalId=setInterval(function(){this.trigger("tick",(new Date).getTime())}.bind(this),this.delay)},stop:function(){this._intervalId&&(clearInterval(this._intervalId),delete this._intervalId)},reset:function(e){e||(e={}),this.stop(),e.delay&&(this.delay=e.delay),this.start(e.force)},force:function(){this.trigger("tick",(new Date).getTime()),this._intervalId&&this.reset()}}),n}),define("models/Job",["jquery","underscore","backbone","models/services/search/Job","helpers/polling_manager","util/splunkd_utils","util/time_utils","util/console","splunk.util","util/Ticker"],function(e,t,n,r,i,s,o,u,a,f){var l=1e3,c=6e4,h={delay:l,condition:function(e){return e.entry.content.get("isDone")!==!0&&e.entry.content.get("isFailed")!==!0}},p=function(e,t,n){this.observable=e,this.fetchParams=t||{};var r=e.fetch;e.fetch=function(t){return t=t||{},t.sid=n.id,r.call(e,t)},this.xhr=null};p.prototype={fetch:function(n){this.abortXhr();var r=t(this.fetchParams).isFunction()?this.fetchParams():this.fetchParams;this.xhr=this.observable.fetch(e.extend(!0,{},r,n))},destroy:function(){this.abortXhr(),this.observable instanceof n.Model?this.observable.clear():this.observable instanceof n.Collection&&this.observable.reset(),this.observable.trigger("destroy")},getObservable:function(){return this.observable},abortXhr:function(){this.xhr&&t(this.xhr.abort).isFunction()&&this.xhr.abort(),this.xhr=null}};var d=r.extend({initialize:function(t,n){r.prototype.initialize.apply(this,arguments),n=n||{},this.enableSimplePoller=n.enableSimplePoller||!1,this.pollingOptions=e.extend(!0,{},h,n),this.prepared=this.entry.content.get("dispatchState")&&!this.isPreparing(),this.processKeepAlive=n.processKeepAlive||!1,this.keepAlivePoller=null,this.keepAliveInterval=n.keepAliveInterval||c,this.entry.content.on("change",function(){var e=this.entry.content.changedAttributes(),t=this.entry.content.previousAttributes();this.handleJobProgress(e,t)},this),this.entry.content.on("change:dispatchState",function(){this.entry.content.get("dispatchState")&&!this.isPreparing()&&!this.prepared&&(this.prepared=!0,this.trigger("prepared"))},this),this.enableSimplePoller?(this.ticker=new f(parseInt(this.pollingOptions.delay/13,10)),this.ticker.on("tick",function(){this.safeFetch({data:{app:this.entry.acl.get("app"),owner:this.entry.acl.get("owner"),sharing:this.entry.acl.get("sharing")}})},this),this.entry.content.on("change:dispatchState",function(){this.entry.content.get("isDone")?this.ticker.stop():this.prepared&&this.ticker.reset({delay:this.pollingOptions.delay,force:!0})},this)):(this.jobPoller=i.getPoller(this,this.pollingOptions),this.childObjects=[],this.preserveChildrenOnDestroy=n.preserveChildrenOnDestroy||!1,this.entry.acl.on("change",function(){e.extend(this.jobPoller.options,{data:{app:this.entry.acl.get("app"),owner:this.entry.acl.get("owner"),sharing:this.entry.acl.get("sharing")}})},this)),this.error.on("change",function(){s.messagesContainsOneOfTypes(this.error.get("messages"),[s.NOT_FOUND])&&this.handleJobDestroy()},this),this.entry.content.on("change:isFailed",function(){this.entry.content.get("isFailed")===!0&&this.handleJobDestroy()},this),this.on("destroy",this.handleJobDestroy,this)},handleJobProgress:function(e,n){if(this.isNew())return!1;var r=this.entry.content.get("isRealTimeSearch"),i=this.entry.content.get("reportSearch"),o=this.getAdhocSearchMode()===s.VERBOSE,u=this.entry.content.get("isPreviewEnabled"),a=this.entry.content.get("isDone"),f=t.isEmpty(e);if(f||!a&&i&&!u&&!o)return!1;var l=!t(e.scanCount).isUndefined()&&e.scanCount>n.scanCount,c=!t(e.eventCount).isUndefined(),h=!t(e.resultCount).isUndefined(),p=!t(e.isDone).isUndefined()&&e.isDone===!0,d=l||c||h||p||r;return d?(this.trigger("jobProgress"),this.enableSimplePoller||this.fetchManagedChildren(),p&&this.processKeepAlive&&this.startKeepAlive(),!0):!1},handleJobDestroy:function(){this.enableSimplePoller||this.preserveChildrenOnDestroy||t(this.childObjects).each(function(e){e.destroy()}),this.stopPolling(),this.processKeepAlive=!1,this.stopKeepAlive()},startKeepAlive:function(){this.keepAlivePoller=new f(this.keepAliveInterval),this.keepAlivePoller.on("tick",function(){this.control.save({},{data:{action:"touch"},success:function(e,t,n){u.log("touched job:",e.id)}.bind(this),error:function(e,t,n){if(!(!t.hasOwnProperty("status")||t.status!=0&&t.status!=12029))return;u.log("error touching job (stopping keep alive):",e.id),this.keepAlivePoller.stop()}.bind(this)})},this),this.keepAlivePoller.start()},stopKeepAlive:function(){this.keepAlivePoller&&this.keepAlivePoller.stop()},startPolling:function(){this.enableSimplePoller?!this.entry.content.get("isDone")&&!this.entry.content.get("isFailed")&&this.ticker.start(!0):this.jobPoller.start()},stopPolling:function(){this.enableSimplePoller?this.ticker.stop():this.jobPoller.stop()},noParamControlUpdate:function(t,n){return n&&n.data&&delete n.data,this.control.save({},e.extend(!0,n,{data:{action:t}}))},pause:function(e){return this.noParamControlUpdate("pause",e)},unpause:function(e){return this.noParamControlUpdate("unpause",e)},finalize:function(e){return this.noParamControlUpdate("finalize",e)},cancel:function(e){return this.noParamControlUpdate("cancel",e)},touch:function(e){return this.noParamControlUpdate("touch",e)},setTTL:function(t,n){return n&&n.data&&delete n.data,this.control.save({},e.extend(!0,n,{data:{action:"setttl",ttl:t}}))},setPriority:function(t,n){return n&&n.data&&delete n.data,this.control.save({},e.extend(!0,n,{data:{action:"setpriority",priority:t}}))},enablePreview:function(e){return this.noParamControlUpdate("enablepreview",e)},disablePreview:function(e){return this.noParamControlUpdate("disablepreview",e)},saveControlUpdate:function(t,n){n=n||{},n.data=n.data||{};var r={action:t,auto_cancel:n.data.auto_cancel,auto_pause:n.data.auto_pause,email_list:n.data.email_list,email_subject:n.data.email_subject,email_results:n.data.email_results,ttl:n.data.ttl};return n&&n.data&&delete n.data,this.control.save({},e.extend(!0,n,{data:r}))},saveJob:function(e){return this.saveControlUpdate("save",e)},unsaveJob:function(e){return this.saveControlUpdate("unsave",e)},makeWorldReadable:function(t){var n=this.entry.acl.get("owner"),r={sharing:s.GLOBAL,owner:this.entry.acl.get("owner"),"perms.read":"*"};return t&&t.data&&delete t.data,this.acl.save({},e.extend(!0,t,{data:r}))},undoWorldReadable:function(t){var n=this.entry.acl.get("owner"),r={sharing:s.GLOBAL,owner:n,"perms.read":""};return t&&t.data&&delete t.data,this.acl.save({},e.extend(!0,t,{data:r}))},isSharedAccordingToTTL:function(e){var t=this.entry.acl.permsToObj();return t.read.indexOf("*")!=-1&&this.entry.content.get("ttl")===e?!0:!1},saveIsBackground:function(e){return this.entry.content.custom.set("isBackground","1"),this.save({},e)},isBackground:function(){return a.normalizeBoolean(this.entry.content.custom.get("isBackground"))},register:function(e,t){var n=new p(e,t,this);this.childObjects.push(n),this.entry.content.get("isDone")===!0&&n.fetch({sid:this.id})},fetchManagedChild:function(e){var n=t(this.childObjects).find(function(t){return t.getObservable()===e});if(!n)return u.error("Search Job Manager: can only refresh an object that has already been registered",e),!1;n.fetch({sid:this.id})},fetchManagedChildren:function(){t(this.childObjects).each(function(e){e.fetch({sid:this.id})}.bind(this))},resultCountSafe:function(){return this.entry.content.get("isPreviewEnabled")&&!this.entry.content.get("isDone")?this.entry.content.get("resultPreviewCount"):this.entry.content.get("resultCount")},eventAvailableCountSafe:function(){return this.entry.content.get("statusBuckets")==0?this.resultCountSafe():this.entry.content.get("eventAvailableCount")},latestTimeSafe:function(){var e=this.entry;return e.content.get("latestTime")||e.get("published")},isQueued:function(){return this.checkUppercaseValue("dispatchState",d.QUEUED)},isParsing:function(){return this.checkUppercaseValue("dispatchState",d.PARSING)},isFinalizing:function(){return this.checkUppercaseValue("dispatchState",d.FINALIZING)},isPreparing:function(){return this.isQueued()||this.isParsing()},isRunning:function(){return!this.isNew()&&!this.entry.content.get("isPaused")&&!this.entry.content.get("isDone")&&!this.isPreparing()&&!this.isFinalizing()},isReportSearch:function(){return this.entry.content.get("reportSearch")?!0:!1},isOverAllTime:function(){var e=this.entry.content.request;return!this.getDispatchEarliestTime()&&!this.getDispatchLatestTime()},isRealtime:function(){var e=this.entry.content.request;return o.isRealtime(this.getDispatchEarliestTime())&&o.isRealtime(this.getDispatchLatestTime())},checkUppercaseValue:function(e,t){var n=this.entry.content.get(e);return n?n.toUpperCase()===t:!1},getDispatchEarliestTime:function(){var e=this.entry.content.request.get("earliest_time");return e===void 0?this.entry.content.get("searchEarliestTime"):e},getDispatchLatestTime:function(){var e=this.entry.content.request.get("latest_time");return e===void 0?this.entry.content.get("searchLatestTime"):e},getSearch:function(){var e=this.entry.get("name");return e?e:this.entry.content.request.get("search")},getAdhocSearchMode:function(){var e=this.entry.content.request.get("adhoc_search_level"),t;if(!e){t=this.entry.content.get("delegate");if(this.entry.content.get("isSavedSearch")&&t==="scheduler")return s.FAST}return e}},{createMetaDataSearch:function(e,t,n){var r=new d({},{delay:4e3,enableSimplePoller:!0});return r.save({},{data:{app:n.get("app"),owner:n.get("owner"),search:e,preview:"true",earliest_time:"rt",latest_time:"rt",auto_cancel:100,max_count:1e5},success:function(e,n){t.resolve()},error:function(e,n){t.resolve()}}),r}});return d}),define("util/pdf_utils",["underscore","jquery","splunk.util","util/console","models/AlertAction","models/Job","splunk.config"],function(e,t,n,r,i,s,o){function c(n,i,u,a){var f=t.Deferred();return l().done(function(t){u=u.split(/[,\s]+/).join(",");var l={server:t.getSetting("mailserver","localhost"),use_ssl:t.getSetting("use_ssl","false"),use_tls:t.getSetting("use_tls","false"),to:u,sendpdf:"True",from:t.getSetting("from","splunk@localhost"),papersize:a.paperSize||"a2",paperorientation:a.paperOrientation||"portrait",pdfview:n},c="| sendemail "+e(l).map(function(e,t){return[t,JSON.stringify(e)].join("=")}).join(" ");r.log("Starting search %o",c);var h=new s;h.save({},{data:{search:c,earliest_time:"0",latest_time:"now",app:i,namespace:i,owner:o.USERNAME,ui_dispatch_app:i,ui_dispatch_view:n,preview:!1}}).done(e.bind(function(){h.startPolling(),h.entry.content.on("change:isDone",function(t,n){if(n){var i=h.entry.content.get("messages");e(i).each(function(e){e.type==="ERROR"&&r.error(e.text)}),e(i).any(function(e){return e.type==="ERROR"})?f.reject(e(i).pluck("text")[0]):f.resolve(),e.defer(e.bind(h.destroy,h))}}),h.entry.content.on("change:isFailed",function(t,n){n&&f.reject(),e.defer(e.bind(h.destroy,h))}),h.on("error",function(){f.reject("Error creating search job"),e.defer(e.bind(h.destroy,h))})},this)).fail(e.bind(function(){r.log("Search creation fail",arguments)},this))}).fail(function(){f.reject()}),f.promise()}function h(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var u="pdfgen",a="deprecated",f=e.once(function(e){var r=t.Deferred();return t.get(n.make_full_url("splunkd/__raw/services/pdfgen/is_available")).success(function(i){e!==undefined&&(i=e),i===u?r.resolve(!0,i):i==="deprecated"?t.getJSON(n.make_url("report/is_enabled")).success(function(e){e&&e.status=="enabled"?r.resolve(!0,a):r.reject(!1,e&&e.status)}).error(function(){r.reject(!1)}):r.reject(!1)}).error(function(){r.reject(!1)}),r.promise()}),l=e.once(function(){var e=t.Deferred(),n=new i({id:"email"});return n.fetch().done(function(){e.resolve(n)}).fail(function(){e.reject()}),e.promise()}),p=function(i,s,u){var a=n.make_full_url("splunkd/__raw/services/pdfgen/render"),f=t('<form method="POST" target="_blank"></form>').attr("action",a);t("<input/>").attr({type:"hidden",name:"input-dashboard-xml",value:h(i)}).appendTo(f),t("<input/>").attr({type:"hidden",name:"namespace",value:s}).appendTo(f),t("<input/>").attr({type:"hidden",name:"splunk_form_key",value:o.FORM_KEY}).appendTo(f),u&&e.each(u,function(e,n){t("<input/>").attr({type:"hidden",name:n,value:e}).appendTo(f)}),r.log("submitting form",f[0]),f.appendTo(document.body).submit(),e.defer(function(){f.remove()})},d=function(r,i,s,o){var l=t.Deferred();return f().done(function(t,f){var c=o?"input-"+o:"input-dashboard",h={namespace:i};h[c]=r,f===u?(s=e.extend(h,s||{}),l.resolve(n.make_full_url("splunkd/__raw/services/pdfgen/render",s))):f===a?l.resolve([n.make_url("app",i,r),n.propToQueryString({output:"pdf"})].join("?")):l.reject()}).fail(function(){l.reject()}),l.promise()};return{isPdfServiceAvailable:f,getRenderURL:d,downloadReportFromXML:p,getEmailAlertSettings:l,sendTestEmail:c}}),define("views/shared/jobstatus/buttons/ExportResultsDialog",["underscore","models/Base","module","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages","uri/route","util/pdf_utils","util/math_utils"],function(e,t,n,r,i,s,o,u,a){return r.extend({moduleId:n.id,initialize:function(n){r.prototype.initialize.apply(this,arguments);var f=t.extend({defaults:{fileName:"",format:"csv",limitResults:"unlimited",maxResults:1e3},validation:{maxResults:{fn:"validateMaxResults"}},validateMaxResults:function(t,n,r){if((r.format==="pdf"||r.limitResults==="limit")&&(!a.isInteger(t)||parseFloat(t)<=0))return e("Max results must be an integer greater than 0").t()}});this.model={searchJob:this.model.searchJob,application:this.model.application,report:this.model.report,inmem:new f},this.children.flashMessage=new s({model:this.model.inmem}),this.deferredPdfAvailable=$.Deferred(),this.deferredInitializeFormat=$.Deferred(),this.model.report?this.deferredPdfAvailable=u.isPdfServiceAvailable():this.deferredPdfAvailable.resolve(!1),$.when(this.deferredPdfAvailable).then(function(t){var n=[{label:e("CSV").t(),value:"csv"},{label:e("XML").t(),value:"xml"},{label:e("JSON").t(),value:"json"}];this.model.report&&t&&n.unshift({label:e("PDF").t(),value:"pdf"}),this.model.searchJob.isReportSearch()||n.unshift({label:e("Raw Events").t(),value:"raw"}),this.children.formatControl=new i({controlType:"SyntheticSelect",controlOptions:{modelAttribute:"format",model:this.model.inmem,items:n,save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0},label:e("Format").t()}),this.deferredInitializeFormat.resolve()}.bind(this)),this.children.filenameControl=new i({controlType:"Text",controlOptions:{modelAttribute:"fileName",model:this.model.inmem},label:e("File Name").t()}),this.children.limitResultsControl=new i({controlType:"SyntheticRadio",controlOptions:{modelAttribute:"limitResults",model:this.model.inmem,items:[{label:e("Unlimited").t(),value:"unlimited"},{label:e("Limited").t(),value:"limit"}],save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0},label:e("Number of Results").t()}),this.children.maxResultsControl=new i({controlType:"Text",controlOptions:{modelAttribute:"maxResults",model:this.model.inmem},label:e("Max Results").t()}),this.model.inmem.on("change:limitResults",this.toggleMaxResults,this),this.model.inmem.on("change:format",this.toggleByFormat,this),this.model.inmem.on("validated",function(e,t,n){if(e){var r=this.model.inmem.get("format"),i=this.model.inmem.get("maxResults"),s=this.model.inmem.get("limitResults")==="limit"?i:0;if(r==="pdf"){var a="",f=this.model.report.entry.content.get("action.email.reportPaperOrientation"),l=this.model.report.entry.content.get("action.email.reportPaperSize")||"a2";f==="landscape"&&(a="-landscape"),u.getRenderURL(this.model.report.entry.get("name"),this.model.report.entry.acl.get("app"),{sid:this.model.searchJob.id,"paper-size":l+a,"max-rows-per-table":i},"report").done(function(e){this.hide(),window.open(e)}.bind(this))}else window.location.href=o.exportUrl(this.model.application.get("root"),this.model.application.get("locale"),this.model.searchJob.get("id"),this.model.inmem.get("fileName"),this.model.inmem.get("format"),this.model.inmem.get("limitResults"),i,s,!!this.model.searchJob.entry.content.get("reportSearch")),this.hide()}},this)},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.inmem.validate(),e.preventDefault()}}),toggleByFormat:function(){this.model.inmem.get("format")==="pdf"?(this.children.filenameControl.$el.hide(),this.children.limitResultsControl.$el.hide(),this.children.maxResultsControl.$el.show()):(this.children.filenameControl.$el.show(),this.children.limitResultsControl.$el.show(),this.toggleMaxResults())},toggleMaxResults:function(){this.model.inmem.get("limitResults")==="unlimited"?this.children.maxResultsControl.$el.hide():this.children.maxResultsControl.$el.show()},render:function(){$.when(this.deferredInitializeFormat).then(function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Export Results").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL_JUSTIFIED),this.$(r.BODY_FORM_SELECTOR).append(this.children.formatControl.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.filenameControl.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.limitResultsControl.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.maxResultsControl.render().el),this.toggleByFormat(),this.toggleMaxResults(),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Export").t()+"</a>"),this}.bind(this))}})}),define("views/shared/jobstatus/buttons/ExportButton",["underscore","module","views/Base","views/shared/jobstatus/buttons/ExportResultsDialog","bootstrap.tooltip"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"export btn btn-small btn-square",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments),this.$el.html('<i class="icon-export"></i><span class="hide-text">'+e("Export").t()+"</span>"),this.$el.tooltip({animation:!1,title:e("Export").t(),container:"body"})},events:{click:function(e){this.children.exportDialog=new r({model:{searchJob:this.model.searchJob,application:this.model.application,report:this.model.report},onHiddenRemove:!0}),$("body").append(this.children.exportDialog.render().el),this.children.exportDialog.show(),e.preventDefault()}},render:function(){return this}})}),define("views/shared/jobstatus/buttons/PrintButton",["underscore","module","views/Base","helpers/Printer","bootstrap.tooltip"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"print btn btn-small btn-square",tagName:"a",initialize:function(){n.prototype.initialize.apply(this,arguments),this.$el.html('<i class="icon-print"></i><span class="hide-text">'+e("Print").t()+"</span>"),this.$el.tooltip({animation:!1,title:e("Print").t(),container:"body"})},events:{click:function(e){return r.printPage(),!1}},render:function(){return this}})}),define("views/shared/jobstatus/buttons/Master",["module","views/Base","views/shared/jobstatus/buttons/ShareButton","views/shared/jobstatus/buttons/ExportButton","views/shared/jobstatus/buttons/PrintButton"],function(e,t,n,r,i){return t.extend({moduleId:e.id,className:"pull-right export-print-group btn-group",initialize:function(){t.prototype.initialize.apply(this,arguments),this.children.shareButton=new n({model:{searchJob:this.model.searchJob,application:this.model.application}}),this.children.exportButton=new r({model:{searchJob:this.model.searchJob,application:this.model.application,report:this.model.report}}),this.children.printButton=new i},render:function(){return this.$el.append(this.children.shareButton.render().el),this.$el.append(this.children.exportButton.render().el),this.$el.append(this.children.printButton.render().el),this}})}),define("views/shared/jobstatus/SearchMode",["underscore","module","views/shared/controls/SyntheticSelectControl","util/splunkd_utils"],function(e,t,n,r){return n.extend({className:"btn-group pull-right",moduleId:t.id,initialize:function(t){t.items=[{value:r.FAST,label:e("Fast Mode").t(),icon:"lightning",description:e("Field discovery off for event searches. No event or field data for stats searches.").t()},{value:r.SMART,label:e("Smart Mode").t(),icon:"bulb",description:e("Field discovery on for event searches. No event or field data for stats searches.").t()},{value:r.VERBOSE,label:e("Verbose Mode").t(),icon:"speech-bubble",description:e("All event & field data.").t()}],t.modelAttribute="display.page.search.mode",t.defaultValue=r.SMART,n.prototype.initialize.call(this,t)},template:'                <a class="btn dropdown-toggle btn-small dropdown-toggle-search-mode"  href="#">                    <% if (item.icon) { %> <i class="icon-<%-item.icon%> icon-large"></i><% } %>                    <span class="link-label"><%- item.label %></span><span class="caret"></span>                </a>                <div class="dropdown-menu dropdown-menu-search-mode">                    <div class="arrow"></div>                    <ul>                        <% _.each(items, function(element, index, list) { %>                            <li>                                <a href="#" data-value="<%- element.value %>">                                    <i class="icon-check"></i>                                    <i class="icon-<%-element.icon%> link-icon"></i>                                    <span class="link-label"><%- element.label %></span>                                    <span class="link-description"><%- element.description %></span>                                </a>                            </li>                        <% }); %>                    </ul>                </div>            '})}),define("views/shared/jobstatus/AutoPause",["underscore","module","views/Base","util/splunkd_utils","splunk.util","splunk.i18n"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.autoPauseInterval=parseInt(this.model.searchJob.entry.content.runtime.get("auto_pause"),10)*1e3,this.autoPauseStartTime=new Date,this.model.searchJob.entry.content.on("change:isDone change:isPaused",this.debouncedRender,this),this.model.searchJob.on("sync",this.render,this)},events:{"click a.auto-pause-cancel":function(e){e.preventDefault(),this.model.searchJob.saveJob({data:{auto_pause:0},success:function(e,t){this.remove()}.bind(this)})}},render:function(){if(this.model.searchJob.isNew()||this.model.searchJob.entry.content.get("isDone")||this.model.searchJob.entry.content.get("isPaused")||parseInt(this.model.searchJob.entry.content.runtime.get("auto_pause"),10)===0)this.$el.hide(),this.remove();else{var t=parseInt(new Date-this.autoPauseStartTime,10),n=Math.round((this.autoPauseInterval-t)/1e3),r=this.compiledTemplate({_:e,i18n:s,splunkUtil:i,timeRemaining:n});this.el.innerHTML=r}return this},template:'                <div class="alert alert-warning">                    <i class="icon-alert"></i>                    <%- splunkUtil.sprintf(i18n.ungettext("Your search will automatically pause in %s second.", "Your search will automatically pause in %s seconds.", timeRemaining), timeRemaining) %>                    <a href="#" class="auto-pause-cancel"><%- _("Do not pause").t() %></a>                </div>            '})}),define("views/shared/jobstatus/Master",["underscore","module","models/classicurl","views/Base","views/shared/jobstatus/Spinner","views/shared/jobstatus/Count","views/shared/jobstatus/controls/Master","views/shared/jobstatus/buttons/Master","views/shared/jobstatus/SearchMode","views/shared/jobstatus/AutoPause","uri/route","splunk.window","splunk.util","util/splunkd_utils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return r.extend({moduleId:t.id,initialize:function(){r.prototype.initialize.apply(this,arguments),this.errorTypes=[p.FATAL,p.ERROR,p.NOT_FOUND];var t={allowDelete:!0};e.defaults(this.options,t),this.options.enableSearchMode&&(this.children.searchMode=new a({model:this.model.state,btnClass:"btn-mini",rightAlign:!0})),this.options.showJobButtons!==!1&&(this.children.buttons=new u({model:{searchJob:this.model.searchJob,application:this.model.application,report:this.model.report}})),this.children.controls=new o({showJobMenu:this.options.showJobMenu,allowDelete:this.options.allowDelete,enableReload:this.options.enableReload,model:{searchJob:this.model.searchJob,application:this.model.application,appLocal:this.model.appLocal}}),this.children.count=new s({model:this.model.searchJob}),this.children.spinner=new i({model:this.model.searchJob}),this.options.showAutoPause&&(this.children.autoPause=new f({model:{searchJob:this.model.searchJob}})),this.model.searchJob.on("sync error",function(){var e=this.model.searchJob.error.get("messages");p.messagesContainsOneOfTypes(e,this.errorTypes)&&this.renderError(e)},this),this.model.searchJob.control.on("error",function(){var e=this.model.searchJob.control.error.get("messages");p.messagesContainsOneOfTypes(e,this.errorTypes)&&this.renderError(e)},this)},events:{"click a.job_inspector":function(e){c.open(l.jobInspector(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),this.model.searchJob.id),"splunk_job_inspector",{width:870,height:560,menubar:!1}),e.preventDefault()}},render:function(){return p.messagesContainsOneOfTypes(this.model.searchJob.error.get("messages"),this.errorTypes)?this.renderError():(this.options.showAutoPause&&this.$el.append(this.children.autoPause.render().el),this.options.enableSearchMode&&this.$el.append(this.children.searchMode.render().el),this.options.showJobButtons!==!1&&this.$el.append(this.children.buttons.render().el),this.$el.append(this.children.controls.render().el),this.$el.append(this.children.spinner.render().el),this.$el.append(this.children.count.render().el),this)},renderError:function(t){var n='<a class="job_inspector" href="#">'+e("Job Inspector").t()+"</a>",r=this.model.searchJob.id||e("unknown").t(),i,s;return p.messagesContainsOneOfTypes(t,[p.NOT_FOUND])?i=h.sprintf(e('The search job "%s" was canceled remotely or expired.').t(),r):i=h.sprintf(e("The search job has failed due to an error. You may be able view the job in the %s.").t(),n),s=e.template(this.errorTemplate,{_:e,link:n,splunkUtil:h,error:i}),this.el.innerHTML=s,this},errorTemplate:'                <div class="alert alert-error">                    <i class="icon-alert"></i>                    <%= error %>                </div>            ',notFoundTemplate:'                <div class="alert alert-error">                    <i class="icon-alert"></i>                    <%= splunkUtil.sprintf(_("The job has failed due to an error. You may be able view the job in the %s.").t(), link) %>                </div>            '})}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.addBuffer("splunkjs/css/bunny-button.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,define("splunkjs/mvc/searchcontrolsview",["require","exports","module","underscore","backbone","./mvc","./basesplunkview","views/shared/jobstatus/Master","models/ACLReadOnly","models/Application","splunk.config","./utils","util/time_utils","./sharedmodels","css!../css/bunny-button"],function(e,t,n){var r=e("underscore"),i=e("backbone"),s=e("./mvc"),o=e("./basesplunkview"),u=e("views/shared/jobstatus/Master"),a=e("models/ACLReadOnly"),f=e("models/Application"),l=e("splunk.config"),c=e("./utils"),h=e("util/time_utils"),p=e("./sharedmodels");e("css!../css/bunny-button");var d=i.Model.extend({constructor:function(){this.control=new i.Model,this.error=new i.Model,this.entry=new i.Model,this.entry.content=new i.Model,this.entry.content.custom=new i.Model,this.entry.acl=new a,i.Model.prototype.constructor.apply(this,arguments)},initialize:function(){this._isNew=!0},set:function(){i.Model.prototype.set.apply(this,arguments),i.Model.prototype.set.apply(this.entry.content,arguments)},isNew:function(){return this._isNew},fetch:function(){return this},clear:function(){this.entry.clear(),this.entry.content.clear(),this.entry.content.custom.clear(),this._isNew=!0},destroy:function(e){this.cancel(),e.success&&e.success()},pause:function(e){this.manager&&this.manager.pause()},unpause:function(e){this.manager&&this.manager.unpause()},finalize:function(e){this.manager&&this.manager.finalize()},cancel:function(e){this.manager&&this.manager.cancel()},touch:function(e){this.manager&&this.manager.touch()},saveIsBackground:function(e){this.entry.content.custom.set("isBackground","1")},isBackground:function(){return this.entry.content.custom.get("isBackground")==="1"},resultCountSafe:function(){return this.entry.content.get("isPreviewEnabled")&&!this.entry.content.get("isDone")?this.entry.content.get("resultPreviewCount"):this.entry.content.get("resultCount")},eventAvailableCountSafe:function(){return this.entry.content.get("statusBuckets")==0?this.resultCountSafe():this.entry.content.get("eventAvailableCount")},latestTimeSafe:function(){var e=this.entry;return e.content.get("latestTime")||e.get("published")},isQueued:function(){return this.checkUppercaseValue("dispatchState",d.QUEUED)},isParsing:function(){return this.checkUppercaseValue("dispatchState",d.PARSING)},isFinalizing:function(){return this.checkUppercaseValue("dispatchState",d.FINALIZING)},isPreparing:function(){return this.isQueued()||this.isParsing()},isRunning:function(){return!this.isNew()&&!this.entry.content.get("isPaused")&&!this.entry.content.get("isDone")&&!this.isPreparing()&&!this.isFinalizing()},isAdHocLevelFast:function(){return this.checkUppercaseValue("adhoc_search_level","FAST")},isReportSearch:function(){return this.entry.content.get("reportSearch")?!0:!1},isOverAllTime:function(){var e=this.entry.content.request;return!e.get("earliest_time")&&!e.get("latest_time")},isRealtime:function(){var e=this.entry.content.request;return h.isRealtime(e.get("earliest_time"))&&h.isRealtime(e.get("latest_time"))},checkUppercaseValue:function(e,t){var n=this.entry.content.get(e);return n?n.toUpperCase()===t:!1}},{QUEUED:"QUEUED",PARSING:"PARSING",RUNNING:"RUNNING",PAUSED:"PAUSED",FINALIZING:"FINALIZING",FAILED:"FAILED",DONE:"DONE"}),v=o.extend({moduleId:n.id,className:"splunk-searchcontrols",options:{managerid:null},initialize:function(){this.configure();var e=c.getPageInfo();this._searchJob=new d,this._state=new i.Model({"display.page.search.mode":"smart"});var t=p.get("app"),n=p.get("appLocal"),r=this;this._statusDfd=$.when(n.dfd).done(function(){r.jobStatus=new u({model:{searchJob:r._searchJob,state:r._state,application:t,appLocal:n},collection:{limits:new i.Collection},enableSearchMode:!0,showAutoPause:!1,showJobButtons:!1})}),this.bindToComponent(this.settings.get("managerid"),this.onManagerChange,this),this._state.on("change",this._onSearchModeChange,this)},onManagerChange:function(e,t){this.manager&&(this.manager.off(null,null,this),this.manager.search.off(null,null,this)),this.manager=t,t&&(this._searchJob.manager=t,t.on("search:start",this._onSearchStart,this),t.on("search:cancelled",this._onSearchCancelled,this),t.on("search:failed",this._onSearchFailed,this),t.on("search:progress",this._onSearchProgress,this),this.manager.search.get("adhoc_search_level")?this._state.set("display.page.search.mode",this.manager.search.get("adhoc_search_level")):this._onSearchModeChange())},render:function(){var e=this;return $.when(this._statusDfd).done(function(){e.$el.append(e.jobStatus.render().el)}),this},_onSearchModeChange:function(){var e=this._state.get("display.page.search.mode");e&&this.manager&&this.manager.search.set("adhoc_search_level",e)},_onSearchStart:function(e){this._searchJob._isNew=!0,this._searchJob.clear()},_onSearchCancelled:function(e){this._searchJob._isNew=!0,this._searchJob.clear()},_onSearchFailed:function(e){this._searchJob._isNew=!0,this._searchJob.clear()},_onSearchProgress:function(e){this._searchJob._isNew=!1,this._searchJob.entry.set(e),this._searchJob.entry.content.set(e.content),this._searchJob.entry.acl.set(e.acl),this._searchJob.trigger("jobProgress"),e.content&&e.content.sid&&(this._searchJob.id=e.content.sid);var t=this;$.when(this._statusDfd).done(function(){r.each(t.jobStatus.children.controls.children.menu.children,function(e){e.render()})})}});return v}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.setBuffer('/*!\n * Splunk shoestrap\n * import and override bootstrap vars & mixins\n */\n.clearfix {\n  *zoom: 1;\n}\n.clearfix:before,\n.clearfix:after {\n  display: table;\n  content: "";\n  line-height: 0;\n}\n.clearfix:after {\n  clear: both;\n}\n.hide-text {\n  font: 0/0 a;\n  color: transparent;\n  text-shadow: none;\n  background-color: transparent;\n  border: 0;\n}\n.input-block-level {\n  display: block;\n  width: 100%;\n  min-height: 26px;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.ie7-force-layout {\n  *min-width: 0;\n}\n/* ad hoc search mode selector\n    overview: button + dropdown + synthetic select\n    FIXME: why does this not use data-toggle and open class?\n    also why does this not use either dropdown or popdown or synthetic select?\n    TODO: does this need btn-group? maybe just use relative container\n\n    <div class="btn-group view-searchmode">\n        <a href="#" class="btn btn-small dropdown-toggle dropdown-toggle-search-mode" data-toggle="dropdown">\n            <i class="icon-bulb"></i>\n            <span class="link-label">Smart Mode</span>\n        </a>\n        <div class="dropdown-menu dropdown-menu-search-mode" style="display:block;">\n            <div class="arrow"></div>\n            <ul>\n                <li>\n                    <a data-value="fast" href="#">\n                        <span class="link-label">Fast Mode</span>\n                        <span class="link-description">\n                            Field discovery on for event searches. No event or field data for stats searches.\n                        </span>\n                    </a>\n                </li>\n                <li>\n                    <a data-value="smart" href="#">\n                        <span class="link-label">Smart Mode</span>\n                        <span class="link-description">\n                            Field discovery off for event searches. No event or field data for stats searches.\n                        </span>\n                    </a>\n                </li>\n                <li>\n                    <a data-value="verbose" href="#">\n                        <span class="link-label">Verbose Mode</span>\n                        <span class="link-description">All event &amp; field data</span>\n                    </a>\n                </li>\n            </ul>\n        </div><!-- /.dropdown-menu -->\n    </div><!-- /.btn-group -->\n\n*/\n.dropdown-toggle-search-mode i[class^="icon-"]::before {\n  vertical-align: top;\n}\n.dropdown-menu-search-mode {\n  width: 26em;\n}\n.dropdown-menu-search-mode .link-label {\n  *display: block;\n}\n.dropdown-menu-search-mode a {\n  padding-left: 45px !important;\n}\n.dropdown-menu-search-mode .link-description {\n  color: #999999;\n  display: block;\n  font-size: 0.85em;\n}\n.dropdown-menu-search-mode .link-icon {\n  display: block;\n  position: absolute;\n  color: #999999;\n  left: 0;\n  top: 5px;\n  font-size: 2em;\n  width: 1.5em;\n  line-height: 1em;\n  opacity: 0.8;\n  filter: alpha(opacity=80);\n}\n.dropdown-menu-search-mode a .icon-check {\n  left: 30px;\n}\n.dropdown-menu-search-mode li > a {\n  white-space: normal;\n}\n')}),requirejs.s.contexts._.nextTick=requirejs.nextTick;