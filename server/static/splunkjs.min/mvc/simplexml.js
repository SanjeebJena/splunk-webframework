define("util/xml_utils",["jquery","underscore"],function(e,t){function n(t){var n=e.parseXML(t);return e(n.childNodes[0])}function r(t){var n=e.parseXML("<x></x>");return n.createCDATASection(t)}function i(t){var n=t.TEXT_NODE||3,r,s,o=t.childNodes;for(r=o.length-1;r>=0;r--)s=o[r],s!==undefined&&s.nodeType===n&&(/^\s*$/.test(s.nodeValue)?t.removeChild(s):s.nodeValue=e.trim(s.nodeValue));o=t.childNodes;for(r=o.length-1;r>=0;r--)s=o[r],(s.nodeType===t.ELEMENT_NODE||s.nodeType===t.DOCUMENT_NODE)&&i(s)}function o(e){var t=["\n"],n=e;while(n--)t.push(s);return t.join("")}function u(e,n,r){if(!n||!n.childNodes)return;var i=n.TEXT_NODE||3;for(var s=0;s<=n.childNodes.length;s++){var a=n.childNodes[s-1],f=n.childNodes[s];f&&f.nodeType!==i&&(!a||a.nodeType!==i)&&n.insertBefore(e.createTextNode(o(r)),f),s===n.childNodes.length&&a&&a.nodeType!==i&&n.appendChild(e.createTextNode(o(r-1)))}t.chain(n.childNodes).filter(function(e){return e.nodeType===n.ELEMENT_NODE}).each(function(t){u(e,t,r+1)})}function a(e){return i(e[0]),u(e[0],e[0].childNodes[0],1),e}function f(t){return t instanceof e&&(t=t[0]),Object.prototype.hasOwnProperty.call(t,"xml")?t.xml:(new XMLSerializer).serializeToString(t)}var s="  ";return{$node:n,cdata:r,stripEmptyTextNodes:i,formatXMLDocument:a,serialize:f}}),define("models/Dashboard",["jquery","underscore","splunk.util","models/services/data/ui/View","util/xml_utils","models/Base"],function(e,t,n,r,i,s){var o="html",u="chart",a="event",f="single",l="table",c=[u,a,f,l],h=s.extend({constructor:function(e){this._dash=e,s.prototype.constructor.call(this)},apply:function(){this._dash._applyMetadata(this.toJSON())},save:function(){return arguments.length&&this.set.apply(this,arguments),this._dash._applyMetadata(this.toJSON()),this._dash.save.apply(this._dash,arguments)},fetch:function(){var t=this._dash._extractMetadata();this.set(t);var n=e.Deferred();return n.resolve(this),n}}),p=r.extend({initialize:function(e,t){r.prototype.initialize.apply(this,arguments),this.indent=(t||{}).indent!==!1},initializeAssociated:function(){r.prototype.initializeAssociated.apply(this,arguments);var e=this.meta=this.meta||new h(this);this.entry.content.on("change:eai:data",function(){e.fetch()},this),e.fetch()},associatedOff:function(e,t,n){r.prototype.associatedOff.apply(this,arguments),this.meta.off(e,t,n)},get$XML:function(){var t=this.isXML()&&this.entry.content.get("eai:data")||"<dashboard/>",n=e.parseXML(t);return e(n).find("script").remove(),e(n)},set$XML:function(e){var t=i.serialize(this.indent?i.formatXMLDocument(e):e);this.setXML(t)},setXML:function(e){this.entry.content.set("eai:data",e),this.entry.content.set("eai:type","views")},setHTML:function(e){this.entry.content.set("eai:data",e),this.entry.content.set("eai:type","html")},_extractMetadata:function(){var e=this.isXML(),t=e?this.get$XML():null;return{label:this.entry.content.get("label")||this.entry.get("name"),description:e&&t.find(":eq(0) > description").text()||""}},_applyMetadata:function(e){var t=this.get$XML(),n=t.find(":eq(0) > label"),r=t.find(":eq(0) > description"),s=e.label,o=e.description;s!==undefined&&s!==null&&(n.length||(n=i.$node("<label/>"),t.find(":eq(0)").prepend(n)),n.text(s)),o!==undefined&&o!==null&&(o!==undefined&&o!==""||!r.length?r.length||(r=i.$node("<description/>"),n.length?r.insertAfter(n):t.find(":eq(0)").prepend(r)):r.remove(),r.text(o)),this.set$XML(t)},getLabel:function(){var e=this.meta.get("label");return e===undefined?"":e},setLabel:function(e){this.setLabelAndDescription(e,undefined)},getDescription:function(){return this.meta.get("description")},setDescription:function(e){this.setLabelAndDescription(undefined,e)},setLabelAndDescription:function(e,t){this._applyMetadata({label:e,description:t})},get$Rows:function(){var e=this.get$XML();return e.find(":eq(0) > row")},appendNewPanel:function(n,r){var s=t.indexOf(c,n)!=-1,u=n===o,a,f;if(s||u){s?a=t.template(this.nonHTMLPanelTemplate,{panelType:n,properties:r}):a=t.template(this.HTMLPanelTemplate,{properties:r}),f=this.get$XML();var l=i.$node("<row/>");e(l).append(i.$node(a)),f.find(":eq(0)").append(l),this.set$XML(f)}},nonHTMLPanelTemplate:'                <<%- panelType %>>                    <% if (properties.title) { %>                        <title><%- properties.title %></title>                    <% } %>                    <% if (properties.searchString) { %>                        <searchString><%- properties.searchString %></searchString>                        <% if (properties.earliestTime) { %>                            <earliestTime><%- properties.earliestTime %></earliestTime>                        <% } %>                        <% if (properties.latestTime) { %>                            <latestTime><%- properties.latestTime %></latestTime>                        <% } %>                    <% } else if (properties.pivotSearch) { %>                        <pivotSearch>                            <model><%= properties.pivotSearch.model %></model>                            <object><%= properties.pivotSearch.object %></object>                            <filters><%= properties.pivotSearch.filters %></filters>                            <cells><%= properties.pivotSearch.cells %></cells>                            <rows><%= properties.pivotSearch.rows %></rows>                            <columns><%= properties.pivotSearch.columns %></columns>                        </pivotSearch>                    <% } else if (properties.searchName) { %>                        <searchName><%- properties.searchName %></searchName>                    <% } %>                    <% if (properties.fields) { %>                        <fields><%- properties.fields %></fields>                    <% } %>                    <% _.each(properties.options, function(value, key) { %>                        <option name="<%- key %>"><%- value %></option>                    <% }) %>                </<%- panelType %>>            ',HTMLPanelTemplate:"<html><%= properties.html %></html>"},{panelXMLToPanelTypeAndProperties:function(t){var n={},r=e(t),s;return t.nodeName===o?(s=i.serialize(t),{panelType:t.nodeName,properties:{html:e.trim(s.replace(/^\s*<html>|<\/html>\s*$/g,""))}}):(r.children().each(function(t,r){var i=e(r);r.nodeName!=="option"?n[r.nodeName]=i.text():(n.options=n.options||{},n.options[i.attr("name")]=i.text())}),{panelType:t.nodeName,properties:n})},reportToPropertiesFromPanelType:function(e,n,r){var i=t.indexOf(c,e)!=-1,s={},o,a,l,h;if(!i)throw"Unsupported panel type";return!n.isNew()&&!r?s.searchName=n.entry.get("name"):(s.searchString=n.entry.content.get("search"),l=n.entry.content.get("dispatch.earliest_time"),l&&(s.earliestTime=l),h=n.entry.content.get("dispatch.latest_time"),h&&(s.latestTime=h)),e===u?s.options=n.entry.content.filterByWildcards(["^display.visualizations.charting..*"],{strip:"display.visualizations."}):e===f&&(s.options=n.entry.content.filterByWildcards(["^display.visualizations.singlevalue..*"],{strip:"display.visualizations.singlevalue."})),s}});p.Entry=p.Entry.extend({});var d=p.Entry.Content;return p.Entry.Content=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments)},validate:function(t){var n=t["eai:data"],r,i;if(n!=void 0){r=e.parseXML(n),i=r.firstChild;if(i.nodeName!=="dashboard"&&i.nodeName!=="form")return{"eai:data":"You must declare a dashboard node."}}}}),p}),define("collections/Reports",["models/Report","collections/services/SavedSearches"],function(e,t){return t.extend({model:e,initialize:function(){t.prototype.initialize.apply(this,arguments)}},{ALERT_SEARCH_STRING:'(is_scheduled=1 AND (alert_type!=always OR alert.track=1 OR (dispatch.earliest_time="rt*" AND dispatch.latest_time="rt*" AND actions="*" )))'})}),define("splunkjs/mvc/simplexml/controller",["require","models/Dashboard","util/router_utils","models/classicurl","backbone","jquery","underscore","../../mvc","util/xml_utils","../utils","util/pdf_utils","util/console","uri/route","../sharedmodels","util/splunkd_utils","splunk.util","../protections","collections/Reports","util/ajax_no_cache"],function(e){var t=e("models/Dashboard"),n=e("util/router_utils"),r=e("models/classicurl"),i=e("backbone"),s=e("jquery"),o=e("underscore"),u=e("../../mvc"),a=e("util/xml_utils"),f=e("../utils"),l=e("util/pdf_utils"),c=e("util/console"),h=e("uri/route"),p=e("../sharedmodels"),d=e("util/splunkd_utils"),v=e("splunk.util"),m=e("../protections"),g=e("collections/Reports");e("util/ajax_no_cache"),m.enableCSRFProtection(s),m.enableUnauthorizationRedirection(s,v.make_url("account/login"),"/account/logout");var y=t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments),this.entry.content.on("change:eai:data",this.updateItemOrder,this)},getFlattenedXML:function(e){if(!this._itemOrder)throw new Error("Cannot create flattened XML without the item order being captured first");var t=a.$node,n=this;e=e||{};var r=t("<dashboard/>");return t("<label/>").text(this.meta.get("label")).appendTo(r),this.meta.has("description")&&t("<description/>").text(this.meta.get("description")).appendTo(r),o(this._itemOrder).each(function(i){var s=t("<row/>");if(o(i).any(function(e){return e.length>1})){var f=o(i).map(function(e){return e.length}).join(",");s.attr("grouping",f)}o(i).chain().flatten().each(function(t){var r=u.Components.get(t),i=r.model.mapToXML(o.extend({tokens:!1,flatten:!0},e)),f=a.$node("<"+i.type+"/>");i.attributes!==undefined&&f.attr(i.attributes);if(i.content)i.cdata?f.append(a.cdata(i.content)):f.text(i.content);else{n._applyTitle(f,i);var l=u.Components.get(r.model.entry.content.get("display.general.manager"));e.useLoadjob!==!1&&l&&l.job?n._applySearch(f,{search:{type:"inline",search:"| loadjob "+l.job.sid+" ignore_running=t"}}):n._applySearch(f,i),n._applyOptions(f,i),n._applyTags(f,i)}f.appendTo(s)}),s.appendTo(r)}),e&&e.indent&&a.formatXMLDocument(r),a.serialize(r)},updateElement:function(e,t,n){c.log("About to update item=%o with settings=%o",e,t);var r=this.get$XML(),i=r.find("#"+e);if(!i.length){var u=o(this._itemOrder).chain().flatten().indexOf(e).value();c.log("Node with ID=%o not found. Search for item with index=%o",e,u);if(u===-1)throw new Error("Unable to find dashboard element with ID "+e);i=r.find("row").children()[u];if(!i)throw new Error("Unable to find dashboard element with ID "+e);i=s(i)}i=i[0],c.log("Updating XML node: ",i),a.stripEmptyTextNodes(i);var f=a.$node("<"+t.type+"/>");s(i).attr("id")&&f.attr("id",s(i).attr("id")),c.log("children",i.childNodes);while(i.childNodes.length)f.append(i.childNodes[0]);return n&&n.clearOptions&&(f.find("option").remove(),delete t.options),this._applyTitle(f,t),this._applySearch(f,t),this._applyOptions(f,t),this._applyTags(f,t),s(i).replaceWith(f),c.DEBUG_ENABLED&&(a.formatXMLDocument(r),c.log(a.serialize(r))),this.set$XML(r),this.save()},deleteElement:function(e){var t=o(this._itemOrder).map(function(t){return o(t).map(function(t){var n=o(t).indexOf(e);return n>-1?t.slice(0,n).concat(t.slice(n+1)):o.clone(t)})});return this.setItemOrder(t)},addElement:function(e,t){var n=a.$node("<row/>"),r=a.$node("<"+t.type+"/>");this._itemOrder.push([[t.id]]),n.append(r),this._applyTitle(r,t),this._applySearch(r,t);var i=this.get$XML();return i.find(":eq(0)").append(n),c.DEBUG_ENABLED&&(a.formatXMLDocument(i),c.log(a.serialize(i))),this.set$XML(i),this.save()},saveFormSettings:function(e,t,n){var r=this.get$XML(),i,u;if(e){r=this._migrateViewType(r,"form"),i=r.find(":eq(0)"),u=r.find(":eq(0)>fieldset");if(!u.length){u=a.$node('<fieldset autoRun="true" submitButton="false"></fieldset>');var f=r.find(":eq(0)>description");f.length?u.insertAfter(f):(f=r.find(":eq(0)>label"),f.length?u.insertAfter(f):u.prependTo(i))}var l=o(u.find('input[type="time"]')).find(function(e){return!s(e).attr("token")});if(t){var h;l?(h=s(l).find("default"),h.length||(h=a.$node("<default></default>").appendTo(l))):(l=a.$node('<input type="time" searchWhenChanged="true" />'),h=a.$node("<default></default>").appendTo(l),u.append(l)),n?o.isString(n)?h.text(n):(h.empty(),n.earliestTime&&a.$node("<earliestTime></earliestTime>").text(n.earliestTime).appendTo(h),n.latestTime&&a.$node("<latestTime></latestTime>").text(n.latestTime).appendTo(h)):h.remove()}else s(l).remove()}else r=this._migrateViewType(r,"dashboard"),r.find(":eq(0)>fieldset").remove();c.DEBUG_ENABLED&&(a.formatXMLDocument(r),c.log(a.serialize(r))),this.set$XML(r),this.save()},_migrateViewType:function(e,t){var n=e.find(":eq(0)");if(n.prop("tagName")!==t){e=s(s.parseXML("<"+t+"/>"));var r=e.find(":eq(0)"),i=n[0];o(i.attributes).each(function(e){r.attr(e.nodeName,e.nodeValue)});while(i.childNodes.length)r.append(i.childNodes[0])}return e},_applyOptions:function(e,t){t.options&&o.each(t.options,function(t,n){var r=e.find('option[name="'+n+'"]');t===""||t===null||t===void 0?r.remove():r.length?r.text(t):a.$node("<option/>").attr("name",n).text(t).appendTo(e)}),t.removeOptions&&o(t.removeOptions).each(function(t){e.find('option[name="'+t+'"]').remove()})},_applyTags:function(e,t){t.tags&&o.each(t.tags,function(t,n){e.find(n).remove(),(o.isArray(t)&&t.length||t)&&a.$node("<"+n+"/>").text(t).appendTo(e)})},_applyTitle:function(e,t){var n=e.find("title");t.title&&(n.length||(n=a.$node("<title/>").prependTo(e)),n.text(t.title))},_applySearch:function(e,t){if(t.search){e.find("searchString,searchTemplate,searchName,searchPostProcess,pivotSearch,earliestTime,latestTime").remove();var n=e.find("title");switch(t.search.type){case"inline":var r=a.$node("<searchString/>").text(t.search.search);n.length?r.insertAfter(n):r.prependTo(e),t.search.latest_time&&a.$node("<latestTime/>").text(t.search.latest_time).insertAfter(r),t.search.earliest_time&&a.$node("<earliestTime/>").text(t.search.earliest_time).insertAfter(r);break;case"postprocess":var i=a.$node("<searchPostProcess/>").text(t.search.search);n.length?i.insertAfter(n):i.prependTo(e);break;case"saved":var s=a.$node("<searchName/>").text(t.search.name);n.length?s.insertAfter(n):s.prependTo(e);break;case"pivot":throw new Error("Pivot search not implemented!");default:throw new Error("Unknown search type: "+t.search.type)}}},_clearEmptyItems:function(e){return o(e).chain().map(function(e){return o(e).filter(function(e){return e.length>0})}).filter(function(e){return e.length>0}).value()},captureItemOrder:function(e){e=this._clearEmptyItems(e),this._itemOrder=e,this._itemOrderMap=o.object(o.flatten(e),this.get$XML().find("row").children()),this.validateItemOrder(),c.DEBUG_ENABLED&&c.log("Captured dashboard item order: %o",JSON.stringify(this._itemOrder))},updateItemOrder:function(){this._itemOrder&&this.isXML()&&this.captureItemOrder(this._itemOrder)},validateItemOrder:function(){o(this._itemOrderMap).each(function(e,t){var n=s(e).attr(t);if(n!==undefined&&n!==t)throw new Error("Invalid Item order. Expected node with ID "+t+". Instead saw "+n)})},setItemOrder:function(e){e=this._clearEmptyItems(e);var t;if(!this._itemOrder)this.captureItemOrder(e);else if(!o.isEqual(e,this._itemOrder)){var n=this.get$XML(),r=this._itemOrderMap;n.find("row").remove(),o(e).each(function(e){var t=a.$node("<row/>");if(o(e).any(function(e){return e.length>1})){var i=o(e).map(function(e){return e.length}).join(",");t.attr("grouping",i)}o.chain(e).flatten().each(function(e){var n=r[e];s(n).find("script").remove(),t.append(n)}),t.children().length||c.DEBUG_ENABLED&&c.log("Created empty row for items %o and map %o",e,r),n.find("dashboard,form").append(t)}),this._itemOrder=e,this.set$XML(n),c.log("Saving new item order",e,n[0]),t=this.save()}else c.log("no changes"),t=s.Deferred(),t.resolve();return t},isEditable:function(){return this.isDashboard()||this.isForm()}}),b=i.Router.extend({initialize:function(e){this.model=e.model,this.app=e.app},routes:{":locale/app/:app/:page?*qs":"view",":locale/app/:app/:page":"view",":locale/app/:app/:page/?*qs":"view",":locale/app/:app/:page/":"view",":locale/app/:app/:page/edit?*qs":"edit",":locale/app/:app/:page/edit":"edit","*root/:locale/app/:app/:page?*qs":"rootedView","*root/:locale/app/:app/:page":"rootedView","*root/:locale/app/:app/:page/?*qs":"rootedView","*root/:locale/app/:app/:page/":"rootedView","*root/:locale/app/:app/:page/edit?*qs":"rootedEdit","*root/:locale/app/:app/:page/edit":"rootedEdit",":locale/manager/:app/:page?*qs":"view",":locale/manager/:app/:page":"view",":locale/manager/:app/:page/?*qs":"view",":locale/manager/:app/:page/":"view","*root/:locale/manager/:app/:page?*qs":"rootedView","*root/:locale/manager/:app/:page":"rootedView","*root/:locale/manager/:app/:page/?*qs":"rootedView","*root/:locale/manager/:app/:page/":"rootedView","dj/:app/:page/":"splunkdj","dj/:app/:page/?*qs":"splunkdj","*root/dj/:app/:page/":"rootedSplunkdj","*root/dj/:app/:page/?*qs":"rootedSplunkdj"},view:function(){c.log("ROUTE: view"),this.model.set("edit",!1),this.page.apply(this,arguments)},edit:function(){c.log("ROUTE: edit"),this.model.set("edit",!0),this.page.apply(this,arguments)},rootedView:function(e){this.app.set("root",e),this.view.apply(this,o.rest(arguments))},rootedEdit:function(e){this.app.set("root",e),this.edit.apply(this,o.rest(arguments))},page:function(e,t,n){c.log("ROUTE: page(locale=%o, app=%o, page=%o)",e,t,n),this.app.set({locale:e,app:t,page:n}),r.fetch()},splunkdj:function(e,t){this.page("en-US",e,t)},rootedSplunkdj:function(e){this.app.set("root",e),this.splunkdj.apply(this,o.rest(arguments))},updateUrl:function(){var e=[this.app.get("root")||"",this.app.get("locale"),"app",this.app.get("app"),this.app.get("page")];this.model.get("edit")&&e.push("edit");var t=[e.join("/")],n=r.toURLEncodedQueryString();n.length&&t.push(n),this.navigate(t.join("?"),{replace:!1})}}),w=function(){this.readyDfd=s.Deferred();var e=this.model=new i.Model,t=this.collection={},r=this.model.app=p.get("app"),o=this.model.appLocal=p.get("appLocal"),u=this.model.user=p.get("user"),a=this.collection.times=p.get("times");this.router=new b({model:this.model,app:r}),n.start_backbone_history();var f=this.model.view=new y;this.model.view.fetch({url:h.splunkdNS(r.get("root"),r.get("locale"),r.get("owner"),r.get("app"),[f.url,r.get("page")].join("/"))}).done(this._onViewModelLoad.bind(this)),l.isPdfServiceAvailable().always(function(t){e.set("pdf_available",t)}),this._onViewModelLoadDfd=s.Deferred(),this.model.on("change:edit",this.router.updateUrl,this.router)};o.extend(w.prototype,i.Events,{_onViewModelLoad:function(){var e=this.model;e.set("editable",e.view.isEditable()),e.view.isXML()&&(e.set("label",this.model.view.getLabel()),e.set("description",this.model.view.getDescription()),e.on("change:label change:description",function(){e.view.setLabelAndDescription(e.get("label"),e.get("description")),e.view.save()})),this._onViewModelLoadDfd.resolve(this.model.view)},onViewModelLoad:function(e,t){this._onViewModelLoadDfd.done(e.bind(t||null))},getStateModel:function(){return this.model},isEditMode:function(){return this.model.get("edit")===!0},onReady:function(e){s.when(this.readyDfd,this._onViewModelLoadDfd).then(e)},ready:function(){this.readyDfd.resolve()},isReady:function(){return this.readyDfd.state()==="resolved"},fetchCollection:function(){this.reportsCollection=new g,this.reportsCollection.REPORTS_LIMIT=150;var e=this.model.app,t={data:{count:this.reportsCollection.REPORTS_LIMIT,app:e.get("app"),owner:e.get("owner"),search:'is_visible="1"'}};this.reportsCollection.initialFetchDfd=this.reportsCollection.fetch(t)}});var E=new w;return c.DEBUG_ENABLED&&(window.Dashboard=E),E}),define("models/services/authorization/Role",["models/SplunkDBase"],function(e){return e.extend({url:"authorization/roles",initialize:function(){e.prototype.initialize.apply(this,arguments)}})}),define("collections/services/authorization/Roles",["models/services/authorization/Role","collections/SplunkDsBase"],function(e,t){return t.extend({FREE_PAYLOAD:{links:{create:"/services/authorization/roles/_new"},generator:{},entry:[{name:"admin",links:{alternate:"/services/authorization/roles/admin",list:"/services/authorization/roles/admin",edit:"/services/authorization/roles/admin",remove:"/services/authorization/roles/admin"},author:"system",acl:{app:"",can_list:!0,can_write:!0,modifiable:!1,owner:"system",perms:{read:["*"],write:["*"]},removable:!1,sharing:"system"},content:{capabilities:[],cumulativeRTSrchJobsQuota:400,cumulativeSrchJobsQuota:200,defaultApp:"","eai:acl":null,imported_capabilities:[],imported_roles:[],imported_rtSrchJobsQuota:20,imported_srchDiskQuota:500,imported_srchFilter:"",imported_srchIndexesAllowed:["*"],imported_srchIndexesDefault:["main"],imported_srchJobsQuota:10,imported_srchTimeWin:-1,rtSrchJobsQuota:100,srchDiskQuota:1e4,srchFilter:"*",srchIndexesAllowed:["*","_*"],srchIndexesDefault:["main","os"],srchJobsQuota:50,srchTimeWin:0}}],paging:{total:1,perPage:30,offset:0},messages:[]},initialize:function(){t.prototype.initialize.apply(this,arguments)},url:"authorization/roles",model:e})}),define("splunkjs/mvc/simplexml/mapper",["require","underscore","../mvc","backbone","util/console"],function(e){var t=e("underscore"),n=e("../mvc"),r=e("backbone"),i=e("util/console"),s=function(){};t.extend(s.prototype,{tagName:"#abstract",map:function(){},getSearch:function(e,t){var n;return e.entry.get("name")?(i.log("Mapping Saved Search"),n={type:"saved",name:e.entry.get("name",t)}):(i.log("Mapping Inline Search"),n={type:e.entry.content.get("display.general.search.type")||"inline",search:e.entry.content.get("search",t),earliest_time:e.entry.content.get("dispatch.earliest_time",t),latest_time:e.entry.content.get("dispatch.latest_time",t)},t.flatten&&n.type==="postprocess"&&(n.type="inline",n.search=e.entry.content.get("fullSearch",t))),n},toXML:function(e,t){t=t||{tokens:!0};var n={type:this.tagName,title:e.entry.content.get("display.general.title",t),search:this.getSearch(e,t),options:{},tags:{}};return this.map(e.entry.content,n,t),n.options.fields&&(n.tags.fields||(n.tags.fields=n.options.fields),n.options.fields=null),n}});var o={};return s.register=function(e,t){o[e]=t},s.get=function(e){var t=o[e];if(!t)throw new Error("No mapper for type "+e);return new t},s.extend=r.Model.extend,s}),define("models/DashboardReport",["require","jquery","underscore","models/Report","splunkjs/mvc/simplexml/controller","splunkjs/mvc/simplexml/mapper","util/console","splunkjs/mvc/tokenawaremodel"],function(e){var t=e("jquery"),n=e("underscore"),r=e("models/Report"),i=e("splunkjs/mvc/simplexml/controller"),s=e("splunkjs/mvc/simplexml/mapper"),o=e("util/console"),u=e("splunkjs/mvc/tokenawaremodel"),a=r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments)},saveXML:function(e){var t=this.entry.content.get("display.general.id");return o.log("[%o] Saving Panel Element XML...",t),i.model.view.updateElement(t,this.mapToXML(),e)},mapToXML:function(e){var t=this.entry.content.get("display.general.type"),n=["display",t,"type"].join(".");this.entry.content.has(n)&&(t=[t,this.entry.content.get(n)].join(":")),o.log("Looking up mapper for type ",t);var r=s.get(t);return o.log("Found mapper",r),r.toXML(this,e)},deleteXML:function(){return i.model.view.deleteElement(this.entry.content.get("display.general.id"))},defaults:{"display.visualizations.charting.axisY.scale":"linear","display.visualizations.charting.axisX.scale":"linear","display.visualizations.charting.axisX.minimumNumber":"","display.visualizations.charting.axisX.maximumNumber":"","display.visualizations.charting.axisY.minimumNumber":"","display.visualizations.charting.axisY.maximumNumber":"","display.visualizations.charting.axisTitleX.text":"","display.visualizations.charting.axisTitleY.text":"","display.visualizations.charting.axisLabelsX.majorUnit":"","display.visualizations.charting.axisLabelsY.majorUnit":"","display.visualizations.charting.legend.placement":"right","display.visualizations.charting.legend.labelStyle.overflowMode":"ellipsisMiddle","display.visualizations.charting.chart.stackMode":"default","display.visualizations.charting.chart.nullValueMode":"zero","display.visualizations.charting.chart.rangeValues":'["0","30","70","100"]',"display.visualizations.charting.chart.style":"shiny","display.visualizations.charting.gaugeColors":[8710400,16771072,12529712],"display.prefs.events.count":"10","display.prefs.statistics.count":"10"},validation:{"display.visualizations.charting.axisX.minimumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisX.maximumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisY.minimumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY.maximumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisLabelsX.majorUnit":{pattern:"number",min:Number.MIN_VALUE,msg:"Please enter a positive number",required:!1},"display.visualizations.charting.axisLabelsY.majorUnit":{pattern:"number",min:Number.MIN_VALUE,msg:"Please enter a positive number",required:!1},"display.visualizations.charting.axisY.scale":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.stackMode":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.rangeValues":{fn:"validateRangeValues",required:!1},"display.prefs.events.count":{pattern:"number",min:1,msg:n("Rows Per Page must be a positive number.").t(),required:!1},"display.prefs.statistics.count":{pattern:"number",min:1,msg:n("Rows Per Page must be a positive number.").t(),required:!1}},validateXAxisExtremes:function(e,t,r){var i=parseFloat(r["display.visualizations.charting.axisX.minimumNumber"]),s=parseFloat(r["display.visualizations.charting.axisX.maximumNumber"]);if(!n.isNaN(i)&&!n.isNaN(s)&&s<=i)return"The minimum value must be less than maximum value"},validateYAxisExtremes:function(e,t,r){var i=parseFloat(r["display.visualizations.charting.axisY.minimumNumber"]),s=parseFloat(r["display.visualizations.charting.axisY.maximumNumber"]);if(!n.isNaN(i)&&!n.isNaN(s)&&s<=i)return"The minimum value must be less than maximum value"},validateYScaleAndStacking:function(e,t,n){var r=n["display.visualizations.charting.axisY.scale"],i=n["display.visualizations.charting.chart.stackMode"];if(r==="log"&&i!=="default")return"Log scale and stacking cannot be enabled at the same time"},validateRangeValues:function(e){var r=n(e?JSON.parse(e):[]).map(parseFloat);if(n(r).any(n.isNaN)||!e)return"All color ranges must be valid numbers";var i=n.uniq(r),s=t.extend([],r).sort(function(e,t){return e-t});if(!n.isEqual(r,i)||!n.isEqual(r,s))return"Color ranges must be entered from lowest to highest"},attrToArray:function(e){var t=this.get(e);return t?n.values(JSON.parse(t)):[]},rangesValuesToArray:function(){return this.attrToArray("display.visualizations.charting.chart.rangeValues")},gaugeColorsToArray:function(){return this.attrToArray("display.visualizations.charting.gaugeColors")}},{Entry:r.Entry.extend({},{Content:u.extend({applyTokensByDefault:!0})})});return a}),define("util/moment/compactFromNow",["util/moment"],function(e){function n(e,n,r){var i=t(Math.abs(e)/1e3),s=t(i/60),o=t(s/60),u=t(o/24),a=t(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",t(u/30)]||a===1&&["y"]||["yy",a],l=f[0],c=f[1]||1,h=e>0,p=(r._compactRelativeTime||{})[l];return p===undefined?r.relativeTime(c,!!n,l,h):typeof p=="function"?p(c,n,l,h):p.replace(/%d/i,c)}var t=Math.round;return e.duration.fn.humanizeCompact=function(e){var t=+this,r=n(t,!e,this.lang());return e&&(r=this.lang().pastFuture(t,r)),this.lang().postformat(r)},e.fn.compactFromNow=function(t){return e.duration(this.diff(e())).lang(this.lang()._abbr).humanizeCompact(!t)},e}),define("splunkjs/mvc/refreshtimeindicatorview",["require","exports","module","./mvc","./basesplunkview","util/moment","util/moment/compactFromNow","underscore"],function(e,t,n){function f(){o(u).each(function(e){e()})}function l(e){delete u[e],o.isEmpty(u)&&(clearInterval(a),a=null)}function c(e,t,n){u[e]&&l(e),u[e]=o.bind(t,n),a||(a=setInterval(f,1e3))}var r=e("./mvc"),i=e("./basesplunkview"),s=e("util/moment");e("util/moment/compactFromNow");var o=e("underscore"),u={},a,h=i.extend({moduleId:n.id,className:"splunk-timeindicator",configure:function(){this.options.manager&&(this.options.managerid=this.options.manager),i.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.bindToComponentSetting("managerid",this.onManagerChange,this),this.timer=o.uniqueId("timer_")},onManagerChange:function(e,t){this.manager&&this.manager.off(null,null,this),this.manager=t;if(!t)return;this.manager.on("search:start",this.clear,this),this.manager.on("search:progress",this.onSearchProgress,this),this.manager.on("search:done",this.onSearchProgress,this),this.manager.on("search:fail",this.clear,this),this.manager.on("search:cancelled",this.clear,this),t.replayLastSearchEvent(this)},clear:function(){l(this.timer),this.$el.html("&nbsp;")},updateRefreshTime:function(){this.refreshTime&&(s().diff(this.refreshTime)<1e4?this.$el.hide():(this.$el.text(this.refreshTime.compactFromNow()).show(),this.$el.attr("title",o("Last refresh: ").t()+this.refreshTime.format("LLL"))))},onSearchProgress:function(e){var t=(e||{}).content||{};if(t.dispatchState==="FAILED")this.clear();else if(t.dispatchState==="PARSING"||t.dispatchState==="QUEUED")this.clear();else if(t.dispatchState==="RUNNING")t.isRealTimeSearch?(l(this.timer),this.$el.text(o("Real-time").t())):this.clear();else if(t.dispatchState==="DONE"){this.refreshTime=s(this.manager.job.published());if(!this.refreshTime){this.clear();return}this.clear(),this.updateRefreshTime(),c(this.timer,this.updateRefreshTime,this)}},render:function(){return this.$el.html("&nbsp;"),this},remove:function(){return l(this.timer),this.onManagerChange(null,null),i.prototype.remove.call(this)}});return h}),define("splunkjs/mvc/resultslinkview",["require","exports","module","jquery","underscore","splunk.util","splunk.window","models/Job","uri/route","views/shared/jobstatus/buttons/ExportResultsDialog","./basesplunkview","./mvc","./savedsearchmanager","./utils","./sharedmodels","splunk.util","./postprocessmanager"],function(e,t,n){var r=e("jquery"),i=e("underscore"),s=e("splunk.util"),o=e("splunk.window"),u=e("models/Job"),a=e("uri/route"),f=e("views/shared/jobstatus/buttons/ExportResultsDialog"),l=e("./basesplunkview"),c=e("./mvc"),h=e("./savedsearchmanager"),p=e("./utils"),d=e("./sharedmodels"),v=e("splunk.util"),m=e("./postprocessmanager"),g=l.extend({moduleId:n.id,configure:function(){this.options.manager&&(this.options.managerid=this.options.manager),l.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.bindToComponentSetting("managerid",this.onManagerChange,this),this.searchJobModel=new u,this.applicationModel=d.get("app"),this.listenTo(this.model.entry.content,"change:search",i.bind(this.render,this))},onManagerChange:function(e,t){this.manager&&(this.manager.off(null,null,this),this.manager=null);if(!t)return;this.manager=t,this.listenTo(t,"search:start",this.onSearchStart),this.listenTo(t,"search:done",this.onSearchDone),this.manager.job&&this.onSearchStart(this.manager.job),this.manager.replayLastSearchEvent(this)},onSearchStart:function(e){this.searchJobModel.set("id",e.sid),this.$pivotButton&&this.$pivotButton.off("click").on("click",this.openPivot.bind(this)).show(),this.$searchButton&&this.$searchButton.off("click").on("click",this.openSearch.bind(this)).show(),this.$exportButton&&(this.manager instanceof m?(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export - You cannot export results for post-process jobs.").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show()):(this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show())),this.$inspectButton&&this.$inspectButton.off("click").on("click",this.inspectSearch.bind(this)).show()},onSearchDone:function(e){this.searchJobModel.setFromSplunkD({entry:[this.manager.job.state()]}),this.$exportButton&&(this.manager instanceof m?(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export - You cannot export results for post-process jobs.").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show()):(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.removeClass("disabled"),this.$exportButton.off("click").on("click",this.exportResults.bind(this)).show()))},openSearch:function(e){e&&e.preventDefault();var t=this.options,n=this.manager,r,i,s;t["link.openSearch.search"]?(r={q:t["link.openSearch.search"]},i=t["link.openSearch.searchEarliestTime"],!i&&n.job.properties().earliestTime?i=v.getEpochTimeFromISO(n.job.properties().earliestTime):i=n.search.get("earliest_time"),i!=null&&(r.earliest=i),s=t["link.openSearch.searchLatestTime"],!s&&n.job.properties().latestTime?s=v.getEpochTimeFromISO(n.job.properties().latestTime):s=n.search.get("latest_time"),s!=null&&(r.latest=s)):t["link.openSearch.viewTarget"]?r={sid:this.searchJobModel.get("id")}:(r={sid:this.searchJobModel.get("id"),q:n.query.resolve()},n instanceof h&&(r.s=n.get("searchname")),i=n.search.get("earliest_time"),i!=null&&(r.earliest=i),s=n.search.get("latest_time"),s!=null&&(r.latest=s));var o=p.getPageInfo(),u=a.page(o.root,o.locale,o.app,t["link.openSearch.viewTarget"]||"search",{data:r});window.open(u,"_blank")},exportResults:function(e){e&&e.preventDefault();var t=new f({model:{searchJob:this.searchJobModel,application:this.applicationModel,report:this.model},usePanelType:!0});t.render().appendTo(r("body")),t.show()},inspectSearch:function(e){e&&e.preventDefault();var t=p.getPageInfo(),n=a.jobInspector(t.root,t.locale,t.app,this.searchJobModel.get("id"));o.open(n,"splunk_job_inspector",{width:870,height:560,menubar:!1})},openPivot:function(e){e&&e.preventDefault();var t=p.getPageInfo(),n,r;if(this.model.has("id")){var i=this.model.get("id");n={s:i},this.model.entry.content.has("dispatch.earliest_time")&&(n.earliest=this.model.entry.content.get("dispatch.earliest_time"),n.latedst=this.model.entry.content.get("dispatch.latest_time")),r=a.pivot(t.root,t.locale,t.app,{data:n}),p.redirect(r,!0)}else{var s=this.model.entry.content.get("search");n={q:s},this.model.entry.content.has("dispatch.earliest_time")&&(n.earliest=this.model.entry.content.get("dispatch.earliest_time"),n.latest=this.model.entry.content.get("dispatch.latest_time")),r=a.pivot(t.root,t.locale,t.app,{data:n}),p.redirect(r,!0)}},render:function(){var e;return this.model.isPivotReport()?e=i.template(this.pivotTemplate):e=i.template(this.template),this.$el.html(e({options:this.options})),this.resolveBooleanOptions("link.openPivot.visible","link.visible",!0)?this.$pivotButton=this.$(".pivot-button").hide():this.$(".pivot-button").remove(),this.resolveBooleanOptions("link.openSearch.visible","link.visible",!0)?this.$searchButton=this.$(".search-button").hide():this.$(".search-button").remove(),this.resolveBooleanOptions("link.exportResults.visible","link.visible",!0)?this.$exportButton=this.$(".export-button").hide():this.$(".export-button").remove(),this.resolveBooleanOptions("link.inspectSearch.visible","link.visible",!0)?this.$inspectButton=this.$(".inspect-button").hide():this.$(".inspect-button").remove(),this.$searchButton||this.$exportButton||this.$inspectButton?this.$el.show():this.$el.hide(),this.$("> a").tooltip({animation:!1,container:"body"}),this},resolveBooleanOptions:function(){var e=this.options,t;for(var n=0,r=arguments.length-1;n<r;n++){t=e[arguments[n]];if(t!=null)return s.normalizeBoolean(t)}return s.normalizeBoolean(arguments[arguments.length-1])},template:'            <a href="#search" class="search-button btn-pill" title="<%- options[\'link.openSearch.text\'] || _(\'Open in Search\').t() %>">                <i class="icon-search"></i>                <span class="hide-text"><%- options[\'link.openSearch.text\'] || _("Open in Search").t() %></span>            </a><a href="#export" class="export-button btn-pill" title="<%- _(\'Export - You can only export results for completed jobs.\').t() %>">                <i class="icon-export"></i>                <span class="hide-text"><%- _("Export").t() %></span>            </a><a href="#inspect" class="inspect-button btn-pill" title="<%- _(\'Inspect\').t() %>">                <i class="icon-info"></i>                <span class="hide-text"><%- _("Inspect").t() %></span>            </a>        ',pivotTemplate:'            <a href="#pivot" class="pivot-button btn-pill" title="<%- _(\'Open in Pivot\').t() %>">                <i class="icon-pivot"></i>                <span class="hide-text"><%- _("Open in Pivot").t() %></span>            </a><a href="#export" class="export-button btn-pill" title="<%- _(\'Export\').t() %>">                <i class="icon-export"></i>                <span class="hide-text"><%- _("Export").t() %></span>            </a><a href="#inspect" class="inspect-button btn-pill" title="<%- _(\'Inspect\').t() %>">                <i class="icon-info"></i>                <span class="hide-text"><%- _("Inspect").t() %></span>            </a>        '});return g}),define("views/shared/vizcontrols/custom_controls/DrilldownRadio",["underscore","jquery","module","views/shared/controls/SyntheticRadioControl","splunk.util"],function(e,t,n,r,i){return r.extend({moduleId:n.id,initialize:function(){t.extend(this.options,{modelAttribute:"display.visualizations.charting.drilldown",items:[{label:e("Yes").t(),value:"all"},{label:e("No").t(),value:"none"}],save:!1,elastic:!0}),r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/DrilldownRadioGroup",["underscore","module","views/shared/controls/ControlGroup","./DrilldownRadio"],function(e,t,n,r){return n.extend({moduleId:t.id,initialize:function(){var t=new r({model:this.model});this.options.label=e("Drilldown").t(),this.options.controls=[t],n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/StackModeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){var t=[{value:"default",icon:"bar-beside",tooltip:e("not stacked").t()},{value:"stacked",icon:"bar-stacked",tooltip:e("stacked").t()}];this.options.allowStacked100!==!1&&t.push({value:"stacked100",icon:"bar-stacked-100",tooltip:e("stacked 100%").t()}),this.options.label=e("Stack Mode").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.stackMode",model:this.model,className:"btn-group",items:t},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/NullValueModeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Null Values").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.nullValueMode",model:this.model,className:"btn-group",items:[{value:"gaps",icon:"missing-value-skipped",tooltip:e("Gaps").t()},{value:"zero",icon:"missing-value-zero",tooltip:e("Zero").t()},{value:"connect",icon:"missing-value-join",tooltip:e("Connect").t()}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Style").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.style",model:this.model,items:[{label:e("Minimal").t(),value:"minimal"},{label:e("Shiny").t(),value:"shiny"}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Before Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.beforeLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("After Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.afterLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Under Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.underLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MultiSeriesRadio",["underscore","jquery","module","views/shared/controls/ControlGroup","splunk.util"],function(e,t,n,r,i){return r.extend({moduleId:n.id,initialize:function(){this.options.label=e("Multi-series Mode").t(),this.options.controlType="SyntheticRadio",this.options.controlClass="controls-halfblock",this.options.controlOptions={modelAttribute:"display.visualizations.charting.layout.splitSeries",model:this.model,items:[{label:e("Yes").t(),value:"1"},{label:e("No").t(),value:"0"}],save:!1,elastic:!0},r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/Statistics",["underscore","module","views/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticSelectControl"],function(e,t,n,r,i){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.drillDown=new r({label:e("Drilldown").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group",items:[{value:"row",label:e("Row").t()},{value:"cell",label:e("Cell").t()},{value:"none",label:e("None").t()}],model:this.model,modelAttribute:"display.statistics.drilldown"}}),this.children.rowNumbers=new r({label:e("Row Numbers").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.statistics.rowNumbers"}}),this.children.wrapResults=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.statistics.wrap"}}),this.children.dataOverlay=new r({label:e("Data Overlay").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",items:[{value:"none",label:e("None").t()},{value:"heatmap",label:e("Heat map").t()},{value:"highlow",label:e("High and low values").t()}],modelAttribute:"display.statistics.overlay",toggleClassName:"btn"}}),this.model.get("dashboard")&&(this.children.count=new r({label:e("Rows Per Page").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",modelAttribute:"display.prefs.statistics.count"}}))},render:function(){return this.$el.html(""),this.$el.append(this.children.wrapResults.render().el),this.$el.append(this.children.rowNumbers.render().el),this.$el.append(this.children.drillDown.render().el),this.$el.append(this.children.dataOverlay.render().el),this.children.count&&this.$el.append(this.children.count.render().el),this}})}),define("views/shared/vizcontrols/components/Events",["underscore","module","views/Base","views/shared/controls/ControlGroup"],function(e,t,n,r){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.showEventType=this.options.showEventType===!1?!1:!0,this.showEventType&&(this.children.eventType=new r({label:e("Display").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group",items:[{label:e("Raw").t(),value:"raw"},{label:e("List").t(),value:"list"},{label:e("Table").t(),value:"table"}],model:this.model,modelAttribute:"display.events.type"}})),this.children.rowNumbers=new r({label:e("Row Numbers").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.rowNumbers"}}),this.children.wrapResultsList=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.list.wrap"}}),this.children.wrapResultsTable=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.table.wrap"}}),this.children.maxlines=new r({label:e("Max Lines").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",items:[{value:"5",label:e("5 lines").t()},{value:"10",label:e("10 lines").t()},{value:"20",label:e("20 lines").t()},{value:"50",label:e("50 lines").t()},{value:"100",label:e("100 lines").t()},{value:"200",label:e("200 lines").t()},{value:"0",label:e("All lines").t()}],modelAttribute:"display.events.maxLines",toggleClassName:"btn",nearestValue:!0}}),this.children.drilldownRaw=new r({label:e("Drilldown").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{menuWidth:"narrow",toggleClassName:"btn",items:[{value:"none",label:e("None").t()},{value:"inner",label:e("Inner").t()},{value:"outer",label:e("Outer").t()},{value:"full",label:e("Full").t()}],model:this.model,modelAttribute:"display.events.raw.drilldown"}}),this.children.drilldownList=new r({label:e("Drilldown").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{menuWidth:"narrow",toggleClassName:"btn",items:[{value:"none",label:e("None").t()},{value:"inner",label:e("Inner").t()},{value:"outer",label:e("Outer").t()},{value:"full",label:e("Full").t()}],model:this.model,modelAttribute:"display.events.list.drilldown"}}),this.children.drilldownTable=new r({label:e("Drilldown").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("On").t()},{value:"0",label:e("Off").t()}],model:this.model,modelAttribute:"display.events.table.drilldown"}}),this.model.get("dashboard")&&(this.children.count=new r({label:e("Rows Per Page").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",modelAttribute:"display.prefs.events.count"}})),this.model.on("change:display.events.type",this.visibility,this),this.model.on("change:display.events.list.drilldown change:display.events.raw.drilldown",this.mediateDrilldown,this),this.model.on("change:display.events.list.wrap change:display.events.table.wrap",this.mediateWrap,this)},mediateDrilldown:function(){this.model.get("display.events.type")==="list"?this.model.set("display.events.raw.drilldown",this.model.get("display.events.list.drilldown")):this.model.set("display.events.list.drilldown",this.model.get("display.events.raw.drilldown"))},mediateWrap:function(){this.model.get("display.events.type")==="list"?this.model.set("display.events.table.wrap",this.model.get("display.events.list.wrap")):this.model.set("display.events.list.wrap",this.model.get("display.events.table.wrap"))},visibility:function(){switch(this.model.get("display.events.type")){case"list":this.children.wrapResultsList.$el.show(),this.children.wrapResultsTable.$el.hide(),this.children.rowNumbers.$el.show(),this.children.drilldownList.$el.show(),this.children.drilldownRaw.$el.hide(),this.children.drilldownTable.$el.hide();break;case"raw":this.children.wrapResultsList.$el.hide(),this.children.wrapResultsTable.$el.hide(),this.children.rowNumbers.$el.hide(),this.children.drilldownList.$el.hide(),this.children.drilldownRaw.$el.show(),this.children.drilldownTable.$el.hide();break;case"table":this.children.wrapResultsList.$el.hide(),this.children.wrapResultsTable.$el.show(),this.children.rowNumbers.$el.show(),this.children.drilldownList.$el.hide(),this.children.drilldownRaw.$el.hide(),this.children.drilldownTable.$el.show();break;default:}},render:function(){return this.showEventType&&this.$el.append(this.children.eventType.render().el),this.$el.append(this.children.rowNumbers.render().el),this.$el.append(this.children.wrapResultsList.render().el),this.$el.append(this.children.wrapResultsTable.render().el),this.$el.append(this.children.maxlines.render().el),this.$el.append(this.children.drilldownList.render().el),this.$el.append(this.children.drilldownRaw.render().el),this.$el.append(this.children.drilldownTable.render().el),this.children.count&&this.$el.append(this.children.count.render().el),this.visibility(),this}})}),define("views/shared/vizcontrols/components/General",["underscore","jquery","module","views/Base","views/shared/controls/ControlGroup","views/shared/vizcontrols/custom_controls/DrilldownRadioGroup","views/shared/vizcontrols/custom_controls/StackModeControlGroup","views/shared/vizcontrols/custom_controls/NullValueModeControlGroup","views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup","views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup","views/shared/vizcontrols/custom_controls/MultiSeriesRadio","views/shared/vizcontrols/components/Statistics","views/shared/vizcontrols/components/Events"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToGeneralComponents:{line:["nullValue","multiseries","drilldown"],area:["stack","nullValue","multiseries","drilldown"],column:["stack","multiseries","drilldown"],bar:["stack","multiseries","drilldown"],pie:["drilldown"],scatter:["drilldown"],radialGauge:["style"],fillerGauge:["style"],markerGauge:["style"],single:["before","after","under"],events:["eventGroup"],statistics:["statisticsGroup"]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToGeneralComponents[this.model.get("viz_type")];e.indexOf(n,"stack")>-1&&(this.children.stackMode=new o({model:this.model,controlClass:"controls-thirdblock"})),e.indexOf(n,"nullValue")>-1&&(this.children.nullValueMode=new u({model:this.model,controlClass:"controls-thirdblock"})),e.indexOf(n,"multiseries")>-1&&(this.children.multiSeries=new h({model:this.model})),e.indexOf(n,"drilldown")>-1&&(this.children.drilldown=new s({model:this.model,controlClass:"controls-halfblock"})),e.indexOf(n,"style")>-1&&(this.children.gaugeStyle=new a({model:this.model,controlClass:"controls-halfblock"})),e.indexOf(n,"before")>-1&&(this.children.beforeLabel=new f({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"after")>-1&&(this.children.afterLabel=new l({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"under")>-1&&(this.children.underLabel=new c({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"eventGroup")>-1&&(this.children.events=new d({model:this.model})),e.indexOf(n,"statisticsGroup")>-1&&(this.children.statistics=new p({model:this.model}))},render:function(){return this.children.stackMode&&this.$el.append(this.children.stackMode.render().el),this.children.nullValueMode&&this.$el.append(this.children.nullValueMode.render().el),this.children.multiSeries&&this.$el.append(this.children.multiSeries.render().el),this.children.drilldown&&this.$el.append(this.children.drilldown.render().el),this.children.gaugeStyle&&this.$el.append(this.children.gaugeStyle.render().el),this.children.beforeLabel&&this.$el.append(this.children.beforeLabel.render().el),this.children.afterLabel&&this.$el.append(this.children.afterLabel.render().el),this.children.underLabel&&this.$el.append(this.children.underLabel.render().el),this.children.events&&this.$el.append(this.children.events.render().el),this.children.statistics&&this.$el.append(this.children.statistics.render().el),this}})}),define("views/shared/vizcontrols/custom_controls/AxisTitleControlGroup",["underscore","module","models/Base","views/shared/controls/ControlGroup","views/shared/controls/Control"],function(e,t,n,r,i){return r.extend({moduleId:t.id,initialize:function(){this.axisTitleVisibilityAttr=this.options.xAxis?"display.visualizations.charting.axisTitleX.visibility":"display.visualizations.charting.axisTitleY.visibility",this.axisTitleTextAttr=this.options.xAxis?"display.visualizations.charting.axisTitleX.text":"display.visualizations.charting.axisTitleY.text",this.titleStateModel=new n,this.setInitialTitleState(),this.axisTitleText=this.model.get(this.axisTitleTextAttr),this.options.label=e("Title").t(),this.options.controlClass="controls-block",this.options.controls=[{type:"SyntheticSelect",options:{className:i.prototype.className+" input-prepend",model:this.titleStateModel,modelAttribute:"state",toggleClassName:"btn",menuWidth:"narrow",items:[{value:"default",label:e("Default").t()},{value:"custom",label:e("Custom").t()},{value:"none",label:e("None").t()}]}},{type:"Text",options:{className:i.prototype.className+" input-prepend",model:this.model,modelAttribute:this.axisTitleTextAttr,inputClassName:this.options.inputClassName}}],r.prototype.initialize.call(this,this.options),this.showHideControl=this.childList[0],this.labelControl=this.childList[1],this.titleStateModel.on("change:state",this.handleTitleState,this),this.model.on("change:"+this.axisTitleTextAttr,function(){this.titleStateModel.get("state")!=="default"&&(this.axisTitleText=this.model.get(this.axisTitleTextAttr))},this)},setInitialTitleState:function(){this.model.get(this.axisTitleVisibilityAttr)==="collapsed"?this.titleStateModel.set({state:"none"}):this.model.get(this.axisTitleTextAttr)?this.titleStateModel.set({state:"custom"}):this.titleStateModel.set({state:"default"})},render:function(){return r.prototype.render.apply(this,arguments),this.handleTitleState(),this},handleTitleState:function(){var e=this.titleStateModel.get("state"),t={};e==="none"?(t[this.axisTitleVisibilityAttr]="collapsed",this.hideTitleTextInput()):e==="custom"?(t[this.axisTitleVisibilityAttr]="visible",t[this.axisTitleTextAttr]=this.axisTitleText,this.showTitleTextInput()):(t[this.axisTitleVisibilityAttr]="visible",t[this.axisTitleTextAttr]="",this.hideTitleTextInput()),this.model.set(t)},showTitleTextInput:function(){this.labelControl.insertAfter(this.showHideControl.$el),this.showHideControl.$el.addClass("input-prepend")},hideTitleTextInput:function(){this.labelControl.detach(),this.showHideControl.$el.removeClass("input-prepend")}})}),define("views/shared/vizcontrols/custom_controls/AxisScaleControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Scale").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:this.options.xAxis?"display.visualizations.charting.axisX.scale":"display.visualizations.charting.axisY.scale",model:this.model,className:"btn-group",items:[{label:e("Linear").t(),value:"linear"},{label:e("Log").t(),value:"log"}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Interval").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:this.options.xAxis?"display.visualizations.charting.axisLabelsX.majorUnit":"display.visualizations.charting.axisLabelsY.majorUnit",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Min Value").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:this.options.xAxis?"display.visualizations.charting.axisX.minimumNumber":"display.visualizations.charting.axisY.minimumNumber",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Max Value").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:this.options.xAxis?"display.visualizations.charting.axisX.maximumNumber":"display.visualizations.charting.axisY.maximumNumber",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/LegendPlacementControlGroup",["jquery","underscore","module","views/shared/controls/ControlGroup"],function(e,t,n,r){return r.extend({moduleId:n.id,initialize:function(){this.options.label=t("Position").t(),this.options.controlType="SyntheticSelect",this.options.controlOptions={modelAttribute:"display.visualizations.charting.legend.placement",model:this.model,popdownOptions:this.options.popdownOptions,items:[{label:t("Right").t(),value:"right"},{label:t("Bottom").t(),value:"bottom"},{label:t("Left").t(),value:"left"},{label:t("Top").t(),value:"top"},{label:t("None").t(),value:"none"}],toggleClassName:"btn"},r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/LegendTruncationControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Truncation").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.legend.labelStyle.overflowMode",model:this.model,className:"btn-group",items:[{label:e("A...").t(),value:"ellipsisEnd",tooltip:e("Truncate End").t()},{label:e("A...Z").t(),value:"ellipsisMiddle",tooltip:e("Truncate Middle").t()},{label:e("...Z").t(),value:"ellipsisStart",tooltip:e("Truncate Start").t()}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup",["underscore","module","models/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticRadioControl"],function(e,t,n,r,i){var s=i.extend({initialize:function(){this.vizModel=this.options.vizModel,this.model.set({autoMode:this.vizModel.gaugeIsInAutoMode()?"1":"0"}),this.options.modelAttribute="autoMode",this.options.items=[{label:e("Automatic").t(),value:"1",tooltip:e("Uses base search to set color ranges.").t()},{label:e("Manual").t(),value:"0",tooltip:e("Manually set color ranges. Overrides search settings.").t()}],this._ranges='["0", "30", "70", "100"]',this._colors="[0x84E900, 0xFFE800, 0xBF3030]",this.model.on("change:autoMode",this.handleModeChange,this),i.prototype.initialize.call(this,this.options)},handleModeChange:function(){var e=this.model.get("autoMode")==="1";e?(this._ranges=this.vizModel.get("display.visualizations.charting.chart.rangeValues"),this._colors=this.vizModel.get("display.visualizations.charting.gaugeColors"),this.vizModel.set({"display.visualizations.charting.chart.rangeValues":"","display.visualizations.charting.gaugeColors":""})):this.vizModel.set({"display.visualizations.charting.chart.rangeValues":this._ranges,"display.visualizations.charting.gaugeColors":this._colors})}});return r.extend({moduleId:t.id,initialize:function(){var e=new s({model:this.model,vizModel:this.options.vizModel});this.options.controlClass="controls-halfblock",this.options.controls=[e],r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/XAxis",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/AxisTitleControlGroup","views/shared/vizcontrols/custom_controls/DrilldownRadioGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup","views/shared/vizcontrols/custom_controls/LegendPlacementControlGroup","views/shared/vizcontrols/custom_controls/LegendTruncationControlGroup","views/shared/vizcontrols/custom_controls/StackModeControlGroup","views/shared/vizcontrols/custom_controls/NullValueModeControlGroup","views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup","views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup","views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToGeneralComponents:{line:["title"],area:["title"],column:["title"],bar:["title"],pie:[],scatter:["title","scale","interval","min","max"],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToGeneralComponents[this.model.get("viz_type")];e.indexOf(n,"title")>-1&&(this.children.title=new i({model:this.model,xAxis:!0}))},render:function(){return this.children.title&&this.$el.append(this.children.title.render().el),this}})}),define("views/shared/vizcontrols/components/YAxis",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/AxisTitleControlGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup"],function(e,t,n,r,i,s,o,u,a){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToYAxisComponents:{line:["title","scale","interval","min","max"],bar:["title","scale","interval","min","max"],area:["title","scale","interval","min","max"],column:["title","scale","interval","min","max"],scatter:["title","scale","interval","min","max"],pie:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToYAxisComponents[this.model.get("viz_type")];e.indexOf(n,"title")>-1&&(this.children.title=new i({className:"y-axis-title control-group",model:this.model,xAxis:!1})),e.indexOf(n,"scale")>-1&&(this.children.scale=new s({model:this.model,className:"scale control-group",controlClass:"controls-halfblock"})),e.indexOf(n,"interval")>-1&&(this.children.interval=new o({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"min")>-1&&(this.children.min=new u({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"max")>-1&&(this.children.max=new a({model:this.model,controlClass:"controls-block"})),this.model.get("display.visualizations.charting.axisY.scale")=="log"&&this.children.interval.$el.hide()},events:{"click .scale button":function(e){this.intervalVal=this.intervalVal||this.model.get("display.visualizations.charting.axisLabelsY.majorUnit"),t(e.currentTarget).data("value")=="log"?(this.children.interval.$el.hide(),this.model.set("display.visualizations.charting.axisLabelsY.majorUnit","")):(this.children.interval.$el.show(),this.model.set("display.visualizations.charting.axisLabelsY.majorUnit",this.intervalVal))}},render:function(){return this.children.title&&this.$el.append(this.children.title.render().el),this.children.scale&&this.$el.append(this.children.scale.render().el),this.children.interval&&this.$el.append(this.children.interval.render().el),this.children.min&&this.$el.append(this.children.min.render().el),this.children.max&&this.$el.append(this.children.max.render().el),this}})}),define("views/shared/vizcontrols/components/Legend",["underscore","jquery","module","views/Base","views/shared/controls/ControlGroup","views/shared/vizcontrols/custom_controls/DrilldownRadioGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup","views/shared/vizcontrols/custom_controls/LegendPlacementControlGroup","views/shared/vizcontrols/custom_controls/LegendTruncationControlGroup","views/shared/vizcontrols/custom_controls/StackModeControlGroup","views/shared/vizcontrols/custom_controls/NullValueModeControlGroup","views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup","views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup","views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToLegendComponents:{line:["placement","truncation"],bar:["placement","truncation"],area:["placement","truncation"],column:["placement","truncation"],scatter:["placement","truncation"],pie:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToLegendComponents[this.model.get("viz_type")];e.indexOf(n,"placement")>-1&&(this.children.placement=new l({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"truncation")>-1&&(this.children.truncation=new c({model:this.model,controlClass:"controls-thirdblock"}))},render:function(){return this.children.placement&&this.$el.append(this.children.placement.render().el),this.children.truncation&&this.$el.append(this.children.truncation.render().el),this}})}),define("views/shared/vizcontrols/components/color/ColorPicker",["underscore","jquery","module","views/shared/PopTart"],function(e,t,n,r){return r.extend({moduleId:n.id,className:"popdown-dialog color-picker-container",initialize:function(){r.prototype.initialize.apply(this,arguments),this.clone=this.model.clone()},events:{"click .swatch":function(e){var n=t(e.currentTarget).data().color,r="0x"+n.substring(1);this.clone.set({color:r}),this.$(".swatch-hex input").val(n.substring(1)),this.$(".big-swatch").css("background-color",n),e.preventDefault()},"click .color-picker-apply":function(e){this.model.set({color:this.clone.get("color"),shadedcolor:this.options.shadeColor(this.clone.get("color").substring(2),-40)}),this.model.trigger("color-picker-apply",this.options.index),this.hide(),e.stopPropagation()},"click .color-picker-cancel":function(e){this.hide(),e.stopPropagation()},"keyup .hex-input":function(e){var n=t(e.currentTarget).val();this.clone.set("color","0x"+n),this.$(".big-swatch").css("background-color","#"+n),e.preventDefault()}},render:function(){this.$el.html(r.prototype.template),this.$el.append(this._buttonTemplate),this.$(".popdown-dialog-body").addClass("color-picker-content");var e=t('<div class="clearfix"></div>').appendTo(this.$(".popdown-dialog-body"));e.append(this.compiledTemplate({model:this.clone}))},template:'                <div class="swatches">                    <ul class="swatch-holder unstyled">                        <li class="swatch" data-color="#7e9f44" style="background-color: #7e9f44"></li>                        <li class="swatch" data-color="#ebe42d" style="background-color: #ebe42d"></li>                        <li class="swatch" data-color="#d13b3b" style="background-color: #d13b3b"></li>                        <li class="swatch" data-color="#6cb8ca" style="background-color: #6cb8ca"></li>                        <li class="swatch" data-color="#f7912c" style="background-color: #f7912c"></li>                        <li class="swatch" data-color="#956e96" style="background-color: #956e96"></li>                        <li class="swatch" data-color="#c2da8a" style="background-color: #c2da8a"></li>                        <li class="swatch" data-color="#fac61d" style="background-color: #fac61d"></li>                        <li class="swatch" data-color="#ebb7d0" style="background-color: #ebb7d0"></li>                        <li class="swatch" data-color="#324969" style="background-color: #324969"></li>                        <li class="swatch" data-color="#d85e3d" style="background-color: #d85e3d"></li>                        <li class="swatch" data-color="#a04558" style="background-color: #a04558"></li>                    </ul>                </div>                <div class="big-swatch" data-color="<%- model.get("color").substring(2) %>" style="background-color: #<%- model.get("color").substring(2) %>;"></div>                <div class="swatch-hex">                    <div class="input-prepend views-shared-controls-textcontrol">                        <span class="add-on">#</span>                        <input type="text" class="hex-input" value="<%-model.get("color").substring(2) %>">                    </div>                </div>            ',_buttonTemplate:'                <div class="color-picker-buttons clearfix">                    <a class="color-picker-cancel btn pull-left">'+e("Cancel").t()+'</a>                    <a class="color-picker-apply btn btn-primary pull-right"> '+e("Apply").t()+"</a>                </div>            "})}),define("views/shared/vizcontrols/components/color/Ranges",["underscore","jquery","module","views/Base","views/shared/vizcontrols/components/color/ColorPicker","collections/Base"],function(e,t,n,r,i,s){return r.extend({className:"tab-pane clearfix",moduleId:n.id,palette:["0x7e9f44","0xebe42d","0xd13b3b","0x6cb8ca","0xf7912c","0x956e96","0xc2da8a","0xfac61d","0xebb7d0","0x324969","0xd85e3d","0xa04558"],initialize:function(){r.prototype.initialize.apply(this,arguments),this.collection={},this.collection.rows=new s,this.initRowsFromModel(),this.collection.rows.on("add remove",this.render,this),this.collection.rows.on("color-picker-apply",this.render,this),this.collection.rows.on("change",this.syncModel,this)},initRowsFromModel:function(){var t=this.model.rangesValuesToArray(),n=t.length>0?t:["0","30","70","100"],r=this.model.deserializeGaugeColorArray(),i=r.length>0?r:["0x84E900","0xFFE800","0xBF3030"];e(n).each(function(e,t){this.collection.rows.push({value:e,nextValue:n[t+1],color:t!=0?i[t-1]:void 0,shadedcolor:t!=0?this.shadeColor(i[t-1],-40):void 0})},this)},syncModel:function(){this.model.set({"display.visualizations.charting.chart.rangeValues":JSON.stringify(this.collection.rows.pluck("value")),"display.visualizations.charting.gaugeColors":"["+e(this.collection.rows.pluck("color")).filter(function(t){return!e.isUndefined(t)}).join(",")+"]"})},events:{"click .add-color-range":function(e){var t=this.palette[Math.floor(Math.random()*12)];this.collection.rows.push({value:this.options.prepopulateNewRanges?parseInt(this.collection.rows.last().get("value"),10)*2:"",nextValue:"",color:t,shadedcolor:this.shadeColor(t,-40)}),e.stopPropagation()},"keyup .range-value":e.debounce(function(e){var n=t(e.currentTarget),r=n.data().index;this.collection.rows.at(r).set("value",n.val());var i=this.$el.find('[data-prev="'+r+'"]');i&&i.text(n.val()+" to"),e.preventDefault()},300),"click .color-square":function(e){var n=t(e.currentTarget),r=n.css("background-color");this.children.colorPicker=new i({model:this.collection.rows.at(n.parent().siblings("input").data().index),shadeColor:this.shadeColor,onHiddenRemove:!0}),t("body").append(this.children.colorPicker.render().el),this.children.colorPicker.show(n),e.preventDefault()},"click .remove-range":function(e){var n=t(e.currentTarget).siblings("input").data().index;this.collection.rows.remove(this.collection.rows.at(n)),e.stopPropagation()}},shadeColor:function(e,t){var n=parseInt(e,16),r=(n&16711680)>>16,i=(n&65280)>>8,s=(n&255)>>0;return r+=Math.floor(t/255*r),i+=Math.floor(t/255*i),s+=Math.floor(t/255*s),((r<<16)+(i<<8)+s).toString(16)},render:function(){return this.syncModel(),this.$el.html(this.compiledTemplate({_:e,collection:this.collection.rows})),this},template:'                <div class="color-rows form-horizontal">                    <div class="from-color-group">                        <div class="control-group">                            <label class="lower-range-label control-label"><%- _("from").t() %></label>                            <div class="controls">                                <input class="first-row-lower range-value" value="<%- collection.at(0).get("value") %>" data-index=0 type="text">                            </div>                        </div>                    </div>                    <div class="to-color-group">                        <div class="control-group">                            <label class="control-label upper-range-label to-label"><%- _("to").t() %></label>                            <div class="controls right-input">                                <div class="input-append">                                    <input  class="first-row-upper range-value" value="<%- collection.at(1).get("value") %>" data-index=1 type="text">                                    <div class="add-on color-picker-add-on">                                        <div class="color-square" style="border-color: #<%- collection.at(1).get("shadedcolor")%>; background-color: #<%- collection.at(1).get("color").substring(2) %>;"></div>                                    </div>                                </div>                            </div>                        </div>                    </div>                    <% collection.each(function(model, i) { %>                        <% if(!(i==0 || i==1)) {%>                            <div class="extra-color-group">                                <div class="control-group">                                    <label class="upper-range-label control-label" data-prev="<%- i-1 %>"><%- collection.at(i-1).get("value")%>&nbsp;<span class="label-to"><%- _("to").t() %></span></label>                                    <div class="controls input-append">                                        <input  class="range-value" value="<%- model.get("value") %>" data-index=<%-i%> type="text">                                        <div class="add-on color-picker-add-on">                                            <div class="color-square" style="border-color: #<%- model.get("shadedcolor")%>; background-color: #<%- model.get("color").substring(2) %>;"></div>                                        </div>                                        <a class="remove-range btn-link"><i class="icon-x-circle"></i></a>                                    </div>                                </div>                            </div>                        <% } %>                    <% }); %>                </div>                <a href="#" class="add-color-range btn pull-right"> + <%- _("Add Range").t() %></a>            '})}),define("views/shared/vizcontrols/components/color/Master",["underscore","jquery","module","splunk.util","models/Base","views/Base","views/shared/controls/ControlGroup","views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup","views/shared/vizcontrols/components/color/Ranges"],function(e,t,n,r,i,s,o,u,a){return s.extend({moduleId:n.id,className:" form form-horizontal",controlClass:"controls-halfblock",vizToColorRangeComponents:{line:[],area:[],column:[],bar:[],pie:[],scatter:[],radialGauge:["range"],fillerGauge:["range"],markerGauge:["range"],single:[],events:[],statistics:[]},initialize:function(t){s.prototype.initialize.apply(this,arguments);var n=this.vizToColorRangeComponents[this.model.get("viz_type")];e.indexOf(n,"range")>-1&&(this.autoModeModel=new i,this.children.toggle=new u({model:this.autoModeModel,vizModel:this.model}),this.autoModeModel.on("change:autoMode",this.updateRangesVisibility,this)),this.children.colorRanges=new a({model:this.model})},render:function(){return this.children.toggle&&this.$el.append(this.children.toggle.render().el),this.$el.append(this.children.colorRanges.render().el),this.updateRangesVisibility(),this},remove:function(){this.autoModeModel.off(null,null,this)},updateRangesVisibility:function(){this.autoModeModel.get("autoMode")==="1"?this.children.colorRanges.$el.hide():this.children.colorRanges.$el.show()}})}),define("views/shared/vizcontrols/components/Master",["underscore","jquery","module","views/Base","views/shared/FlashMessages","views/shared/vizcontrols/components/General","views/shared/vizcontrols/components/XAxis","views/shared/vizcontrols/components/YAxis","views/shared/vizcontrols/components/Legend","views/shared/vizcontrols/components/color/Master"],function(e,t,n,r,i,s,o,u,a,f){return r.extend({moduleId:n.id,className:"tabbable tabs-left",initialize:function(t){r.prototype.initialize.apply(this,arguments),this.children.flashMessages=new i({model:this.model}),this.type=this.model.get("viz_type"),e.indexOf(this.model.components[this.type],"gen")>-1&&(this.children.general=new s({model:this.model})),e.indexOf(this.model.components[this.type],"x")>-1&&(this.children.xaxis=new o({model:this.model})),e.indexOf(this.model.components[this.type],"y")>-1&&(this.children.yaxis=new u({model:this.model})),e.indexOf(this.model.components[this.type],"leg")>-1&&(this.children.legend=new a({model:this.model})),e.indexOf(this.model.components[this.type],"ranges")>-1&&(this.children.ranges=new f({model:this.model}))},events:{"click a[data-toggle]":function(n){var r=t(n.currentTarget),i=r.data().type;e(this.children).each(function(e){e.$el.hide()},this),this.children[i].$el.show(),this.$el.find(".nav > li").removeClass("active"),r.parent().addClass("active"),n.preventDefault()}},render:function(){return this.$el.html(e(this.template).template({_:e,tabs:this.model.components[this.type]})),this.$(".tab-content").prepend(this.children.flashMessages.render().el),e(this.children).each(function(e){this.$(".tab-content").append(e.render().el),e.$el.hide()},this),this.children.general.$el.show(),this},template:'                <ul class="nav nav-tabs">                    <% if (_.indexOf(tabs, "gen")>-1) { %>                        <li class="active">                            <a href="#" data-toggle="tab" data-type="general"><%- _("General").t() %></a>                        </li>                    <% } %>                    <% if (_.indexOf(tabs, "x")>-1) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="xaxis"><%- _("X-Axis").t() %></a>                        </li>                    <% } %>                    <% if (_.indexOf(tabs, "y")>-1) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="yaxis"><%- _("Y-Axis").t() %></a>                        </li>                    <% } %>                    <% if (_.indexOf(tabs, "leg")>-1) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="legend"><%- _("Legend").t() %></a>                        </li>                    <% } %>                    <% if (_.indexOf(tabs, "ranges")>-1) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="ranges"><%- _("Color Ranges").t() %></a>                        </li>                    <% } %>                </ul>                <div class="tab-content"></div>            '})}),define("views/shared/vizcontrols/Format",["underscore","jquery","module","views/shared/PopTart","views/shared/vizcontrols/components/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,options:{saveOnApply:!1},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.children.visualizationControls&&this.children.visualizationControls.remove(),this.children.visualizationControls=new i({model:this.model.visualization}),t(window).on("keydown."+this.cid,this.windowKeydown.bind(this))},events:{"click .viz-editor-apply":function(e){this.model.visualization.validate(),this.model.visualization.isValid()&&(this.model.report.entry.content.set(t.extend({},this.model.visualization.toJSON())),this.options.saveOnApply&&this.model.report.save(),this.hide()),e.preventDefault()},"click .viz-editor-cancel":function(e){this.hide(),e.preventDefault()}},windowKeydown:function(e){var n=27,r=13;e.keyCode==n&&t(".viz-editor-cancel").click(),e.keyCode==r&&t(".viz-editor-apply").click()},remove:function(){return t(window).off("keydown."+this.cid),r.prototype.remove.apply(this,arguments),this},render:function(){return this.$el.html(r.prototype.template),this.$el.append(this.template),this.$(".popdown-dialog-body").append(this.children.visualizationControls.render().el),this.$(".popdown-dialog-body").removeClass("popdown-dialog-padded"),this},template:'                    <a class="viz-editor-cancel btn pull-left">'+e("Cancel").t()+'</a>                    <a class="viz-editor-apply btn btn-primary pull-right"> '+e("Apply").t()+"</a>            "})}),define("models/Visualization",["jquery","underscore","models/Base","splunk.util"],function(e,t,n,r){return n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments)},components:{single:["gen"],line:["gen","x","y","leg"],area:["gen","x","y","leg"],column:["gen","x","y","leg"],bar:["gen","x","y","leg"],pie:["gen"],scatter:["gen","x","y","leg"],radialGauge:["gen","ranges"],fillerGauge:["gen","ranges"],markerGauge:["gen","ranges"],statistics:["gen"],events:["gen"]},defaults:{"display.visualizations.charting.axisY.scale":"linear","display.visualizations.charting.axisX.scale":"linear","display.visualizations.charting.axisX.minimumNumber":"","display.visualizations.charting.axisX.maximumNumber":"","display.visualizations.charting.axisY.minimumNumber":"","display.visualizations.charting.axisY.maximumNumber":"","display.visualizations.charting.axisTitleX.text":"","display.visualizations.charting.axisTitleY.text":"","display.visualizations.charting.axisLabelsX.majorUnit":"","display.visualizations.charting.axisLabelsY.majorUnit":"","display.visualizations.charting.legend.placement":"right","display.visualizations.charting.legend.labelStyle.overflowMode":"ellipsisMiddle","display.visualizations.charting.chart.stackMode":"default","display.visualizations.charting.chart.nullValueMode":"zero","display.visualizations.charting.chart.sliceCollapsingThreshold":.01,"display.visualizations.charting.chart.rangeValues":'["0","30","70","100"]',"display.visualizations.charting.chart.style":"shiny","display.visualizations.charting.gaugeColors":[8710400,16771072,12529712],"display.prefs.events.count":"10","display.prefs.statistics.count":"10"},validation:{"display.visualizations.charting.axisX.minimumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisX.maximumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisY.minimumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY.maximumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisLabelsX.majorUnit":[{fn:"validateNumberOrAuto",required:!1}],"display.visualizations.charting.axisLabelsY.majorUnit":[{fn:"validateNumberOrAuto",required:!1}],"display.visualizations.charting.axisY.scale":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.stackMode":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.sliceCollapsingThreshold":{pattern:"number",min:0,msg:t("Minimum Size must be a non-negative number.").t(),required:!1},"display.visualizations.charting.chart.rangeValues":{fn:"validateRangeValues",required:!1},"display.prefs.events.count":{pattern:"digits",min:1,msg:t("Rows Per Page must be a positive number.").t(),required:!0},"display.prefs.statistics.count":{pattern:"digits",min:1,msg:t("Rows Per Page must be a positive number.").t(),required:!0}},validateXAxisExtremes:function(e,n,r){var i=n==="display.visualizations.charting.axisX.minimumNumber"?parseFloat(e):parseFloat(r["display.visualizations.charting.axisX.minimumNumber"]),s=n==="display.visualizations.charting.axisX.maximumNumber"?parseFloat(e):parseFloat(r["display.visualizations.charting.axisX.maximumNumber"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The X-Axis Min Value must be less than the Max Value.").t()},validateYAxisExtremes:function(e,n,r){var i=n==="display.visualizations.charting.axisY.minimumNumber"?parseFloat(e):parseFloat(r["display.visualizations.charting.axisY.minimumNumber"]),s=n==="display.visualizations.charting.axisY.maximumNumber"?parseFloat(e):parseFloat(r["display.visualizations.charting.axisY.maximumNumber"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The Y-Axis Min Value must be less than the Max Value.").t()},validateYScaleAndStacking:function(e,n,r){var i=n==="display.visualizations.charting.axisY.scale"?e:r["display.visualizations.charting.axisY.scale"],s=n==="display.visualizations.charting.chart.stackMode"?e:r["display.visualizations.charting.chart.stackMode"];if(i==="log"&&s!=="default")return t("Log scale and stacking cannot be enabled at the same time.").t()},validateRangeValues:function(n){var r=t(n?JSON.parse(n):[]).map(parseFloat);if(t(r).any(t.isNaN))return t("All color ranges must be valid numbers.").t();var i=t.uniq(r),s=e.extend([],r).sort(function(e,t){return e-t});if(!t.isEqual(r,i)||!t.isEqual(r,s))return t("Color ranges must be entered from lowest to highest.").t()},validateNumberOrAuto:function(e,n,i){var s=parseFloat(e),o;switch(n){case"display.visualizations.charting.axisLabelsX.majorUnit":o="X-Axis Interval";break;case"display.visualizations.charting.axisLabelsY.majorUnit":o="Y-Axis Interval";break;case"display.visualizations.charting.axisX.minimumNumber":o="X-Axis Min Value";break;case"display.visualizations.charting.axisY.minimumNumber":o="Y-Axis Min Value";break;case"display.visualizations.charting.axisX.maximumNumber":o="X-Axis Max Value";break;case"display.visualizations.charting.axisY.maximumNumber":o="Y-Axis Max Value";break;default:o=n}if(n==="display.visualizations.charting.axisLabelsX.majorUnit"||n==="display.visualizations.charting.axisLabelsY.majorUnit"){if(e&&(t.isNaN(s)||s<=0)&&!e.match(/^(auto)$/))return r.sprintf(t('%s must be a positive number or "auto".').t(),o)}else if(e&&t.isNaN(s)&&!e.match(/^(auto)$/))return r.sprintf(t('%s must be a number or "auto".').t(),o)},attrToArray:function(e){var n=this.get(e);return n?t.values(JSON.parse(n)):[]},rangesValuesToArray:function(){return this.attrToArray("display.visualizations.charting.chart.rangeValues")},deserializeGaugeColorArray:function(){var e=this.get("display.visualizations.charting.gaugeColors");return e.charAt(0)!=="["||e.charAt(e.length-1)!=="]"?!1:r.stringToFieldList(e.substring(1,e.length-1))},gaugeIsInAutoMode:function(){return!this.get("display.visualizations.charting.chart.rangeValues")&&!this.get("display.visualizations.charting.gaugeColors")}},{CHARTING_ATTRS_FILTER:["^display.visualizations.charting...*"],SINGLE_VALUE_ATTRS_FILTER:["^singlevalue..*"]})}),define("views/shared/vizcontrols/Master",["underscore","backbone","module","views/Base","views/shared/controls/SyntheticSelectControl","views/shared/vizcontrols/Format","models/services/search/IntentionsParser","models/Visualization"],function(e,t,n,r,i,s,o,u){return r.extend({moduleId:n.id,options:{saveOnApply:!1},vizToAttrs:{line:{"display.visualizations.charting.chart":"line","display.visualizations.type":"charting","display.general.type":"visualizations"},area:{"display.visualizations.charting.chart":"area","display.visualizations.type":"charting","display.general.type":"visualizations"},column:{"display.visualizations.charting.chart":"column","display.visualizations.type":"charting","display.general.type":"visualizations"},bar:{"display.visualizations.charting.chart":"bar","display.visualizations.type":"charting","display.general.type":"visualizations"},pie:{"display.visualizations.charting.chart":"pie","display.visualizations.type":"charting","display.general.type":"visualizations"},scatter:{"display.visualizations.charting.chart":"scatter","display.visualizations.type":"charting","display.general.type":"visualizations"},radialGauge:{"display.visualizations.charting.chart":"radialGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},fillerGauge:{"display.visualizations.charting.chart":"fillerGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},markerGauge:{"display.visualizations.charting.chart":"markerGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},single:{"display.visualizations.type":"singlevalue","display.general.type":"visualizations"},events:{"display.general.type":"events"},statistics:{"display.general.type":"statistics"}},visualizationGroupings:{events:{label:"g1",items:[{value:"events",label:e("Events").t(),icon:"list",description:e(" ").t()}]},statistics:{label:"g2",items:[{value:"statistics",label:e("Statistics Table").t(),icon:"table",description:e(" ").t()}]},visualizations:{label:"g3",items:[{value:"line",label:e("Line").t(),icon:"chart-line",description:e(" ").t()},{value:"area",label:e("Area").t(),icon:"chart-area",description:e(" ").t()},{value:"column",label:e("Column").t(),icon:"chart-column",description:e(" ").t()},{value:"bar",label:e("Bar").t(),icon:"chart-bar",description:e(" ").t()},{value:"pie",label:e("Pie").t(),icon:"chart-pie",description:e(" ").t()},{value:"scatter",label:e("Scatter").t(),icon:"chart-scatter",description:e(" ").t()},{value:"single",label:e("Single Value").t(),icon:"single-value",description:e(" ").t()},{value:"radialGauge",label:e("Radial Gauge").t(),icon:"gauge-radial",description:e(" ").t()},{value:"fillerGauge",label:e("Filler Gauge").t(),icon:"gauge-filler",description:e(" ").t()},{value:"markerGauge",label:e("Marker Gauge").t(),icon:"gauge-marker",description:e(" ").t()}]}},reportTree:{match:{"display.general.type":{visualizations:{match:{"display.visualizations.type":{singlevalue:{view:"single"},charting:{match:{"display.visualizations.charting.chart":{line:{view:"line"},area:{view:"area"},column:{view:"column"},bar:{view:"bar"},pie:{view:"pie"},scatter:{view:"scatter"},radialGauge:{view:"radialGauge"},fillerGauge:{view:"fillerGauge"},markerGauge:{view:"markerGauge"}}}}}}},statistics:{view:"statistics"},events:{view:"events"}}}},commandToChartType:{timechart:["line","area","column"],top:["column","bar","pie"],rare:["column","bar","pie"]},initialize:function(){r.prototype.initialize.apply(this,arguments);var t={bindToChangeOfSearch:!0};this.options=$.extend(!0,t,this.options),this.model.intentionsParser=new o,this.model.intentionsParser.on("change",this.render,this),this.model.visualization=new u,this.model.visualization.set({dashboard:this.options.dashboard}),this.setVisualizationFromReport(),this.setSyntheticSelectGroups(),this.model.report.entry.content.on("change:display.general.type",function(t,n,r){e.indexOf(this.options.vizTypes,n)>-1&&(this.setVisualizationFromReport(),this.setSyntheticSelectGroups(),this.render())},this),this.model.visualization.on("change:viz_type",function(){var e=this.model.visualization.get("viz_type");this.model.report.entry.content.set("viz_type",e),this.model.report.entry.content.set(this.vizToAttrs[e]),this.model.visualization.set(this.vizToAttrs[e]),this.options.saveOnApply&&this.model.report.save()},this),this.model.report.entry.content.on("change:search change:id",this.updateVizTypeVisability,this),this.options.bindToChangeOfSearch&&this.model.report.entry.content.on("change:search",this.intentionsFetch,this),this.intentionsFetch()},intentionsFetch:function(){this.model.intentionsParser.fetch({data:{q:this.model.report.entry.content.get("search"),app:this.model.application.get("app"),owner:this.model.application.get("owner"),parse_only:!0}})},updateVizTypeVisability:function(){if(!this.children.visualizationType||!this.model.visualization.get("dashboard"))return;this.model.report.isPivotReport()&&!this.model.report.isNew()?(this.children.visualizationType.disable(),this.children.visualizationType.tooltip({animation:!1,title:e("Edit visualization with the pivot tool.").t(),container:"body"})):(this.children.visualizationType.enable(),this.children.visualizationType.tooltip("disable"))},setRecommendations:function(){if(this.model.intentionsParser.has("reportsSearch")){var t=this.model.intentionsParser.get("reportsSearch"),n=!1;if(t){var r=t.replace(/\s{2,}/g,":::").split(":::")[0];r&&(this.recommenedTypes=this.commandToChartType[r],this.recommenedTypes&&!!this.recommenedTypes.length&&e.chain(this.visualizationGroupings.visualizations.items).filter(function(e){return this.recommenedTypes.indexOf(e.value)>-1},this).each(function(t){this.children.visualizationType.$el.find("li a[data-value='"+t.value+"'] > span.link-description").text(e("Recommended").t()),n=!0},this).value()),n&&this.children.visualizationType.$el.find("li a[data-value='statistics'] > span.link-description").text(e("Recommended").t())}else this.children.visualizationType.$el.find("li a[data-value='events'] > span.link-description").text(e("Recommended").t())}},setVisualizationFromReport:function(){this.model.report.entry.content.unset("viz_type"),this.model.visualization.set($.extend({},this.model.report.entry.content.toJSON()));var e=this.setVizType(this.reportTree),t;t=e&&e.view?e.view:"column",this.model.visualization.set("viz_type",t)},setSyntheticSelectGroups:function(){var t=[],n=this.model.report.entry.content;this.children.visualizationType&&this.children.visualizationType.remove(),this.options.vizTypes&&e(this.options.vizTypes).each(function(e,n){t.push(this.visualizationGroupings[e])},this),t.length&&(this.children.visualizationType=new i({model:this.model.visualization,groupedItems:t,className:"btn-combo pull-left",toggleClassName:"btn-pill",modelAttribute:"viz_type",menuClassName:"viz-dropdown",popdownOptions:{attachDialogTo:"body"}}))},setVizType:function(t){if(t&&t.view)return t;if(t&&t.match){var n;e(t.match).each(function(e,t){n=e[this.model.report.entry.content.get(t)]},this);if(n)return this.setVizType(n)}},events:{"click .format":function(e){var t=$(e.currentTarget);this.setVisualizationFromReport(),this.children.format=new s({model:{report:this.model.report,visualization:this.model.visualization},onHiddenRemove:!0,saveOnApply:this.options.saveOnApply,ignoreClasses:["color-picker-container"]}),$("body").append(this.children.format.render().el),this.children.format.show(t),e.preventDefault()}},render:function(){return this.$el.empty(),this.setSyntheticSelectGroups(),this.children.visualizationType&&this.$el.append(this.children.visualizationType.render().el),this.setRecommendations(),this.updateVizTypeVisability(),this.$el.append(this.template),this},template:'                <div class="btn-group pull-left">                    <a class="btn-pill popdown-toggle format" href="#">                        <i class="icon-paintbrush"/><span class="link-label">'+e("Format").t()+'</span><span class="caret"></span>                    </a>                </div>            '})}),define("views/shared/reportcontrols/details/History",["module","views/Base"],function(e,t){return t.extend({moduleId:e.id,tagName:"span",initialize:function(){t.prototype.initialize.apply(this,arguments),this.model.entry.on("change:updated",this.render,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model})),this},template:'                Created June 18, 2010. Modified <%- model.entry.get("updated") %>.            '})}),define("views/shared/reportcontrols/details/Creator",["underscore","module","views/Base","uri/route","splunk.util"],function(e,t,n,r,i){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.report.entry.content.on("change:display.page.pivot.dataModel",this.render,this)},render:function(){var t,n,s=this.model.application.get("root"),o=this.model.application.get("locale"),u=this.model.application.get("app");return this.model.report.openInView()==="pivot"?(t=r.pivot(s,o,u,{data:{s:this.model.report.id}}),n='<a href="'+t+'" >'+e("Pivot").t()+"</a>"):(t=r.search(s,o,u,{data:{s:this.model.report.id}}),n='<a href="'+t+'" >'+e("Search").t()+"</a>"),this.$el.html(this.compiledTemplate({_:e,splunkUtil:i,createdByAnchor:n})),this},template:'                <%= splunkUtil.sprintf(_("Created by %s.").t(), createdByAnchor) %>            '})}),define("views/shared/documentcontrols/details/App",["module","views/Base"],function(e,t){return t.extend({moduleId:e.id,tagName:"span",initialize:function(){t.prototype.initialize.apply(this,arguments),this.model.entry.acl.on("change:app",this.render,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model})),this},template:'                <%- model.entry.acl.get("app") %>            '})}),define("models/Cron",["jquery","underscore","models/Base","splunk.util"],function(e,t,n,r){var i=n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments)},defaults:{minute:"0",hour:"6",dayOfMonth:"*",month:"*",dayOfWeek:"1",cronType:"weekly",cron_schedule:"0 6 * * 1"},validation:{cron_schedule:function(n,i,s){var o=s["ui.type"]||"scheduled";if(o==="scheduled"&&s.cronType==="custom"){if(t.isUndefined(n)||e.trim(n).length===0)return t("Custom cron is required").t();if(!r.validateCronString(n))return t("Invalid cron").t()}}},setCronType:function(e){var t=this.get("minute"),n=this.get("hour"),r=this.get("dayOfMonth"),s=this.get("month"),o=this.get("dayOfWeek");if(s!=="*"){this.set("cronType",i.CRON_TYPES.CUSTOM,e);return}if(/^[0-6]$/.test(o)){if(t==="0"&&/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&r==="*"){this.set("cronType",i.CRON_TYPES.WEEKLY,e);return}}else if(o==="*")if(/^([0-9]|[1-2][0-9]|3[0-1])$/.test(r)){if(/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&t==="0"){this.set("cronType",i.CRON_TYPES.MONTHLY,e);return}}else if(r==="*"){if(/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&t==="0"){this.set("cronType",i.CRON_TYPES.DAILY,e);return}if(n==="*"&&/^(0|15|30|45)$/.test(t)){this.set("cronType",i.CRON_TYPES.HOURLY,e);return}}this.set("cronType",i.CRON_TYPES.CUSTOM,e)},setDefaults:function(){switch(this.get("cronType")){case i.CRON_TYPES.HOURLY:this.set("minute","0");break;case i.CRON_TYPES.DAILY:this.set("hour","0");break;case i.CRON_TYPES.WEEKLY:this.set({dayOfWeek:"1",hour:"0"});break;case i.CRON_TYPES.MONTHLY:this.set({dayOfMonth:"1",hour:"0"})}},getCronString:function(){var e=this.get("minute"),t=this.get("hour"),n=this.get("dayOfMonth"),r=this.get("month"),s=this.get("dayOfWeek"),o=this.get("cron_schedule"),u=this.get("cronType");switch(u){case i.CRON_TYPES.HOURLY:return e+" * * * *";case i.CRON_TYPES.DAILY:return"0 "+t+" * * *";case i.CRON_TYPES.WEEKLY:return"0 "+t+" * * "+s;case i.CRON_TYPES.MONTHLY:return"0 "+t+" "+n+" * *";case i.CRON_TYPES.CUSTOM:return o}},getDayOfWeekName:function(){return i.getDayOfWeekNameFromNum(parseInt(this.get("dayOfWeek"),10))},getScheduleString:function(){switch(this.get("cronType")){case"hourly":return r.sprintf(t("Hourly, at %s minutes past the hour.").t(),this.get("minute"));case"daily":return r.sprintf(t("Daily, at %s:00.").t(),this.get("hour"));case"weekly":return r.sprintf(t("Weekly, %(dayOfWeek)s at %(hour)s:00.").t(),{dayOfWeek:this.getDayOfWeekName(),hour:this.get("hour")});case"monthly":return r.sprintf(t("Monthly, on day %(dayOfMonth)s at %(hour)s:00.").t(),{dayOfMonth:this.get("dayOfMonth"),hour:this.get("hour")});case"custom":return t("Cron Schedule.").t()}}},{createFromCronString:function(e){var n=e.split(/\s+/);if(!n||n.length!==5)throw r.sprintf(t("Invalid cron string: %s").t(),e);var s=new i({minute:n[0],hour:n[1],dayOfMonth:n[2],month:n[3],dayOfWeek:n[4],cron_schedule:n.join(" ")});return s.setCronType(),s},getDayOfWeekNameFromNum:function(e){switch(e){case 0:return t("Sunday").t();case 1:return t("Monday").t();case 2:return t("Tuesday").t();case 3:return t("Wednesday").t();case 4:return t("Thursday").t();case 5:return t("Friday").t();case 6:return t("Saturday").t();case 7:return t("Sunday").t()}},CRON_TYPES:{HOURLY:"hourly",DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",CUSTOM:"custom"}});return i}),define("views/shared/reportcontrols/details/Schedule",["underscore","module","views/Base","models/Cron","util/time_utils","splunk.util"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.content.on("change:is_scheduled change:cron_schedule change:action.email change:action.script",t,this)},render:function(){var t=e("Not Applicable for Real-time Reports.").t();this.model.isRealTime()||(this.model.entry.content.get("is_scheduled")?(this.cronModel=r.createFromCronString(this.model.entry.content.get("cron_schedule")),t=this.cronModel.getScheduleString(),this.model.entry.content.get("action.email")||this.model.entry.content.get("action.script")?t+=s.sprintf(e(" Actions: %s.").t(),this.model.getStringOfActions()):t+=e(" No actions.").t()):t=e("Not scheduled.").t()),this.$el.html(t)}})}),define("views/shared/delegates/ModalTimerangePicker",["jquery","underscore","views/shared/delegates/Base","views/shared/delegates/PopdownDialog","views/shared/Modal"],function(e,t,n,r,i){return n.extend({initialize:function(){var e={SLIDE_ANIMATION_DURATION:500};t.defaults(this.options,e),this.$visArea=this.options.$visArea,this.$slideArea=this.options.$slideArea,this.$contentWrapper=this.options.$contentWrapper,this.$timeRangePickerWrapper=this.options.$timeRangePickerWrapper,this.$modalParent=this.options.$modalParent,this.$timeRangePicker=this.options.$timeRangePicker,this.title=this.$(i.HEADER_TITLE_SELECTOR).html(),this.events={},this.events["click "+this.options.backButtonSelector]="closeTimeRangePicker",this.events["click "+this.options.activateSelector]="showTimeRangePicker",this.delegateEvents(this.events),this.$timeRangePicker.hide()},showTimeRangePicker:function(){var e=this.$contentWrapper,n=this.$timeRangePickerWrapper,r=e.width();this.onBeforePaneAnimation(e,n);var s=n.width(),o=n.height();this.$modalParent.animate({width:s,marginLeft:-(2*r/3)},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$visArea.animate({height:o},{duration:this.options.SLIDE_ANIMATION_DURATION,complete:function(){this.onAfterPaneAnimation(e,n)}.bind(this)},this),this.$slideArea.animate({marginLeft:-r},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$el.animate({width:s},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$(i.HEADER_TITLE_SELECTOR).html(t("Select Time Range").t()),this.$(".btn.back").show(),this.$(".btn-primary").hide(),this.$(".btn.cancel").hide()},closeTimeRangePicker:function(){var e=this.$timeRangePickerWrapper,t=this.$contentWrapper,n=t.width();this.onBeforePaneAnimation(e,t),this.$modalParent.animate({width:n,marginLeft:-(n/2)},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$visArea.animate({height:t.height()},{duration:this.options.SLIDE_ANIMATION_DURATION,complete:function(){this.onAfterPaneAnimation(e,t)}.bind(this)},this),this.$slideArea.animate({marginLeft:0},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$el.animate({width:n},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$(i.HEADER_TITLE_SELECTOR).html(this.title),this.$(".btn.back").hide(),this.$(".btn-primary").show(),this.$(".btn.cancel").show()},onBeforePaneAnimation:function(e,t){this.$visArea.css("overflow","hidden"),this.$visArea.css({height:e.height()+"px"}),t===this.$timeRangePickerWrapper&&this.$timeRangePicker.show(),t.css({height:"",visibility:""})},onAfterPaneAnimation:function(e,t){e===this.$timeRangePickerWrapper&&this.$timeRangePicker.hide(),this.$visArea.css("overflow",""),this.$visArea.css({height:""}),e.css({height:"2px",visibility:"hidden"})}})}),define("views/shared/ScheduleSentence",["jquery","module","underscore","views/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticSelectControl"],function(e,t,n,r,i,s){return r.extend({moduleId:t.id,initialize:function(){r.prototype.initialize.apply(this,arguments);var t={lineOneLabel:"",lineTwoLabel:""};n.defaults(this.options,t);var o=function(e){var t=e.toString();return{label:t,value:t}},u=n.map(n.range(0,46,15),o),a=n.map(n.range(24),function(e){return{label:e+":00",value:e.toString()}}),f=n.map(n.range(1,32),o);this.children.timeRange=new i({className:"control-group",controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{modelAttribute:"cronType",model:this.model.cron,items:[{label:n("Run every hour").t(),value:"hourly"},{label:n("Run every day").t(),value:"daily"},{label:n("Run every week").t(),value:"weekly"},{label:n("Run every month").t(),value:"monthly"},{label:n("Run on Cron Schedule").t(),value:"custom"}],save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:e.extend(!0,{},this.options.popdownOptions)},label:this.options.lineOneLabel}),this.children.hourly=new s({additionalClassNames:"schedule_hourly",modelAttribute:"minute",model:this.model.cron,items:u,save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.weekly=new s({additionalClassNames:"schedule_weekly",modelAttribute:"dayOfWeek",model:this.model.cron,items:[{label:n("Monday").t(),value:"1"},{label:n("Tuesday").t(),value:"2"},{label:n("Wednesday").t(),value:"3"},{label:n("Thursday").t(),value:"4"},{label:n("Friday").t(),value:"5"},{label:n("Saturday").t(),value:"6"},{label:n("Sunday").t(),value:"0"}],save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.monthly=new s({menuClassName:"dropdown-menu-short",additionalClassNames:"schedule_monthly",modelAttribute:"dayOfMonth",model:this.model.cron,items:f,save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.daily=new s({menuClassName:"dropdown-menu-short",additionalClassNames:"schedule_daily",modelAttribute:"hour",model:this.model.cron,items:a,save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.scheduleOptions=new i({controls:[this.children.hourly,this.children.weekly,this.children.monthly,this.children.daily],label:this.options.lineTwoLabel}),this.children.cronSchedule=new i({controlType:"Text",controlClass:"controls-block",controlOptions:{modelAttribute:"cron_schedule",model:this.model.cron},label:n("Cron Expression").t(),help:n("e.g. 00 18 *** (every day at 6PM).").t()}),this.model.cron.on("change:cronType",this.timeRangeToggle,this),this.model.cron.on("change:cronType",function(){this.model.cron.setDefaults()},this)},timeRangeToggle:function(){var e=this.children.scheduleOptions.$el.find(".pre_label"),t=this.children.scheduleOptions.$el.find(".hour_post_label"),n=this.children.scheduleOptions.$el.find(".weekly_pre_label"),r=this.children.scheduleOptions.$el.find(".monthly_pre_label"),i=this.children.scheduleOptions.$el.find(".daily_pre_label"),s=this.$el.find(".custom_time");this.children.hourly.$el.hide(),this.children.daily.$el.hide(),this.children.weekly.$el.hide(),this.children.monthly.$el.hide(),e.hide(),t.hide(),n.hide(),r.hide(),i.hide(),s.css("display","none");switch(this.model.cron.get("cronType")){case"hourly":this.children.scheduleOptions.$el.show(),this.children.hourly.$el.css("display",""),e.css("display",""),t.css("display","");break;case"daily":this.children.scheduleOptions.$el.show(),this.children.daily.$el.css("display",""),e.css("display","");break;case"weekly":this.children.scheduleOptions.$el.show(),this.children.weekly.$el.css("display",""),this.children.daily.$el.css("display",""),n.css("display",""),i.css("display","");break;case"monthly":this.children.scheduleOptions.$el.show(),this.children.monthly.$el.css("display",""),this.children.daily.$el.css("display",""),r.css("display",""),i.css("display","");break;case"custom":s.css("display",""),this.children.scheduleOptions.$el.hide()}},render:function(){return this.$el.append(this.children.timeRange.render().el),this.$el.append(this.children.scheduleOptions.render().el),this.children.scheduleOptions.$el.find(".schedule_hourly").before('<span class="pre_label">'+n("At ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_hourly").after('<span class="hour_post_label">'+n(" minutes past the hour").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_weekly").before('<span class="weekly_pre_label">'+n("On ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_weekly .btn").width("75px"),this.children.scheduleOptions.$el.find(".schedule_monthly").before('<span class="monthly_pre_label">'+n("On day ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_monthly .btn").width("55px"),this.children.scheduleOptions.$el.find(".schedule_daily").before('<span class="daily_pre_label">'+n(" at ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_daily .btn").width("50px"),this.$el.append('<div class="custom_time"></div>'),this.$el.find(".custom_time").append(this.children.cronSchedule.render().el),this.timeRangeToggle(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/step1/Schedule",["underscore","module","views/Base","views/shared/Modal","views/shared/ScheduleSentence","views/shared/controls/ControlGroup"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,className:"form form-horizontal",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=this.model.inmem.entry.content.get("disabled")?e("Enable and Schedule Report").t():e("Schedule Report").t();this.children.name=new s({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Report").t()}),this.children.scheduleCheck=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"scheduled_and_enabled",model:this.model.inmem},label:t}),this.children.scheduleSentence=new i({model:{cron:this.model.cron},lineOneLabel:e("Schedule").t(),popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}),this.model.inmem.on("change:scheduled_and_enabled",this.isScheduledToggle,this),this.model.timeRange.on("applied",function(){this.model.inmem.entry.content.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")}),this.setLabel()},this),this.model.timeRange.on("change:earliest_epoch change:latest_epoch change:earliest change:latest",e.debounce(this.setLabel,0),this)},isScheduledToggle:function(){this.model.inmem.get("scheduled_and_enabled")?(this.$(".modal-btn-primary").html(e("Next").t()),this.children.scheduleSentence.$el.show(),this.$("div.timerange").show()):(this.children.scheduleSentence.$el.hide(),this.$("div.timerange").hide(),this.$(".modal-btn-primary").html(e("Save").t())),this.model.inmem.trigger("togglePrimaryButton")},setLabel:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.$el.append(this.children.name.render().el),this.model.inmem.entry.content.get("disabled")&&this.$el.append("<div>"+e("This report is currently disabled.").t()+"</div>"),this.$el.append(this.children.scheduleCheck.render().el),this.$el.append(this.children.scheduleSentence.render().el),this.$el.append('<div class="timerange" style="display: block;"><label class="control-label">'+e("Time Range").t()+"</label></div>"),this.$("div.timerange").append('<div class="controls"><a href="#" class="btn timerange-control"><span class="time-label"></span><span class="icon-triangle-right-small"></span></a></div>'),this.setLabel(),this.isScheduledToggle(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/step1/Master",["underscore","module","views/Base","views/shared/Modal","views/shared/delegates/ModalTimerangePicker","views/shared/reportcontrols/dialogs/schedule_dialog/step1/Schedule","views/shared/timerangepicker/dialog/Master","views/shared/FlashMessages"],function(e,t,n,r,i,s,o,u){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.flashMessage=new u({model:this.model.cron}),this.children.scheduleView=new s({model:{application:this.model.application,inmem:this.model.inmem,cron:this.model.cron,timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection}),this.children.timeRangePickerView=new o({model:{timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal,application:this.model.application},collection:this.collection,showPresetsRealTime:!1,showCustomRealTime:!1,showCustomDate:!1,showCustomDateTime:!1,showPresetsAllTime:!0,enableCustomAdvancedRealTime:!1}),this.model.timeRange.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.model.inmem.on("togglePrimaryButton",this.togglePrimaryButton,this)},events:{"click .modal-btn-primary":function(e){this.model.inmem.get("scheduled_and_enabled")?this.model.inmem.trigger("next"):(this.model.inmem.entry.content.set("is_scheduled",0),this.model.inmem.save({},{success:function(e,t){this.model.inmem.trigger("saveSuccessNotScheduled")}.bind(this)})),e.preventDefault()}},togglePrimaryButton:function(){this.model.inmem.get("scheduled_and_enabled")?this.$(".modal-btn-primary").html(e("Next").t()):this.$(".modal-btn-primary").html(e("Save").t())},render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Schedule").t()),this.$(r.BODY_SELECTOR).remove(),this.$(r.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper schedule-wrapper"><div class="'+r.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$scheduleWrapper=this.$(".schedule-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$modalParent=$(".schedule-modal").eq(0),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(this.children.scheduleView.render().el),this.$timeRangePickerWrapper.append(this.children.timeRangePickerView.render().el),this.timeRangeDelegate=new i({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$scheduleWrapper,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Save").t()+"</a>"),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+e("Back").t()+"</a>"),this.$(".btn.back").hide(),this.togglePrimaryButton(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/Step2",["underscore","module","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages","splunk.util","uri/route","util/console"],function(e,t,n,r,i,s,o,u,a){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.flashMessage=new s({model:this.model.inmem});var t="http://docs.splunk.com/";this.model.appLocal&&this.model.application?t=u.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email"):a.warn("The schedule dialog step 2 view needs the AppLocal and Application model passed to it"),this.children.sendEmailBox=new i({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"action.email",model:this.model.inmem.entry.content},label:e("Send Email").t(),help:o.sprintf(e("Email must be configured in System&nbsp;Settings > Alert&nbsp;Email&nbsp;Settings. %s").t(),' <a href="'+t+'" target="_blank">'+e("Learn More").t()+' <i class="icon-external"></i></a>')}),this.children.emailSubject=new i({controlType:"Text",controlOptions:{modelAttribute:"action.email.subject",model:this.model.inmem.entry.content,placeholder:e("Splunk Alert: $name$").t()},label:e("Subject").t()}),this.children.emailAddresses=new i({controlType:"Textarea",controlOptions:{modelAttribute:"action.email.to",model:this.model.inmem.entry.content},label:e("Email Addresses").t(),help:e("Comma separated list.").t()}),this.children.emailResultsFormat=new i({controlType:"SyntheticRadio",controlOptions:{modelAttribute:"ui_include_results",model:this.model.inmem,items:[{label:e("None").t(),value:"none"},{label:e("Inline").t(),value:"inline"},{label:e("CSV").t(),value:"csv"},{label:e("PDF").t(),value:"pdf"}],elastic:!0},label:e("Include results").t()}),this.children.runScriptBox=new i({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"action.script",model:this.model.inmem.entry.content},label:e("Run a Script").t()}),this.children.scriptFilename=new i({controlType:"Text",controlOptions:{modelAttribute:"action.script.filename",model:this.model.inmem.entry.content},label:e("Filename").t(),help:e("Located in $SPLUNK_HOME/bin/scripts").t()}),this.model.inmem.entry.content.on("change:action.email",this.toggleEmail,this),this.model.inmem.entry.content.on("change:action.script",this.toggleScript,this)},events:{"click .btn-primary":function(e){var t=[];this.model.inmem.entry.content.get("action.email")&&t.push("email"),this.model.inmem.entry.content.get("action.script")&&t.push("script"),this.model.inmem.entry.content.set("actions",t.join(", ")),this.model.inmem.trigger("saveSchedule"),e.preventDefault()},"click .back":function(e){this.model.inmem.entry.content.trigger("back"),e.preventDefault()}},toggleEmail:function(){this.model.inmem.entry.content.get("action.email")?(this.children.emailSubject.$el.show(),this.children.emailAddresses.$el.show(),this.children.emailResultsFormat.$el.show()):(this.children.emailSubject.$el.hide(),this.children.emailAddresses.$el.hide(),this.children.emailResultsFormat.$el.hide())},toggleScript:function(){this.model.inmem.entry.content.get("action.script")?this.children.scriptFilename.$el.show():this.children.scriptFilename.$el.hide()},render:function(){this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Schedule").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL_JUSTIFIED);if(this.model.user.isFree()){var t=u.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.license.features");this.children.sendEmailBox.disable(),this.children.runScriptBox.disable(),this.$(r.BODY_FORM_SELECTOR).append(this.compiledTemplate({_:e,splunkUtil:o,link:' <a href="'+t+'" target="_blank">'+e("Learn More").t()+' <i class="icon-external"></i></a>'}))}this.$(r.BODY_FORM_SELECTOR).append('<p class="control-heading">'+e("Enable Actions").t()+"</p>"),this.$(r.BODY_FORM_SELECTOR).append(this.children.sendEmailBox.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.emailSubject.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.emailAddresses.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.emailResultsFormat.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.runScriptBox.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.scriptFilename.render().el),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn back pull-left">'+e("Back").t()+"</a>"),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this.toggleEmail(),this.toggleScript()},template:'                <div class="alert alert-info">                    <i class="icon-alert"></i>                    <%= splunkUtil.sprintf(_("Scheduling Actions is an Enterprise-level feature. It is not available with Splunk Free. %s").t(), link) %>                </div>            '})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/Master",["underscore","backbone","models/Cron","models/TimeRange","collections/services/data/ui/Times","views/shared/Modal","module","views/shared/reportcontrols/dialogs/schedule_dialog/step1/Master","views/shared/reportcontrols/dialogs/schedule_dialog/Step2"],function(e,t,n,r,i,s,o,u,a){return s.extend({moduleId:o.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model={application:this.model.application,report:this.model.report,user:this.model.user,appLocal:this.model.appLocal,timeRange:new r,inmem:this.model.report.clone(),cron:n.createFromCronString(this.model.report.entry.content.get("cron_schedule")||"0 6 * * 1")},this.collection=new i,this.collectionDeferred=this.collection.fetch({data:{app:this.model.application.get("app"),owner:this.model.application.get("owner")}}),this.model.inmem.set({ui_include_results:"none",scheduled_and_enabled:!this.model.inmem.entry.content.get("disabled")&&this.model.inmem.entry.content.get("is_scheduled")}),this.transposeToUI(),this.children.step1=new u({model:{state:this.model.inmem.entry.content,application:this.model.application,inmem:this.model.inmem,cron:this.model.cron,timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection}),this.children.step2=new a({model:{inmem:this.model.inmem,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal}}),this.model.inmem.on("next",function(){this.model.cron.validate()},this),this.model.inmem.entry.content.on("back",function(){this.children.step2.$el.hide(),this.children.step1.$el.show()},this),this.model.cron.on("validated",function(e,t,n){e&&(this.children.step1.$el.hide(),this.children.step2.$el.show())},this),this.model.inmem.on("saveSuccessNotScheduled",function(){this.model.report.entry.content.set("is_scheduled",0),this.hide()},this),this.model.inmem.on("saveSchedule",function(){this.trasposeFromUI(),this.model.inmem.entry.content.set("cron_schedule",this.model.cron.getCronString()),this.model.inmem.save({},{success:function(e,t){this.model.report.fetch(),this.hide()}.bind(this)})},this)},transposeToUI:function(){var e="none";this.model.inmem.entry.content.get("action.email.sendresults")&&(this.model.inmem.entry.content.get("action.email.inline")?e="inline":e=this.model.inmem.entry.content.get("action.email.format")),this.model.inmem.set("ui_include_results",e)},trasposeFromUI:function(){var e=this.model.inmem.get("ui_include_results");e==="none"?this.model.inmem.entry.content.set("action.email.sendresults",0):this.model.inmem.entry.content.set({"action.email.sendresults":1,"action.email.format":e==="inline"?"":e,"action.email.sendpdf":e==="pdf"?1:0,"action.email.inline":e==="inline"?1:0}),this.model.inmem.get("scheduled_and_enabled")&&this.model.inmem.entry.content.set({is_scheduled:1,disabled:0})},render:function(){this.$el.addClass("schedule-modal");var e=this.model.timeRange.save({earliest:this.model.inmem.entry.content.get("dispatch.earliest_time"),latest:this.model.inmem.entry.content.get("dispatch.latest_time")});$.when(e,this.collectionDeferred).then(function(){this.$el.append(this.children.step1.render().el),this.$el.append(this.children.step2.render().el),this.children.step2.$el.hide()}.bind(this))}})}),define("views/shared/reportcontrols/details/EditSchedule",["underscore","backbone","module","views/Base","views/shared/reportcontrols/dialogs/schedule_dialog/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-schedule":function(e){this.children.scheduleDialog=new i({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal},onHiddenRemove:!0}),$("body").append(this.children.scheduleDialog.render().el),this.children.scheduleDialog.show(),e.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-schedule" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/reportcontrols/details/Acceleration",["underscore","module","views/Base","splunk.util"],function(e,t,n,r){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.content.on("change:auto_summarize change:auto_summarize.dispatch.earliest_time",t,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model,_:e,splunkUtil:r})),this},convertSummarizeTime:function(t){switch(t){case"-1d@h":return e("1 Day").t();case"-7d@d":return e("1 Week").t();case"-1mon@d":return e("1 Month").t();case"-3mon@d":return e("3 Months").t();case"-1y@d":return e("1 Year").t();case"0":return e("All Time").t();default:return e("Custom").t()}},template:'                <% if (model.entry.content.get("auto_summarize")) { %>                    <%- splunkUtil.sprintf(_("Enabled. Summary Range: %s.").t(), this.convertSummarizeTime(model.entry.content.get("auto_summarize.dispatch.earliest_time"))) %>                <% } else { %>                    <%- _("Disabled.").t() %>                <% } %>            '})}),define("views/shared/reportcontrols/dialogs/AccelerationDialog",["underscore","backbone","module","models/services/search/IntentionsParser","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages","splunk.util"],function(e,t,n,r,i,s,o,u){return i.extend({moduleId:n.id,initialize:function(t){i.prototype.initialize.apply(this,arguments),this.model={searchJob:this.model.searchJob,report:this.model.report,inmem:this.model.report.clone(),application:this.model.application},this.model.searchJob||(this.model.intentionsParser=new r,this.intentionsParserDeferred=this.model.intentionsParser.fetch({data:{q:this.model.report.entry.content.get("search"),timeline:!1,app:this.model.application.get("app"),owner:this.model.application.get("owner")}})),this.children.flashMessage=new o({model:this.model.inmem}),this.children.name=new s({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Report").t()}),this.children.acceleration=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"auto_summarize",model:this.model.inmem.entry.content},label:u.sprintf(e("Accelerate %s").t(),this.model.report.isAlert()?e("Alert").t():e("Report").t()),help:e("Acceleration may increase storage and processing costs.").t()}),this.children.summary_range=new s({controlType:"SyntheticSelect",controlOptions:{modelAttribute:"auto_summarize.dispatch.earliest_time",model:this.model.inmem.entry.content,items:[{label:e("1 Day").t(),value:"-1d@h"},{label:e("7 Days").t(),value:"-7d@d"},{label:e("1 Month").t(),value:"-1mon@d"},{label:e("3 Months").t(),value:"-3mon@d"},{label:e("1 Year").t(),value:"-1y@d"},{label:e("All Time").t(),value:"0"}],save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},label:e("Summary Range").t(),tooltip:e("Sets the range of time (relative to now) for which data is accelerated. Example: 1 Month accelerates the last 30 days of data in your reports.").t()}),this.model.inmem.entry.content.on("change:auto_summarize",function(){this.model.inmem.entry.content.get("auto_summarize")?(this.children.summary_range.$el.show(),this.model.inmem.entry.content.get("auto_summarize.dispatch.earliest_time")===""&&this.model.inmem.entry.content.set("auto_summarize.dispatch.earliest_time","-1d@h")):this.children.summary_range.$el.hide()},this),this.on("hidden",function(){this.model.inmem.get("updated")>this.model.report.get("updated")&&this.model.report.entry.content.set({auto_summarize:this.model.inmem.entry.content.get("auto_summarize"),"auto_summarize.dispatch.earliest_time":this.model.inmem.entry.content.get("auto_summarize.dispatch.earliest_time")})},this)},events:$.extend({},i.prototype.events,{"click .save.modal-btn-primary":function(e){this.model.inmem.save({},{success:function(e,t){this.model.report.fetch(),this.remove()}.bind(this)}),e.preventDefault()}}),render:function(){return this.$el.html(i.TEMPLATE),this.$(i.HEADER_TITLE_SELECTOR).html(e("Edit Acceleration").t()),this.$(i.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(i.BODY_SELECTOR).append(i.FORM_HORIZONTAL),$.when(this.intentionsParserDeferred).then(function(){var t=this.model.searchJob&&this.model.searchJob.canSummarize()||this.model.intentionsParser&&this.model.intentionsParser.get("canSummarize");t?(this.model.inmem.setAccelerationWarning(t),this.$(i.BODY_FORM_SELECTOR).append(this.children.name.render().el),this.$(i.BODY_FORM_SELECTOR).append(this.children.acceleration.render().el),this.$(i.BODY_FORM_SELECTOR).append(this.children.summary_range.render().el),this.model.inmem.entry.content.get("auto_summarize")?this.children.summary_range.$el.show():this.children.summary_range.$el.hide(),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_CANCEL),this.$(i.FOOTER_SELECTOR).append('<a href="#" class="save btn btn-primary modal-btn-primary pull-right">'+e("Save").t()+"</a>")):(this.$(i.BODY_FORM_SELECTOR).append("<div>"+e("This report cannot be accelerated.").t()+"</div>"),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_DONE))}.bind(this)),this}})}),define("views/shared/reportcontrols/details/EditAcceleration",["underscore","backbone","module","views/Base","views/shared/reportcontrols/dialogs/AccelerationDialog"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-acceleration":function(e){this.children.accelerationDialog=new i({model:{report:this.model.report,searchJob:this.model.searchJob,application:this.model.application},onHiddenRemove:!0}),$("body").append(this.children.accelerationDialog.render().el),this.children.accelerationDialog.show(),e.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-acceleration" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/documentcontrols/details/Permissions",["underscore","module","views/Base","util/splunkd_utils","splunk.util"],function(e,t,n,r,i){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.acl.on("change:sharing change:owner",t,this)},render:function(){var e=this.model.entry.acl.get("sharing"),t=this.model.entry.acl.get("owner"),n=r.getPermissionLabel(e,t);return this.$el.html(this.compiledTemplate({permissionString:n})),this},template:"               <%- permissionString %>            "})}),define("views/shared/documentcontrols/dialogs/permissions_dialog/ACL",["underscore","jquery","backbone","module","views/Base","views/shared/controls/SyntheticCheckboxControl"],function(e,t,n,r,i,s){return i.extend({moduleId:r.id,className:"push-margins",initialize:function(){i.prototype.initialize.apply(this,arguments),this.children.read=new i,this.children.write=new i,this.model.perms.on("change:Everyone.read",function(){this.toggleEveryone("read")},this),this.model.perms.on("change:Everyone.write",function(){this.toggleEveryone("write")},this)},appendRow:function(e,t){this.$("tbody").append('<tr class="'+e+'">                    <td class="role-name">'+e+'</td>                    <td class="perms-read '+e+'-checkbox"></td>                    <td class="perms-write '+e+'-checkbox"></td>                </tr>'),this.children.readCheckbox=new s({modelAttribute:e+".read",model:this.model.perms,checkboxClassName:t+" "+e+" read btn"}),this.children.writeCheckbox=new s({modelAttribute:e+".write",model:this.model.perms,checkboxClassName:t+" "+e+" write btn"}),this.$("td.perms-read."+e+"-checkbox").append(this.children.readCheckbox.render().el),this.$("td.perms-write."+e+"-checkbox").append(this.children.writeCheckbox.render().el),this.children.read.children[e]=this.children.readCheckbox,this.children.write.children[e]=this.children.writeCheckbox},toggleEveryone:function(t){var n=this.model.perms.get("Everyone."+t),r=this.children[t];e.each(r.children,function(e,t){t!=="Everyone"&&(n?e.disable():e.enable())})},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this.appendRow(e("Everyone").t()),this.collection.each(function(e){this.appendRow(e.entry.get("name"),"role")}.bind(this)),this.toggleEveryone("read"),this.toggleEveryone("write"),this},template:'            <table class="table table-striped table-condensed table-scroll table-border-row">                <thead>                    <tr>                        <td></td>                        <th class="perms-read"><%- _("Read").t() %></th>                        <th class="perms-write"><%- _("Write").t() %></th>                    </tr>                </thead>                <tbody>                </tbody>            </table>        '})}),define("views/shared/documentcontrols/dialogs/permissions_dialog/Master",["jquery","underscore","backbone","module","models/ACLReadOnly","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/documentcontrols/dialogs/permissions_dialog/ACL","views/shared/FlashMessages","util/splunkd_utils"],function(e,t,n,r,i,s,o,u,a,f){return s.extend({moduleId:r.id,initialize:function(r){s.prototype.initialize.apply(this,arguments),this.model.perms=new n.Model,this.model.inmem=new i(e.extend(!0,{},this.model.document.entry.acl.toJSON()));var l={nameLabel:t("Name").t(),nameKey:"name"};t.defaults(this.options,l),this.translateToPermsModel(),this.children.flashMessage=new a({model:{inmem:this.model.inmem,report:this.model.document,reportAcl:this.model.document.acl}}),this.children.name=new o({controlType:"Label",controlOptions:{modelAttribute:this.options.nameKey,model:this.model.nameModel},label:this.options.nameLabel}),this.children.owner=new o({controlType:"Label",controlOptions:{modelAttribute:"owner",model:this.model.inmem},label:t("Owner").t()}),this.children.app=new o({controlType:"Label",controlOptions:{modelAttribute:"app",model:this.model.inmem},label:t("App").t()}),this.children.display_for=new o({controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{modelAttribute:"sharing",model:this.model.inmem,items:[{label:t("Owner").t(),value:f.USER,className:"user"},{label:t("App").t(),value:f.APP,className:"app"},{label:t("All Apps").t(),value:f.GLOBAL,className:"global"}],save:!1},label:t("Display For").t()}),this.children.acl=new u({model:{perms:this.model.perms},collection:this.collection}),this.model.inmem.on("change:sharing",function(){this.model.inmem.get("sharing")===f.USER?this.children.acl.$el.hide():this.children.acl.$el.show()},this)},events:e.extend({},s.prototype.events,{"click .btn-primary":function(e){this.translateFromPermsModel();var t=this.model.inmem.toDataPayload();this.model.document.acl.save({},{data:t,success:function(e,n){this.hide(),this.model.document.fetch({url:f.fullpath(this.model.document.url+"/"+encodeURIComponent(this.model.document.entry.get("name")),{sharing:t.sharing,app:this.model.inmem.get("app"),owner:t.owner}),success:function(){this.model.document.trigger("updateCollection")}.bind(this)})}.bind(this)}),e.preventDefault()}}),translateToPermsModel:function(){var e=this.model.inmem.get("perms")||{};this.model.perms.set("Everyone.read",t.indexOf(e.read,"*")!=-1),this.model.perms.set("Everyone.write",t.indexOf(e.write,"*")!=-1),this.collection.each(function(n){var r=n.entry.get("name");this.model.perms.set(r+".read",t.indexOf(e.read,r)!=-1),this.model.perms.set(r+".write",t.indexOf(e.write,r)!=-1)}.bind(this))},translateFromPermsModel:function(){var e={read:[],write:[]};this.model.perms.get("Everyone.read")&&e.read.push("*"),this.model.perms.get("Everyone.write")&&e.write.push("*"),this.collection.each(function(t){var n=t.entry.get("name");this.model.perms.get(n+".read")&&e.read.push(n),this.model.perms.get(n+".write")&&e.write.push(n)}.bind(this)),this.model.inmem.set("perms",e)},setView:function(){this.model.inmem.get("can_share_user")||this.children.display_for.$(".user").attr("disabled",!0),this.model.inmem.get("can_share_app")||this.children.display_for.$(".app").attr("disabled",!0),this.model.inmem.get("can_share_global")||this.children.display_for.$(".global").attr("disabled",!0),this.model.inmem.get("modifiable")||this.children.display_for.$(".btn").attr("disabled",!0),this.model.inmem.get("sharing")==="user"?this.children.acl.$el.hide():this.children.acl.$el.show()},render:function(){return this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(t("Edit Permissions").t()),this.$(s.BODY_SELECTOR).addClass("modal-body-scrolling"),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.name.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.owner.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.app.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.display_for.render().el),this.model.user.isFree()||this.$(s.BODY_FORM_SELECTOR).append(this.children.acl.render().el),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE),this.setView(),this}})}),define("views/shared/reportcontrols/details/EditPermissions",["underscore","backbone","module","views/Base","views/shared/documentcontrols/dialogs/permissions_dialog/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-permissions":function(t){this.children.permissionsDialog=new i({model:{document:this.model.report,nameModel:this.model.report.entry,user:this.model.user},collection:this.collection,onHiddenRemove:!0,nameLabel:e("Report").t()}),$("body").append(this.children.permissionsDialog.render().el),this.children.permissionsDialog.show(),t.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-permissions" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/reportcontrols/details/Master",["underscore","jquery","views/Base","module","views/shared/reportcontrols/details/History","views/shared/reportcontrols/details/Creator","views/shared/documentcontrols/details/App","views/shared/reportcontrols/details/Schedule","views/shared/reportcontrols/details/EditSchedule","views/shared/reportcontrols/details/Acceleration","views/shared/reportcontrols/details/EditAcceleration","views/shared/documentcontrols/details/Permissions","views/shared/reportcontrols/details/EditPermissions","bootstrap.modal"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return n.extend({moduleId:r.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.creatorView=new s({model:{report:this.model.report,application:this.model.application}}),this.children.appView=new o({model:this.model.report}),this.children.scheduleView=new u({model:this.model.report}),this.children.editScheduleView=new a({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal}}),this.children.accelerationView=new f({model:this.model.report}),this.children.editAccelerationView=new l({model:{report:this.model.report,searchJob:this.model.searchJob,application:this.model.application}}),this.children.permissionsView=new c({model:this.model.report}),this.children.editPermissionsView=new h({model:{report:this.model.report,user:this.model.user},collection:this.collection}),this.model.searchJob&&this.model.searchJob.on("prepared",function(){this.$("a.edit-acceleration").css("display","")},this)},render:function(){var t=this.model.report.entry.acl.get("can_write")&&(!this.model.report.entry.content.get("is_scheduled")||!!this.model.user.canScheduleSearch());return this.$el.html(this.compiledTemplate({_:e})),this.$("dd.creator").append(this.children.creatorView.render().el),this.$("dd.app").append(this.children.appView.render().el),this.$("dd.schedule").append(this.children.scheduleView.render().el),this.$("dd.acceleration").append(this.children.accelerationView.render().el),this.$("dd.permissions").append(this.children.permissionsView.render().el),t&&(this.model.user.canScheduleSearch()&&(this.model.report.isRealTime()||this.$("dd.schedule").append(this.children.editScheduleView.render().el),this.$("dd.acceleration").append(this.children.editAccelerationView.render().el)),this.model.report.entry.acl.get("can_change_perms")&&this.$("dd.permissions").append(this.children.editPermissionsView.render().el)),this.model.searchJob&&this.model.searchJob.isPreparing()&&this.$("a.edit-acceleration").css("display","none"),this.model.report.isPivotReport()&&(this.$("dt.acceleration").remove(),this.$("dd.acceleration").remove()),this},template:'            <dl class="list-dotted">                <!--TODO when these attributes exist-->                <!--<dt class="history"><%- _("History").t() %></dt>                    <dd class="history"></dd>-->                <dt class="creator"><%- _("Creator").t() %></dt>                    <dd class="creator"></dd>                <dt class="app"><%- _("App").t() %></dt>                    <dd class="app"></dd>                <dt class="schedule"><%- _("Schedule").t() %></dt>                    <dd class="schedule"></dd>                <dt class="acceleration"><%- _("Acceleration").t() %></dt>                    <dd class="acceleration"></dd>                <dt class="permissions"><%- _("Permissions").t() %></dt>                    <dd class="permissions"></dd>            </dl>        '})}),define("views/dashboards/panelcontrols/titledialog/Modal",["underscore","jquery","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages"],function(e,t,n,r,i,s,o){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments);var t="display.general.title";this.model.workingReport=new n.Model,this.model.workingReport.set(t,this.model.report.entry.content.get(t,{tokens:!0})),this.children.flashMessages=new o({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.children.panelTitleControlGroup=new i({label:e("Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:t,placeholder:"optional"}}),this.listenTo(this.model.report,"successfulSave",this.hide,this)},events:t.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){var t=this.model.workingReport.get("display.general.title");e.preventDefault(),this.model.report.trigger("saveTitle",t)},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(e("Edit Title").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.panelTitleControlGroup.render().el),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("views/dashboards/PanelTimeRangePicker",["require","exports","module","underscore","views/Base","views/shared/controls/ControlGroup","util/console","uri/route","util/time_utils","splunkjs/mvc/tokenutils","bootstrap.tooltip"],function(e,t,n){var r=e("underscore"),i=e("views/Base"),s=e("views/shared/controls/ControlGroup"),o=e("util/console"),u=e("uri/route"),a=e("util/time_utils"),f=e("splunkjs/mvc/tokenutils");return e("bootstrap.tooltip"),i.extend({moduleId:t.id,initialize:function(){i.prototype.initialize.apply(this,arguments),this.model.timeRange.on("applied",function(){this.updateReportTime(),this.updateTime()},this);var e=f.hasToken(this.model.report.get("dispatch.earliest_time")),t=e?"dashboard":"search";this.model.timeRange.set({useTimeFrom:t}),this.model.state.get("default_timerange")?this.children.timeScope=new s({label:r("Time Range Scope").t(),controlType:"SyntheticRadio",controlOptions:{className:"btn-group btn-group-2 time-range-scope-select",items:[{value:"dashboard",label:r("Dashboard").t(),tooltip:r("Use the time range set by the dashboard time range picker.").t()},{value:"search",label:r("Search").t(),tooltip:r("Override the dashboard time range picker by setting a time range for this Search.").t()}],model:this.model.timeRange,modelAttribute:"useTimeFrom",elastic:!0}}):this.model.timeRange.set("useTimeFrom","search"),this.listenTo(this.model.timeRange,"change:useTimeFrom",this.updateTokens,this)},updateReportTime:function(){this.model.report.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")},{tokens:!0})},updateTokens:function(){this.toggleTimeRangePicker(),this.updateTime()},toggleTimeRangePicker:function(){this.model.timeRange.get("useTimeFrom")=="dashboard"?this.$(".timerange").hide():this.$(".timerange").show()},updateTime:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.children.timeScope&&this.children.timeScope.render().appendTo(this.el),this.$el.append('<div class="timerange" style="display: block;"><label class="control-label">'+r("Time Range").t()+"</label></div>"),this.$("div.timerange").append('<div class="controls"><a href="#" class="btn timerange-control"><span class="time-label"></span><span class="icon-triangle-right-small"></span></a></div>'),this.toggleTimeRangePicker(),this.updateTime(),this}})}),define("views/dashboards/panelcontrols/querydialog/Modal",["underscore","jquery","backbone","module","views/shared/controls/ControlGroup","views/shared/delegates/ModalTimerangePicker","views/shared/timerangepicker/dialog/Master","views/shared/Modal","models/TimeRange","collections/services/data/ui/Times","splunk.util","splunkjs/mvc/utils","views/Base","uri/route","splunkjs/mvc/simplexml/controller","util/time_utils","bootstrap.tooltip","util/console","splunkjs/mvc","views/shared/FlashMessages","views/dashboards/PanelTimeRangePicker","splunkjs/mvc/tokenawaremodel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){function S(e,t){return t?[e.replace(/[\|\s]$/g,""),t.replace(/^[\|\s]/g,"")].join(" | "):e}return u.extend({moduleId:r.id,className:"modal edit-search-string",initialize:function(){u.prototype.initialize.apply(this,arguments),this.model.workingReport=new E(e.pick(this.model.report.entry.content.toJSON({tokens:!0}),["search","dispatch.earliest_time","dispatch.latest_time"]),{applyTokensByDefault:!0,retrieveTokensByDefault:!0}),this.children.title=new i({label:e("Title").t(),controlType:"Label",controlClass:"controls-block",controlOptions:{model:this.model.report.entry.content,modelAttribute:"display.general.title"}}),this.children.searchStringInput=new i({label:e("Search String").t(),controlType:"Textarea",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"search"}}),this.model.report.isPivotReport()?this.children.searchStringInput.options.help='<a href="#" class="run-pivot">'+e("Run Pivot").t()+' <i class="icon-external"></i></a>':this.children.searchStringInput.options.help='<a href="#" class="run-search">'+e("Run Search").t()+' <i class="icon-external"></i></a>',this.collection=this.collection||{},this.collection.times=new f,this.collection.times.fetch({data:{app:this.model.application.get("app"),owner:this.model.application.get("owner")}}),this.model.timeRange=new a,this.children.timeRangePickerView=new o({model:{state:this.model.workingReport,timeRange:this.model.timeRange,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection.times}),this.model.timeRange.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.children.panelTimeRangePicker=new w({model:{timeRange:this.model.timeRange,report:this.model.workingReport,state:this.model.state},collection:this.collection.times}),this.children.flashMessages=new b({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.listenTo(this.model.report,"successfulSave",this.hide,this)},events:t.extend({},u.prototype.events,{"click .modal-btn-primary":function(e){e.preventDefault(),this.model.timeRange.get("useTimeFrom")=="dashboard"?this.model.workingReport.set({"dispatch.earliest_time":"$earliest$","dispatch.latest_time":"$latest$"},{tokens:!0}):this.model.workingReport.set({"dispatch.earliest_time":this.model.timeRange.get("earliest")||"0","dispatch.latest_time":this.model.timeRange.get("latest")||"now"});var t=this.model.workingReport.toJSON();g.log("Applying attributes to report model: %o",t),this.model.report.trigger("updateSearchString",t)},"click a.run-search":function(e){e.preventDefault();var t=this.model.workingReport.get("search",{tokens:!1}),n=this.model.report.entry.content;if(n.get("display.general.search.type")==="postprocess"){var r=y.Components.get(n.get("display.general.managerid")).parent.query.resolve();t=S(r,t)}if(!t)return;var i={q:t};this.model.workingReport.has("dispatch.earliest_time")&&(i.earliest=this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}||"0"),i.latest=this.model.workingReport.get("dispatch.latest_time",{tokens:!1})||"now");var s=c.getPageInfo(),o=p.search(s.root,s.locale,s.app,{data:i});c.redirect(o,!0)},"click a.run-pivot":function(e){e.preventDefault();var t=this.model.workingReport.get("search",{tokens:!1}),n={q:t};if(!t)return;this.model.workingReport.has("dispatch.earliest_time")&&(n.earliest=this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}),n.latest=this.model.workingReport.get("dispatch.latest_time",{tokens:!1}));var r=c.getPageInfo(),i=p.pivot(r.root,r.locale,r.app,{data:n});c.redirect(i,!0)}}),handleSubmitButtonState:function(e){this.$(u.FOOTER_SELECTOR).find(".btn-primary")[e.get("elementCreateType")==="pivot"?"addClass":"removeClass"]("disabled")},render:function(){this.$el.html(u.TEMPLATE),this.$(u.HEADER_TITLE_SELECTOR).html(e("Edit Search").t()),this.$(u.BODY_SELECTOR).remove(),this.$(u.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper query-dialog-wrapper"><div class="'+u.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$editSearchContent=this.$(".query-dialog-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$modalParent=this.$el,this.$(u.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(u.BODY_SELECTOR).append(u.FORM_HORIZONTAL_JUSTIFIED),this.children.title.render().appendTo(this.$(u.BODY_FORM_SELECTOR)),this.children.searchStringInput.render().appendTo(this.$(u.BODY_FORM_SELECTOR));var t=this.model.timeRange.save({earliest:this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}||"0"),latest:this.model.workingReport.get("dispatch.latest_time",{tokens:!1}||"now")});return t.done(e.bind(function(){this.$(u.BODY_FORM_SELECTOR).append(this.children.panelTimeRangePicker.render().el)},this)),this.$timeRangePickerWrapper.append(this.children.timeRangePickerView.render().el),this.timeRangeDelegate=new s({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$editSearchContent,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(u.FOOTER_SELECTOR).append(u.BUTTON_CANCEL),this.$(u.FOOTER_SELECTOR).append(u.BUTTON_SAVE),this.$(u.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+e("Back").t()+"</a>"),this.$(".btn.back").hide(),this}})}),define("views/dashboards/panelcontrols/ReportDialog",["jquery","underscore","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages","splunk.util","uri/route","collections/Reports","splunkjs/mvc/utils","splunk.config"],function(e,t,n,r,i,s,o,u,a,f,l,c){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.workingReport=new n.Model,this.model.workingReport.set({title:""}),this.model.workingReport.set("id",this.model.report.get("id")),this.children.flashMessage=new o({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.listenTo(this.model.report,"successfulManagerChange",this.hide,this),this.controller=this.options.controller,this.controller.reportsCollection||this.controller.fetchCollection(),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.ready=!0;var e=this.controller.reportsCollection.map(function(e){return{label:e.entry.get("name"),value:e.id}}),n=a.reports(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"));this.controller.reportsCollection.length===this.controller.reportsCollection.REPORTS_LIMIT?this.children.reportsControlGroup=new i({label:t("Select Report").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"id",items:e,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},help:t("This does not contain all reports. Add a report that is not listed from ").t()+u.sprintf("<a href=%s>%s</a>.",n,t("Reports").t())}):this.children.reportsControlGroup=new i({label:t("Select Report").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"id",items:e,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}})},this)),this.children.panelTitleControlGroup=new i({label:t("Panel Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"title",placeholder:"optional"}})},events:e.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){e.preventDefault(),this.model.report.trigger("updateReportID",this.model.workingReport.get("id"),this.model.workingReport.get("title"))},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(t("Select a New Report").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(s.LOADING_HORIZONTAL),this.$(s.LOADING_SELECTOR).html(t("Loading...").t()),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.$(s.LOADING_SELECTOR).remove(),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportsControlGroup.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.panelTitleControlGroup.render().el)},this)),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("views/dashboards/panelcontrols/CreateReportDialog",["jquery","underscore","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages"],function(e,t,n,r,i,s,o){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.workingReport=new n.Model({name:this.model.report.entry.content.get("display.general.title")}),this.children.flashMessagesReport=new o({model:this.model.report}),this.children.flashMessagesDashboard=new o({model:this.model.dashboard}),this.on("hide",this.model.report.error.clear,this.model.report.error),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.children.reportNameControlGroup=new i({label:t("Report Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"name"}}),this.children.reportDescriptionControlGroup=new i({label:t("Description").t(),controlType:"Textarea",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"description",placeholder:"optional"}}),this.listenTo(this.model.report,"successfulReportSave",this.hide,this)},events:e.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){e.preventDefault(),this.model.report.trigger("saveAsReport",this.model.workingReport.get("name"),this.model.workingReport.get("description"))},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(t("Convert to Report").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessagesDashboard.render().el),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessagesReport.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportNameControlGroup.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportDescriptionControlGroup.render().el),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("views/ValidatingView",["jquery","backbone","underscore","views/Base","util/general_utils"],function(e,t,n,r,i){return r.extend({modelToControlGroupMap:{},dispose:function(){var e=r.prototype.dispose.call(this,arguments);return this.tearDownValidation(),e},setupValidation:function(e,r){if(n.isUndefined(e))throw"The model or collection you passed into views/Base.setupValidation is undefined";e instanceof t.Model?this._setupModelValidationListener(e):e instanceof t.Collection&&(e.each(function(e){this._setupModelValidationListener(e)}),e.on("add",function(e){this._setupModelValidationListener(e)},this),e.on("remove",function(e){e.off("validated",this._modelValidatedHandler,this)},this)),this.__flashMessagesHelper__=r,this.__flashMessagesHelper__.register(this)},tearDownValidation:function(){this.__flashMessagesHelper__&&this.__flashMessagesHelper__.unregister(this)},_setupModelValidationListener:function(e){e.on("validated",this._modelValidatedHandler,this)},_modelValidatedHandler:function(e,t,r){var s=[];if(this.modelToControlGroupMap){var o=i.invert(this.modelToControlGroupMap);o=n.reduce(n.keys(o||{}),function(e,t){return e[t]=void 0,e},{}),n(r).each(function(e,t){r[t]={message:e,label:""}}),n(r).each(function(e,t){var r=this.modelToControlGroupMap[t],i=e.message,s,u="";n.isUndefined(r)?s=i.replace(/\{(label)\}/g,t):(this.children[r].options.label&&(u=this.children[r].options.label),s=i.replace(/\{(label)\}/g,u||t),o[r]=s),e.message=s,e.label=u},this),n(o).each(function(e,t){n.isUndefined(e)?this.children[t].error(!1,""):this.children[t].error(!0,e)},this)}else n(r).each(function(e,t){e.message=e.message.replace(/\{(label)\}/g,t)});this.trigger("validated",e,t,r,this)}})}),define("views/shared/dialogs/DialogBase",["jquery","underscore","backbone","views/ValidatingView","module","bootstrap.transition","bootstrap.modal"],function(e,t,n,r,i){var s=13,o='input[type="text"], input[type="password"], textarea';return r.extend({moduleId:i.id,className:"modal fade",attributes:{tabIndex:-1},settings:undefined,bodyClassName:"modal-body-scrolling",initialize:function(e){r.prototype.initialize.call(this,e),e=e||{},this.$el.modal({show:!1,keyboard:!0}),t.isUndefined(e.bodyClassName)||(this.bodyClassName=e.bodyClassName),this.settings=new n.Model,this.settings.set("footerTemplate",this._footerTemplate),this.settings.set("headerTemplate",this._headerTemplate),this.settings.on("change:primaryButtonLabel change:cancelButtonLabel change:titleLabel",this.debouncedRender,this),this.$el.on("click.dialog",".btn-dialog-primary",t.bind(function(e){e.preventDefault(),this.primaryButtonClicked()},this)),this.$el.on("click.dialog",".btn-dialog-cancel",t.bind(function(e){e.preventDefault(),this.cancelButtonClicked()},this)),this.$el.on("click.dialog",".btn-dialog-close",t.bind(function(e){e.preventDefault(),this.closeButtonClicked()},this)),this.$el.on("keypress",t.bind(function(e){e.which===s&&this.submitKeyPressed(e)},this)),this.$el.on("shown",t.bind(function(e){if(e.target!==e.currentTarget)return;this.dialogShown()},this)),this.$el.on("hide",t.bind(function(e){if(e.target!==e.currentTarget)return;this.cleanup()},this)),this.$el.on("hidden",t.bind(function(e){if(e.target!==e.currentTarget)return;this.trigger("hidden")},this))},render:function(){this.$(".modal-header").detach(),this.$(".modal-body").detach(),this.$(".modal-footer").detach();var e=this.compiledTemplate({bodyClassName:this.bodyClassName});return this.$el.html(e),this.renderHeader(this.$(".modal-header")),this.renderBody(this.$(".modal-body")),this.renderFooter(this.$(".modal-footer")),this},hide:function(){this.$el.modal("hide")},show:function(){this.$el.modal("show")},primaryButtonClicked:function(){this.trigger("click:primaryButton",this)},cancelButtonClicked:function(){this.trigger("click:cancelButton",this)},closeButtonClicked:function(){this.trigger("click:closeButton",this)},submitKeyPressed:function(t){var n=e(t.target);n.is(o)&&n.blur(),this.primaryButtonClicked()},dialogShown:function(){this.trigger("show"),t.debounce(function(){this.$("input:text:enabled:visible:first").focus()}.bind(this),0)();return},cleanup:function(){this.trigger("hide");return},renderBody:function(e){},renderHeader:function(e){e.html(this.settings.get("headerTemplate")),e.find(".text-dialog-title").html(this.settings.get("titleLabel"))},renderFooter:function(e){e.html(this.settings.get("footerTemplate"));var t=e.find(".btn-dialog-primary.label_from_data");this.settings.has("primaryButtonLabel")?(t.html(this.settings.get("primaryButtonLabel")),t.show()):(t.html(""),t.hide());var n=e.find(".btn-dialog-cancel.label_from_data");this.settings.has("cancelButtonLabel")?(n.html(this.settings.get("cancelButtonLabel")),n.show()):(n.html(""),n.hide())},template:'                <div class="modal-header"></div>                <div class="modal-body <%- bodyClassName %>"></div>                <div class="modal-footer"></div>            ',_footerTemplate:'                <a href="#" class="btn btn-dialog-cancel label_from_data pull-left" data-dismiss="modal"></a>                <a href="#" class="btn btn-primary btn-dialog-primary label_from_data pull-right"></a>            ',_headerTemplate:'                <button type="button" class="close btn-dialog-close" data-dismiss="modal">x</button>                <h3 class="text-dialog-title"></h3>            '})}),define("views/shared/dialogs/TextDialog",["jquery","underscore","views/shared/dialogs/DialogBase","module","views/shared/FlashMessages"],function(e,t,n,r,i){return n.extend({moduleId:r.id,_text:"",initialize:function(e){n.prototype.initialize.call(this,e),this.settings.set("primaryButtonLabel",t("Ok").t()),this.settings.set("cancelButtonLabel",t("Cancel").t()),this.options.flashModel&&(this.children.flashMessages=new i({model:this.options.flashModel}),this.on("hide",this.options.flashModel.error.clear,this.options.flashModel.error)),this.on("hidden",this.remove,this),this.doDefault=!0},primaryButtonClicked:function(){n.prototype.primaryButtonClicked.call(this),this.doDefault&&this.hide()},setText:function(e){this._text=e,this.debouncedRender()},closeDialog:function(){this.hide(),this.remove()},preventDefault:function(){this.doDefault=!1},renderBody:function(e){e.html(this.bodyTemplate),e.find(".text-dialog-placeholder").html(this._text),this.children.flashMessages&&e.find(".text-dialog-placeholder").prepend(this.children.flashMessages.render().el)},bodyTemplate:'                <span class="text-dialog-placeholder"></span>            '})}),define("views/dashboards/panelcontrols/Master",["underscore","views/Base","models/Base","jquery","module","views/shared/controls/SyntheticSelectControl","views/shared/delegates/Popdown","views/shared/reportcontrols/details/Master","collections/services/authorization/Roles","models/Application","views/dashboards/panelcontrols/titledialog/Modal","views/dashboards/panelcontrols/querydialog/Modal","views/dashboards/panelcontrols/ReportDialog","views/dashboards/panelcontrols/CreateReportDialog","uri/route","util/console","splunk.util","views/shared/dialogs/TextDialog"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=t.extend({moduleId:i.id,initialize:function(e){t.prototype.initialize.apply(this,arguments),this.model.report.on("change:id",this.updateReportView,this),this.model.report.entry.content.on("change",this.updateReportView,this),this.collection=this.collection||{},this.collection.roles=new a({}),this.collection.roles.fetch()},onChangeElementTitle:function(e){e.preventDefault(),this.children.titleDialogModal=new l({model:{report:this.model.working,dashboard:this.model.dashboard},onHiddenRemove:!0}),r("body").append(this.children.titleDialogModal.render().el),this.children.titleDialogModal.show(),this.children.popdown.hide()},onChangeSearchString:function(e){e.preventDefault(),this.children.queryDialogModal=new c({model:{report:this.model.report,appLocal:this.model.appLocal,application:this.model.application,user:this.model.user,dashboard:this.model.dashboard,state:this.model.state},onHiddenRemove:!0}),r("body").append(this.children.queryDialogModal.render().el),this.children.queryDialogModal.show(),this.children.popdown.hide()},updateReportView:function(){this.debouncedRender()},render:function(){var e,t={};return this.model.report.get("id")?e=this.model.report.isPivotReport()?"icon-report-pivot":"icon-report-search":e=this.model.report.isPivotReport()?"icon-pivot":"icon-search-thin",t.panelClass=e,this.$el.html(this.compiledTemplate(t)),this.children.popdown=new o({el:this.el,mode:"dialog"}),this._renderPanelControls(),this},_renderPanelControls:function(){this.$(".dropdown-menu").html(e.template(this._panelControlsTemplate,{_:e}));var t;this.model.report.get("id")?t=this.model.report.isPivotReport()?e("PIVOT REPORT").t():e("SEARCH REPORT").t():t=this.model.report.isPivotReport()?e("INLINE PIVOT").t():e("INLINE SEARCH").t();var n=e.template('<li class="panelType"><%- panelType %></li>',{panelType:t});if(this.model.report.get("id")){var i=e.template('<ul class="report_actions"><%= panelTypeLI %><li><a class="viewPanelReport" href="#"><%- reportName %><span class="icon-triangle-right-small"></span></a></li></ul>',{panelTypeLI:n,reportName:this.model.report.entry.get("name")});this.$(".panel_actions").before(i),this.$(".panel_actions").prepend('<li><a href="#" class="changeElementTitle">'+e("Edit Title").t()+"</a></li>")}else this.$(".panel_actions").prepend(r('<li><a class="convertToReport" href="#">'+e("Convert to Report").t()+"</a></li>")),this.$(".panel_actions").prepend('<li><a href="#" class="changeSearchString">'+e("Edit Search String").t()+"</a></li>"),this.$(".panel_actions").prepend('<li><a href="#" class="changeElementTitle">'+e("Edit Title").t()+"</a></li>"),this.$(".panel_actions").prepend(n)},_panelControlsTemplate:'                <div class="arrow"></div>                <ul class="panel_actions">                    <li><a class="deletePanel" href="#"><%- _("Delete").t() %></a></li>                </ul>        ',template:'            <a class="dropdown-toggle btn-pill" href="#">                    <span class="<%- panelClass %>"></span><span class="caret"></span>            </a>            <div class="dropdown-menu">            </div>        ',onDelete:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_delete",flashModel:this.model.dashboard}),this.model.report.on("successfulDelete",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("primaryButtonLabel",e("Delete").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._dialogDeleteHandler,this),this.children.dialog.settings.set("titleLabel",e("Delete").t()),this.children.dialog.setText(m.sprintf(e("Are you sure you want to delete %s?").t(),"<em>"+e.escape(this.model.report.entry.content.get("display.general.title"))+"</em>")),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_dialogDeleteHandler:function(e){e.preventDefault(),this.model.report.trigger("deleteReport"),v.log("deleteReport event triggered")},onViewPanelReport:function(t){t.preventDefault(),t.stopPropagation();var n="",i,s,o=this.model.application.get("root"),a=this.model.application.get("locale"),f=this.model.application.get("app");i=d.report(o,a,f,{data:{s:this.model.report.get("id")}}),this.model.report.isPivotReport()?(n=this.pivotReportDetailsTemplate,s=d.pivot(o,a,f,{data:{s:this.model.report.get("id")}})):(n=this.searchReportDetailsTemplate,s=d.search(o,a,f,{data:{s:this.model.report.get("id")}})),this.$(".dropdown-menu").html(e.template(n,{viewReportLink:i,editReportLink:s,_:e})),this.children.reportDetails&&this.children.reportDetails.remove(),this.children.reportDetails=new u({model:{report:this.model.report,application:this.model.application,appLocal:this.model.appLocal,user:this.model.user},collection:this.collection.roles}),this.$(".reportDetails").prepend(r("<li/>").addClass("reportDetailsView").append(this.children.reportDetails.render().el));var l=this.model.report.entry.content.get("description");l&&this.$(".reportDetails").prepend(r("<li/>").addClass("report-description").text(l)),this.$(".reportDetails").prepend(r("<li/>").addClass("report-name").text(this.model.report.entry.get("name"))),this.$(".dropdown-menu").addClass("show-details"),r(window).trigger("resize")},searchReportDetailsTemplate:'            <div class="arrow"></div>            <a class="dialogBack btn" href="#"><span class="icon-triangle-left-small"/> <%- _("Back").t() %></a>            <ul class="reportDetails">                <li><a href="<%- viewReportLink %>" class="viewSearchReport"><%- _("View").t() %></a></li>                <li><a href="<%- editReportLink %>" class="openSearchReport"><%- _("Open in Search").t() %></a></li>                <li><a href="#" class="cloneSearchReport"><%- _("Clone to an Inline Search").t() %></a></li>            </ul>            <ul class="reportActions">                <li><a href="#" class="selectNewReport"><%- _("Select New Report").t() %></a></li>                <li><a href="#" class="useReportFormatting"><%- _("Use Report\'s Formatting for this Content").t() %></a></li>            </ul>        ',pivotReportDetailsTemplate:'            <div class="arrow"></div>            <a class="dialogBack btn" href="#"><span class="icon-triangle-left-small"/> <%- _("Back").t() %></a>            <ul class="reportDetails">                <li><a href="<%- viewReportLink %>" class="viewPivotReport"><%- _("View").t() %></a></li>                <li><a href="<%- editReportLink %>" class="openPivotReport"><%- _("Open in Pivot").t() %></a></li>                <li><a href="#" class="clonePivotReport"><%- _("Clone to an Inline Pivot").t() %></a></li>            </ul>            <ul class="reportActions">                <li><a class="selectNewReport"><%- _("Select New Report").t() %></a></li>                <li><a class="useReportFormatting"><%- _("Use Report\'s Formatting for this Content").t() %></a></li>            </ul>        ',onDialogBack:function(e){e.preventDefault(),e.stopPropagation(),this._renderPanelControls(),this.$(".dropdown-menu").removeClass("show-details"),r(window).trigger("resize")},tbd:function(e){e.preventDefault(),alert("Coming soon to a Splunk near you!")},convertToInlineSearch:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_inline",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Clone to Inline Search").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._convertToInlineSearch,this),this.model.report.on("successfulManagerChange",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Clone to Inline Search").t()),this.children.dialog.setText("<div>                <p>"+e("The report will be cloned to an inline search.").t()+"</p>                <p>"+e("The inline search:").t()+"                </p><ul>                <li>"+e("Cannot be scheduled.").t()+"</li>                <li>"+e("Will run every time the dashboard is loaded.").t()+"</li>                <li>"+e("Will use the permissions of the dashboard.").t()+"</li>                </ul>                </div>"),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},convertToInlinePivot:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_inline",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Clone to Inline Pivot").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._convertToInlineSearch,this),this.model.report.on("successfulManagerChange",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Clone to Inline Pivot").t()),this.children.dialog.setText("<div>                <p>"+e("The report will be cloned to an inline pivot.").t()+"</p>                <p>"+e("The inline pivot:").t()+"                </p><ul>                <li>"+e("Cannot be scheduled.").t()+"</li>                <li>"+e("Will run every time the dashboard is loaded.").t()+"</li>                <li>"+e("Will use the permissions of the dashboard.").t()+"</li>                </ul>                </div>"),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_convertToInlineSearch:function(e){e.preventDefault(),this.model.report.trigger("makeInline"),v.log("makeInline event triggered")},useReportFormatting:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_use_report_formatting",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Use Report's Formatting").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._useReportFormatting,this),this.model.report.on("successfulReportFormatting",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Use Report's Formatting").t()),this.children.dialog.setText(e("This will change the content's formatting to the report's formatting. Are you sure you want use the report's formatting?").t()),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_useReportFormatting:function(e){e.preventDefault(),this.model.report.trigger("useReportFormatting"),v.log("useReportFormatting event triggered")},selectNewReport:function(e){e.preventDefault(),this.children.newReportDialog=new h({model:{report:this.model.report,dashboard:this.model.dashboard,application:this.model.application},controller:this.options.controller,onHiddenRemove:!0}),r("body").append(this.children.newReportDialog.render().el),this.children.newReportDialog.show(),this.children.popdown.hide()},convertToReport:function(e){e.preventDefault(),this.children.createReportDialog=new p({model:{report:this.model.report,dashboard:this.model.dashboard},onHiddenRemove:!0}),r("body").append(this.children.createReportDialog.render().el),this.children.createReportDialog.show(),this.children.popdown.hide()},events:{"click a.deletePanel":"onDelete","click a.viewPanelReport":"onViewPanelReport","click a.changeElementTitle":"onChangeElementTitle","click a.changeSearchString":"onChangeSearchString","click a.dialogBack":"onDialogBack","click a.cloneSearchReport":"convertToInlineSearch","click a.clonePivotReport":"convertToInlinePivot","click a.selectNewReport":"selectNewReport","click a.convertToReport":"convertToReport","click a.useReportFormatting":"useReportFormatting","click a":function(e){var t=r(e.currentTarget).attr("href");t&&t[t.length-1]!=="#"&&(e.preventDefault(),window.open(t))},"click li.reportDetailsView a":function(e){this.children.popdown.hide()}}});return y}),define("splunkjs/mvc/simplexml/paneleditor",["require","exports","module","../mvc","../basesplunkview","views/shared/vizcontrols/Master","views/dashboards/panelcontrols/Master","../savedsearchmanager","../searchmanager","splunkjs/mvc/utils","underscore","splunk.config","models/Base","util/console","./controller","../tokenawaremodel","models/DashboardReport"],function(e,t,n){var r=e("../mvc"),i=e("../basesplunkview"),s=e("views/shared/vizcontrols/Master"),o=e("views/dashboards/panelcontrols/Master"),u=e("../savedsearchmanager"),a=e("../searchmanager"),f=e("splunkjs/mvc/utils"),l=e("underscore"),c=e("splunk.config"),h=e("models/Base"),p=e("util/console"),d=e("./controller"),v=e("../tokenawaremodel"),m=e("models/DashboardReport"),g=m.extend({initialize:function(e,t){m.prototype.initialize.apply(this,arguments),this._report=t.report,this.entry.content=new v({},{applyTokensByDefault:!0,retrieveTokensByDefault:!0}),this.setFromSplunkD(this._report.toSplunkD()),this.contentSyncer=f.syncModels({source:this._report.entry.content,dest:this.entry.content,auto:"push"}),this.entrySyncer=f.syncModels({source:this._report.entry,dest:this.entry,auto:"push"})},save:function(e,t){return e&&this.set(e,t),this._report.entry.set(this.entry.toJSON()),this._report.entry.content.set(this.entry.content.toJSON({tokens:!0})),this._report.saveXML(t)},syncOff:function(){this.contentSyncer.destroy(),this.entrySyncer.destroy(),this.off()}}),y=i.extend({className:"panel-editor",initialize:function(){this.children=this.children||{},i.prototype.initialize.call(this),this.model=this.model||{},this.model.report=this.model.report||new m,this.model.working=new g({},{report:this.model.report}),this.model.application=d.model.app,this.manager=this.options.manager,this._instantiateChildren(),this.bindToComponent(this.manager,this.onManagerChange,this),this.listenTo(this.model.report,"makeInline",this._makePanelInline,this),this.listenTo(this.model.report,"useReportFormatting",this._useReportFormatting,this),this.listenTo(this.model.report,"updateReportID",this._updateReportID,this),this.listenTo(this.model.report,"saveAsReport",this._saveAsReport,this),this.listenTo(this.model.report,"updateSearchString",this._updateSearchManager,this),this.listenTo(this.model.report,"deleteReport",this._deleteReport,this),this.listenTo(this.model.working,"saveTitle",this._saveTitle,this),this.model.user=d.model.user,this.model.appLocal=d.model.appLocal},_instantiateChildren:function(){this.children.vizControl=new s({model:{report:this.model.working,application:this.model.application},vizTypes:["events","statistics","visualizations"],saveOnApply:!0,dashboard:!0}),this.children.panelControl=new o({model:{report:this.model.report,working:this.model.working,application:this.model.application,appLocal:this.model.appLocal,user:this.model.user,dashboard:d.model.view,state:d.getStateModel()},controller:d})},remove:function(){this.model.working.syncOff(),this._removeChildren(),i.prototype.remove.apply(this,arguments)},_removeChildren:function(){this.children.vizControl.remove(),this.children.panelControl.remove()},_updateSearchManager:function(e){var t=this.model.report.toSplunkD();this.model.report.entry.content.set(e);var n=this.model.report.saveXML();n.done(l.bind(function(){this.model.report.trigger("successfulSave");var e=r.Components.get(this.manager);e.query&&e.query.set("search",this.model.report.entry.content.get("search",{tokens:!0}),{tokens:!0,silent:!1}),e.search&&e.search.set({earliest_time:this.model.report.entry.content.get("dispatch.earliest_time",{tokens:!0}),latest_time:this.model.report.entry.content.get("dispatch.latest_time",{tokens:!0})},{tokens:!0})},this)),n.fail(l.bind(function(){this.model.report.setFromSplunkD(t,{silent:!1})},this))},onManagerChange:function(){this._removeChildren(),this._instantiateChildren(),this.render()},render:function(){return this.$el.append(this.children.panelControl.render().el),this.$el.append(this.children.vizControl.render().el),this},_makePanelInline:function(){var e=this.model.report.toSplunkD(),t=this.model.report.entry.get("name"),n=this.model.report.get("id");delete this.model.report.id,this.model.report.unset("id",{silent:!0}),this.model.report.entry.unset("name",{silent:!0});var r=this.model.report.saveXML();r.fail(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!1})},this)),r.done(l.bind(function(){this.model.report.trigger("successfulManagerChange"),new a({id:this.manager,latest_time:this.model.report.entry.content.get("dispatch.latest_time"),earliest_time:this.model.report.entry.content.get("dispatch.earliest_time"),search:this.model.report.entry.content.get("search"),app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0}),this.model.report.set({id:n},{silent:!0}),this.model.report.unset("id",{silent:!1}),this.model.report.entry.set({name:t},{silent:!0}),this.model.report.entry.unset("name",{silent:!1})},this))},_useReportFormatting:function(){var e=this.model.report.toSplunkD(),t=this.model.report.fetch({},{silent:!0});t.done(l.bind(function(){var t=this.model.report.toSplunkD(),n=this.model.report.saveXML({clearOptions:!0});n.fail(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!1})},this)),n.done(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!0}),this.model.report.setFromSplunkD(t,{silent:!1}),this.model.report.trigger("successfulReportFormatting")},this))},this))},_updateReportID:function(e,t){var n=this.model.report.toSplunkD();e&&(this.model.report.set({id:e},{silent:!0}),this.model.report.entry.set({id:e},{silent:!0}),this.model.report.id=e),t&&this.model.report.entry.content.set({"display.general.title":t});var r=this.model.report.fetch({},{silent:!0});r.done(l.bind(function(){var e=this.model.report.saveXML();e.fail(l.bind(function(){this.model.report.setFromSplunkD(n,{silent:!1})},this)),e.done(l.bind(function(){this.model.report.trigger("successfulManagerChange"),new u({id:this.manager,searchname:this.model.report.entry.get("name"),app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0})},this))},this))},_saveAsReport:function(e,t){var n=this.model.report.toSplunkD();this.model.report.entry.content.set({name:e,description:t,"display.general.title":e}),this.model.report.entry.set({name:e},{silent:!0}),this.model.report.entry.content.get("display.general.search.type")==="postprocess"&&this.model.report.entry.content.set("search",r.Components.get(this.manager).query.resolve());var i=this.model.report.save({},{data:{app:f.getCurrentApp(),owner:c.USERNAME}});i.done(l.bind(function(){var t=this.model.report.saveXML();t.fail(l.bind(function(){this.model.report.destroy(),this.model.report.unset("id",{silent:!0}),this.model.report.setFromSplunkD(n,{silent:!1})},this)),t.done(l.bind(function(){this.model.report.trigger("successfulReportSave"),new u({id:this.manager,searchname:e,app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0})},this))},this))},_saveTitle:function(e){var t=this.model.report.toSplunkD();this.model.working.entry.content.set({"display.general.title":e});var n=this.model.working.save();n.fail(l.bind(function(){this.model.report.setFromSplunkD(t,{silent:!1})},this)),n.done(l.bind(function(){this.model.working.trigger("successfulSave"),this.model.report.entry.content.set({"display.general.title":""},{silent:!1}),this.model.report.entry.content.set({"display.general.title":e},{silent:!1})},this))},_deleteReport:function(){var e=this.model.report.deleteXML();e.done(l.bind(function(){this.model.report.trigger("successfulDelete"),this.model.report.trigger("removedPanel")},this))}});return y}),define("splunkjs/mvc/simplexml/element/base",["require","underscore","jquery","backbone","../../basesplunkview","../../../mvc","../../utils","../controller","models/DashboardReport","util/console","../../progressbarview","../../refreshtimeindicatorview","../../resultslinkview","../paneleditor","../../savedsearchmanager","../../postprocessmanager","../../messages"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../basesplunkview"),s=e("../../../mvc"),o=e("../../utils"),u=e("../controller"),a=e("models/DashboardReport"),f=e("util/console"),l=e("../../progressbarview"),c=e("../../refreshtimeindicatorview"),h=e("../../resultslinkview"),p=e("../paneleditor"),d=e("../../savedsearchmanager"),v=e("../../postprocessmanager"),m=e("../../messages"),g=!1,y={},b=(new a).fetch(),w=i.extend({initialVisualization:"#abstract",configure:function(){this.options.settingsOptions=t.extend({retainUnmatchedTokens:!0},this.options.settingsOptions||{}),this.options=t.extend(this.options,{id:this.id,manager:this.options.managerid,title:this.$("h3").text()}),g&&this.options.settingsOptions.tokens!==!0&&f.warn("element created without tokens=true: "+this.id),i.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.visualization=null,this.model=new a,this.managerid=this.options.managerid,this.settings._sync=o.syncModels(this.settings,this.model.entry.content,{auto:!0,prefix:"display.general.",include:["id","title","manager","managerid"]}),this.bindToComponent(this.managerid,this.onManagerChange,this);var e=this.typeModel=new r.Model({type:this.initialVisualization});this.reportReady=n.Deferred(),this.listenTo(this.typeModel,"change",this.createVisualization,this),this.listenTo(u.getStateModel(),"change:edit",this.onEditModeChange,this),this.reportReady.done(t.bind(function(){this.listenTo(this.model.entry.content,"change:display.general.type change:display.visualizations.type change:display.events.type",function(t){var n=t.get("display.general.type"),r=["display",n,"type"].join("."),i=t.get(r),s=i?[n,i].join(":"):n;e.set("type",y.hasOwnProperty(s)?s:n)},this),this.listenTo(this.settings,"change:title",this.updateTitle,this),this.listenTo(this.model,"removedPanel",this.remove,this)},this))},remove:function(){this._removeVisualization(),t([this.refreshTime,this.panelEditor]).chain().filter(t.identity).invoke("remove"),this.settings&&this.settings._sync&&this.settings._sync.destroy(),s.Components.get("dashboard").removeElement(this.id),i.prototype.remove.call(this)},onManagerChange:function(e,n){var r=this;if(n instanceof d){var i=n.get("searchname"),s=u.getStateModel().app,o=!this.model.entry.content.has("display.general.type");this.model.id=["","servicesNS",s.get("owner"),s.get("app"),"saved","searches",encodeURIComponent(i)].join("/"),this.model.fetch().done(function(){o&&r.model.entry.content.set(r._initialVisualizationToAttributes()),r.reportReady.resolve(r.model)}).fail(function(e){f.error("Failed to load saved search",arguments),e.status===404&&r.showErrorMessage(t("Warning: saved search not found: ").t()+JSON.stringify(i))})}else n?b.done(function(e){r.model.entry.content.has("display.general.type")||(r.model.entry.content.set(e.entry[0].content),r.initialVisualization!=="#abstract"&&r.model.entry.content.set(r._initialVisualizationToAttributes()));var t="inline";n instanceof v&&(t="postprocess",r.model.entry.content.set("fullSearch",n.query.resolve())),r.model.entry.content.set("display.general.search.type",t),r.model.entry.content.set({search:n.get("search",{tokens:!0}),"dispatch.earliest_time":n.get("earliest_time",{tokens:!0}),"dispatch.latest_time":n.get("latest_time",{tokens:!0})},{tokens:!0}),r.reportReady.resolve(r.model)}):b.done(function(e){r.model.entry.content.has("display.general.type")||(r.model.entry.content.set(e.entry[0].content),r.initialVisualization!=="#abstract"&&r.model.entry.content.set(r._initialVisualizationToAttributes())),r.reportReady.resolve(r.model)})},showErrorMessage:function(e){this._removeInitialPlaceholder();var t=this.$(".panel-body>.msg");t.length||(t=n('<div class="msg"></div>').appendTo(this.$(".panel-body"))),m.render({level:"error",icon:"warning-sign",message:e},t)},_initialVisualizationToAttributes:function(){var e=this.initialVisualization.split(":"),t={"display.general.type":e[0]};return e.length>1&&(t[["display",e[0],"type"].join(".")]=e[1]),t},onEditModeChange:function(e){var n=this._debouncedOnEditModeChange;n||(n=this._debouncedOnEditModeChange=t.debounce(t.bind(this._onEditModeChange,this),0)),this.reportReady.done(function(){n(e)})},_onEditModeChange:function(e){e.get("edit")?(this.refreshTime&&(this.refreshTime.remove(),this.refreshTime=null),this.updateTitle(),this.createPanelElementEditor()):(this.panelEditor&&(this.panelEditor.remove(),this.panelEditor=null),this.createRefreshTimeIndicator(),this.updateTitle())},createPanelElementEditor:function(){this.panelEditor&&(this.panelEditor.remove(),this.panelEditor=null),this.panelEditor=new p({manager:this.managerid,model:{report:this.model}}),this.$el.prepend(this.panelEditor.render().el)},createRefreshTimeIndicator:function(){this.refreshTime||(this.refreshTime=(new c({id:t.uniqueId(this.id+"-refreshtime"),el:n('<div class="refresh-time-indicator pull-right"></div>').prependTo(this.$(".panel-head")),manager:this.managerid})).render())},createVisualization:function(e){var r=this._debouncedCreateViz;r||(r=this._debouncedCreateViz=t.debounce(t.bind(this._createVisualization,this),0)),n.when(this.reportReady).then(function(){r(e===!0)})},_removeVisualization:function(){this.visualization&&(this.visualization.panelClassName&&this.$el.removeClass(this.visualization.panelClassName),this.visualization.off(),this.visualization.remove(),this.visualization=null),this.resultsLink&&(this.resultsLink.off(),this.resultsLink.remove(),this.resultsLink=null)},_removeInitialPlaceholder:function(){this.$(".panel-body > .msg, .panel-body > .initial-placeholder").remove()},_createVisualization:function(e){var r=!this.visualization;this._removeInitialPlaceholder(),this._removeVisualization();var i=this.typeModel.get("type"),o=y[i];if(!o){this.showErrorMessage(t("Unsupported visualization type: ").t()+JSON.stringify(i));return}var u={el:n("<div></div>").appendTo(this.$(".panel-body")),reportModel:this.model.entry.content,managerid:this.settings.get("manager"),id:t.uniqueId(this.id+"-viz-")};if(r||e)u=t.extend({},this.options,u);u.settingsOptions&&(u.settingsOptions.retainUnmatchedTokens=!1),g&&(u.settingsOptions||{}).tokens!==!0&&f.warn("viz created without tokens=true: "+u.id),this.visualization=(new o(u)).render(),this.visualization.panelClassName&&this.$el.addClass(this.visualization.panelClassName);if(i.indexOf("events")===0){var a=s.Components.getInstance(this.settings.get("manager"));a.search.set("status_buckets",300)}this.trigger("create:visualization",this.visualization),r&&this.model.entry.content.set(t.defaults(this.model.entry.content.toJSON({tokens:!0}),this.visualization.reportDefaults));if(typeof this.visualization.getResultsLinkOptions=="function"){var l=this.visualization.getResultsLinkOptions(this.options)||{};this.resultsLink=(new h(t.extend({},l,this.options,{id:t.uniqueId(this.id+"-resultslink"),el:n('<div class="view-results pull-left"></div>').appendTo(this.$(".panel-footer")),manager:this.managerid,model:this.model}))).render()}this.visualization.on("all",this.trigger,this)},getVisualization:function(e){var t=n.Deferred();return e&&t.done(e),this.visualization?t.resolve(this.visualization):this.once("create:visualization",t.resolve,t),t.promise()},render:function(){return this.createPanelStructure(),this.progressBar||(this.progressBar=(new l({id:t.uniqueId(this.id+"-progressbar"),manager:this.managerid,el:n('<div class="progress-container pull-right"></div>').prependTo(this.$(".panel-footer"))})).render()),this.createRefreshTimeIndicator(),this.createVisualization(),this.onEditModeChange(u.getStateModel()),this},createPanelStructure:function(){this.$(".panel-head").length||n('<div class="panel-head"></div>').prependTo(this.$el);var e=this.$(".panel-head>h3");e.length||n("<h3></h3>").prependTo(this.$(".panel-head")),this.updateTitle(),this.$(".panel-body").length||n('<div class="panel-body"></div>').appendTo(this.$el);var t=n('<div class="initial-placeholder"></div>').addClass("placeholder-"+this.initialVisualization.replace(/\W+/,"-"));t.appendTo(this.$(".panel-body")),this.$("panel-footer").length||n('<div class="panel-footer"></div>').appendTo(this.$el)},updateTitle:function(){var e=this.settings.get("title")||"";u.getStateModel().get("edit")&&!e?this.$(".panel-head>h3").empty().append(n('<span class="untitled">'+t("Untitled Panel").t()+"</span>")):this.$(".panel-head>h3").text(e)},getExportParams:function(e){var t=s.Components.get(this.managerid),n={};return t&&!(t instanceof v)&&t.job&&t.job.sid&&(n[e]=t.job.sid),n}},{registerVisualization:function(e,t){y[e]=t},getVisualization:function(e){var t=y[e];return t||(t=y[e.split(":")[0]]),t}});return w}),define("splunkjs/mvc/simplexml/dialog/addpanel/inline",["require","underscore","jquery","views/Base","views/shared/controls/ControlGroup","util/console","../../../utils","uri/route","util/time_utils","views/dashboards/PanelTimeRangePicker","bootstrap.tooltip"],function(e){var t=e("underscore"),n=e("jquery"),r=e("views/Base"),i=e("views/shared/controls/ControlGroup"),s=e("util/console"),o=e("../../../utils"),u=e("uri/route"),a=e("util/time_utils"),f=e("views/dashboards/PanelTimeRangePicker");return e("bootstrap.tooltip"),r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.searchField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"search",model:this.model.report},label:t("Search String").t(),help:'<a href="#" class="run-search">'+t("Run Search").t()+' <i class="icon-external"></i></a>'}),this.listenTo(this.model.report,"change:elementCreateType",this.onModeChange,this),this.children.panelTimeRangePicker=new f({model:{timeRange:this.model.timeRange,report:this.model.report,state:this.model.state},collection:this.collection}),this.model.report.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")},{tokens:!0})},events:{"click a.run-search":function(e){e.preventDefault();var t=this.model.report.get("search"),n={q:t},r=o.getPageInfo();if(!t)return;this.model.report.has("dispatch.earliest_time")&&(n.earliest=this.model.report.get("dispatch.earliest_time"),n.latest=this.model.report.get("dispatch.latest_time")),o.redirect(u.search(r.root,r.locale,r.app,{data:n}),!0)}},onModeChange:function(){var e=this.model.report.get("elementCreateType")==="inline"?"show":"hide";this.$el[e]()},render:function(){return this.children.searchField.render().appendTo(this.el),this.children.panelTimeRangePicker.render().appendTo(this.el),this.onModeChange(),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel/report",["require","underscore","jquery","views/Base","views/shared/controls/ControlGroup","../../../utils","util/time_utils","models/Cron","splunk.util","uri/route","collections/services/SavedSearches","views/shared/Modal"],function(e){var t=e("underscore"),n=e("jquery"),r=e("views/Base"),i=e("views/shared/controls/ControlGroup"),s=e("../../../utils"),o=e("util/time_utils"),u=e("models/Cron"),a=e("splunk.util"),f=e("uri/route"),l=e("collections/services/SavedSearches"),c=e("views/shared/Modal");return r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.reportPlaceholder=new r,this.controller=this.options.controller,this.controller.reportsCollection||this.controller.fetchCollection(),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){var e=this.controller.reportsCollection.map(function(e){return{label:e.entry.get("name"),value:e.id}}),n=s.getPageInfo(),r=f.reports(n.root,n.locale,n.app);this.controller.reportsCollection.length===this.controller.reportsCollection.REPORTS_LIMIT?this.children.report=new i({label:"",controlType:"SyntheticSelect",controlOptions:{className:"btn-group add-panel-report",toggleClassName:"btn",model:this.model,modelAttribute:"savedSearch",items:e,popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},help:t("This does not contain all reports. Add a report that is not listed from ").t()+a.sprintf("<a href=%s>%s</a>.",r,t("Reports").t())}):this.children.report=new i({label:"",controlType:"SyntheticSelect",controlOptions:{className:"btn-group add-panel-report",toggleClassName:"btn",model:this.model,modelAttribute:"savedSearch",items:e,popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}}),this.model.set("savedSearch",e[0].value)},this)),this.children.searchField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"savedSearchString",model:this.model},label:t("Search String").t(),help:'<a href="#" class="run-search">'+t("Run Search").t()+' <i class="icon-external"></i></a>'}),this.children.timerangeField=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchTimerange",model:this.model},label:t("Time Range").t()}),this.children.schedule=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchSchedule",model:this.model},label:t("Schedule").t()}),this.children.permissions=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchPermissions",model:this.model},label:t("Permissions").t()}),this.model.set("savedSearchString","..."),this.listenTo(this.model,"change:elementCreateType",this.onModeChange,this),this.listenTo(this.model,"change:savedSearch",this.searchSelected,this)},events:{"click a.run-search":function(e){e.preventDefault();var t=this.model.get("savedSearch");if(!t)return;var n=s.getPageInfo(),r=f.search(n.root,n.locale,n.app,{data:{s:t}});s.redirect(r,!0)}},searchSelected:function(){var e=this.model.get("savedSearch"),n=this.controller.reportsCollection.get(e);this.model.set("savedSearchName",n.entry.get("name")),this.model.set("savedSearchString",n.entry.content.get("search"));var r=n.entry.content.get("dispatch.earliest_time"),i=n.entry.content.get("dispatch.latest_time"),s="statistics",f;n.entry.content.has("display.general.type")&&(s=n.entry.content.get("display.general.type"),f=["display",s,"type"].join("."),n.entry.content.has(f)&&(s=[s,n.entry.content.get(f)].join(":"))),this.model.set("savedSearchVisualization",s),this.model.set("savedSearchTimerange",o.generateLabel(this.collection.timeRanges,r,null,i,null));var l=t("Never").t();if(n.entry.content.get("is_scheduled")){var c=u.createFromCronString(n.entry.content.get("cron_schedule"));l=c.getScheduleString()}this.model.set("savedSearchSchedule",l),this.model.set("savedSearchPermissions",a.sprintf(t("%s. Owned by %s.").t(),n.entry.acl.get("perms")?t("Shared").t():t("Not Shared").t(),n.entry.acl.get("owner")))},onModeChange:function(){this.$el[this.model.get("elementCreateType")==="saved"?"show":"hide"](),this.model.get("elementCreateType")==="saved"&&this.controller.reportsCollection.initialFetchDfd.readyState!==4&&this.$(c.LOADING_SELECTOR).length===0&&(this.$el.append(c.LOADING_HORIZONTAL),this.$(c.LOADING_SELECTOR).html(t("Loading...").t()))},render:function(){return this.children.reportPlaceholder.render().appendTo(this.el),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.$(c.LOADING_SELECTOR).length>0&&this.$(c.LOADING_SELECTOR).remove(),this.children.report.render().appendTo(this.children.reportPlaceholder.el),this.searchSelected(),this.children.searchField.render().appendTo(this.el),this.children.searchField.$("textarea").attr("readonly","readonly"),this.children.timerangeField.render().appendTo(this.el),this.children.schedule.render().appendTo(this.el),this.children.permissions.render().appendTo(this.el),this.onModeChange()},this)),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel/pivot",["require","underscore","views/Base","../../../utils","uri/route"],function(e){var t=e("underscore"),n=e("views/Base"),r=e("../../../utils"),i=e("uri/route");return n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:elementCreateType",this.onModeChange,this)},render:function(){if(!this.el.innerHTML){var e=r.getPageInfo();this.$el.html(t.template(this.template,{pivotLink:i.data_models(e.root,e.locale,e.app)}))}return this.onModeChange(),this},onModeChange:function(){var e=this.model.get("elementCreateType")==="pivot"?"show":"hide";this.$el[e]()},template:'<label class="control-label"></label><div class="controls">'+t("Use the Pivot tool to summarize Data Model information and add it as a dashboard panel. You'll need to know the name of this dashboard when you save from the Pivot tool.").t()+"</div>"})}),define("splunkjs/mvc/simplexml/dialog/addpanel/master",["require","exports","module","underscore","jquery","splunkjs/mvc","views/Base","views/shared/controls/ControlGroup","../../controller","./inline","./report","./pivot","util/console"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("splunkjs/mvc"),o=e("views/Base"),u=e("views/shared/controls/ControlGroup"),a=e("../../controller"),f=e("./inline"),l=e("./report"),c=e("./pivot"),h=e("util/console");return o.extend({moduleId:t.id,className:"add-panel",initialize:function(){o.prototype.initialize.call(this,arguments),this.children.panelTitleControlGroup=new u({label:r("Content Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.report,modelAttribute:"title",placeholder:"optional"}}),this.children.elementCreateType=new u({label:r("Content Type").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group btn-group-3 add-panel-select",items:[{value:"inline",label:'<i class="icon-search-thin"></i>',tooltip:r("Inline Search").t()},{value:"pivot",label:'<i class="icon-pivot"></i>',tooltip:r("Inline Pivot").t()},{value:"saved",label:'<i class="icon-report"></i>',tooltip:r("Report").t()}],model:this.model.report,modelAttribute:"elementCreateType"}});var e=a.collection.times;this.children.inline=new f({model:this.model,collection:{timeRanges:e}}),this.children.report=new l({model:this.model.report,collection:{timeRanges:e},controller:this.options.controller}),this.children.pivot=new c({model:this.model.report})},render:function(){return this.$el.append(this.children.panelTitleControlGroup.render().el),this.$el.append(this.children.elementCreateType.render().el),this.$el.append(this.children.inline.render().el),this.$el.append(this.children.pivot.render().el),this.$el.append(this.children.report.render().el),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel",["require","exports","module","underscore","jquery","splunkjs/mvc","views/shared/Modal","models/Base","../../utils","../controller","../element/base","../mapper","./addpanel/master","../../searchmanager","../../savedsearchmanager","util/console","views/shared/timerangepicker/dialog/Master","models/TimeRange","views/shared/delegates/ModalTimerangePicker","../controller","uri/route","views/shared/FlashMessages"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("splunkjs/mvc"),o=e("views/shared/Modal"),u=e("models/Base"),a=e("../../utils"),f=e("../controller"),l=e("../element/base"),c=e("../mapper"),h=e("./addpanel/master"),p=e("../../searchmanager"),d=e("../../savedsearchmanager"),v=e("util/console"),m=e("views/shared/timerangepicker/dialog/Master"),g=e("models/TimeRange"),y=e("views/shared/delegates/ModalTimerangePicker"),b=e("../controller"),w=e("uri/route"),E=e("views/shared/FlashMessages"),S=u.extend({defaults:{elementCreateType:"inline","dispatch.earliest_time":"0","dispatch.latest_time":"now"},validation:{search:{fn:"validateSearchQuery"}},validateSearchQuery:function(e,t,n){if(n.elementCreateType==="inline"&&!e)return"Search string is required."},sync:function(e,t,n){v.log("NewPanelModel.sync(%o, %o, %o)",e,t,n);if(e!=="create")throw new Error("Unsupported sync method: "+e);if(!t.isValid())return!1;var o=i.Deferred(),u=this.get("elementCreateType"),h,m=1;do h="element"+m++;while(s.Components.has(h));var g=u==="saved"?this.get("savedSearchVisualization")||"visualizations:charting":"visualizations:charting",y=c.get(g);return f.getStateModel().view.addElement(h,{type:y.tagName,title:this.get("title"),search:{type:u,search:this.get("search"),earliest_time:this.get("dispatch.earliest_time"),latest_time:this.get("dispatch.latest_time"),name:this.get("savedSearchName")}}).done(r.bind(function(){var e=s.Components.get("dashboard").createNewElement({title:this.get("title"),id:h}),t=r.uniqueId("new-search");switch(u){case"inline":new p({id:t,search:this.get("search"),earliest_time:this.get("dispatch.earliest_time")||"0",latest_time:this.get("dispatch.latest_time")||"now",app:a.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0,runOnSubmit:!0},{tokens:!0});break;case"saved":new d({id:t,searchname:this.get("savedSearchName"),app:a.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0})}var n=l.extend({initialVisualization:g}),i=new n({id:h,managerid:t,el:e},{tokens:!0});i.render(),o.resolve()},this)),o.promise()}});return o.extend({moduleId:t.id,className:"modal add-panel",initialize:function(){o.prototype.initialize.apply(this,arguments),this.model=this.model||{},this.model.report=new S;var e=this.model.timeRange=new g({earliest:"0",latest:"now"}),t=f.model.app,n=f.model.user,r=f.model.appLocal,i=f.collection.times;this.children.addPanel=new h({model:{report:this.model.report,timeRange:e,state:b.getStateModel()},collection:{times:i},controller:this.options.controller}),this.children.timeRangePickerView=new m({model:{timeRange:e,user:n,appLocal:r,application:t},collection:i}),this.children.flashMessages=new E({model:this.model.report}),e.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.listenTo(this.model.report,"change:elementCreateType",this.handleSubmitButtonState,this)},events:{"click a.modal-btn-primary":function(e){if(this.model.report.get("elementCreateType")==="pivot")return;e.preventDefault(),f.getStateModel().set("edit",!1);var t=this;this.model.timeRange.get("useTimeFrom")=="dashboard"&&this.model.report.set({"dispatch.earliest_time":"$earliest$","dispatch.latest_time":"$latest$"},{tokens:!0});var n=this.model.report.save();n?n.done(function(){setTimeout(function(){f.getStateModel().set("edit",!0)},250),t.hide()}):f.getStateModel().set("edit",!0)},hide:function(e){e.target===this.el&&this.remove()}},handleSubmitButtonState:function(e){if(this.model.report.get("elementCreateType")==="pivot"){var t=a.getPageInfo();this.$(o.FOOTER_SELECTOR).find(".btn-primary").replaceWith('<a href="'+w.data_models(t.root,t.locale,t.app)+'" class="btn btn-primary modal-btn-primary">'+r("Go to Pivot").t()+"</a>")}else this.$(o.FOOTER_SELECTOR).find(".btn-primary").replaceWith('<a href="#" class="btn btn-primary modal-btn-primary">'+r("Add Panel").t()+"</a>")},setLabel:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.$el.html(o.TEMPLATE),this.$(o.HEADER_TITLE_SELECTOR).html(r("Add Panel").t()),this.$(o.BODY_SELECTOR).remove(),this.$(o.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper add-panel-wrapper"><div class="'+o.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$(o.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(o.BODY_SELECTOR).append(o.FORM_HORIZONTAL_JUSTIFIED),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$addpanelContent=this.$(".add-panel-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$(o.BODY_FORM_SELECTOR).append(this.children.addPanel.render().el),this.$timeRangePickerWrapper.append(this.children.timeRangePickerView.render().el),this.$modalParent=this.$el,this.timeRangeDelegate=new y({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$addpanelContent,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_CANCEL),this.$(o.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+r("Add Panel").t()+"</a>"),this.$(o.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+r("Back").t()+"</a>"),this.$(".btn.back").hide(),this}})}),define("splunkjs/mvc/simpleform/input/base",["require","underscore","jquery","../../basesplunkview","../../tokenutils"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../../basesplunkview"),i=e("../../tokenutils"),s=r.extend({options:{submitOnChange:!1},initialize:function(e){this.configure(),this.settings.enablePush("value"),this.settings.on("change:label",this.renderLabel,this),e=e||{},this.inputId=e.inputId||t.uniqueId((this.id||"input")+"_")},handleChange:function(){this.settings.set("value",this.getValue())},submit:function(){this.trigger("change",this)},hasValue:function(){var e=this.settings.get("value"),t=this.settings.get("default");return e||t===undefined||e===t},setValue:function(e){throw"setValue not implemented"},getValue:function(){throw"getValue not implemented"},renderLabel:function(){var e=this.$("label");e.length||(e=n("<label></label>").appendTo(this.el)),e.attr("for",this.inputId);if(this.settings.has("label"))e.text(this.settings.get("label"));else{var t=e.text();t&&this.settings.set("label",t)}},val:function(e){return arguments.length>=1&&this.setValue(e),this.getValue()},on:function(){return this._applyToWrappedView("on",arguments)},off:function(){return this._applyToWrappedView("off",arguments)},trigger:function(){return this._applyToWrappedView("trigger",arguments)},_applyToWrappedView:function(e,t){var n=this._getWrappedView();return n===this?r.prototype[e].apply(this,t):n[e].apply(n,t)},_getWrappedView:function(){return this}});return s}),define("splunkjs/mvc/simpleform/input/timerange",["require","underscore","jquery","./base","../../simplexml/controller","../../mvc","../../timerangeview"],function(e){var t=e("underscore"),n=e("jquery"),r=e("./base"),i=e("../../simplexml/controller"),s=e("../../mvc"),o=e("../../timerangeview"),u={earliest_time:undefined,latest_time:undefined},a=r.extend({events:{"click .remove-timerange-picker a":function(e){e.preventDefault(),this.remove()}},initialize:function(){var e=t.defaults({el:n('<div class="splunk-view"></div>').appendTo(this.el),id:t.uniqueId(this.id+"-input")},this.options);this.picker=new o(e),this.picker.on("change",this.handleChange,this),this.options.settings=this.picker.settings,r.prototype.initialize.call(this),this._isGlobalTimeRangeInput()&&i.getStateModel().on("change:edit",this._onEditStateChange,this)},hasValue:function(){var e=this.settings.get("value")||u,n=this.settings.get("default"),r=this.settings.get("preset");return!t.isEqual(e,u)||!n&&!r},updateValueWithDefault:function(){var e=this.settings.get("default"),t=this.settings.get("preset");return e?this.val(e):t&&this.picker._onTimePresetUpdate(),this},handleChange:function(e,t){e=e||u,this._isGlobalTimeRangeInput()&&(e=this.val(),i.getStateModel().set("default_timerange",{earliestTime:e.earliest_time,latestTime:e.latest_time})),r.prototype.handleChange.apply(this,arguments)},_onEditStateChange:function(e){this._isGlobalTimeRangeInput()&&(e.get("edit")?(n('<div class="remove-timerange-picker"><a href="#"><i class="icon-x-circle"></i></a></div>').appendTo(this.picker.$el),n('<div class="timerange-edit-hint"></div>').html(t('Select default time range above. Time range only applies to <i class="icon-search-thin"></i> Inline Searches.').t()).appendTo(this.picker.$el)):(this.$(".remove-timerange-picker").remove(),this.$(".timerange-edit-hint").remove()))},_isGlobalTimeRangeInput:function(){return this.settings.has("isGlobal")?this.settings.get("isGlobal")===!0:this.settings.get("earliest_time",{tokens:!0})==="$earliest$"&&this.settings.get("latest_time",{tokens:!0})==="$latest$"},remove:function(){this.picker.remove(),s.Components.revokeInstance(this.id),r.prototype.remove.apply(this,arguments),this._isGlobalTimeRangeInput()&&(i.getStateModel().off(null,null,this),i.getStateModel().set("default_timerange",null))},getValue:function(){return this.picker.val()},setValue:function(e){return this.picker.val(e)},render:function(){return this.renderLabel(),this.picker.render(),this._onEditStateChange(i.getStateModel()),this.handleChange(this.val(),this.picker),this},_getWrappedView:function(){return this.picker}});return a}),define("views/shared/documentcontrols/dialogs/TitleDescriptionDialog",["underscore","backbone","module","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model={inmem:this.model.clone(),report:this.model},this.children.flashMessage=new s({model:this.model.inmem}),this.children.titleField=new i({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Title").t()}),this.children.descriptionField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.inmem.entry.content,placeholder:e("optional").t()},label:e("Description").t()}),this.on("hidden",function(){this.model.inmem.get("updated")>this.model.report.get("updated")&&this.model.report.entry.content.set("description",this.model.inmem.entry.content.get("description"))},this)},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.inmem.save({},{success:function(e,t){this.hide()}.bind(this)}),e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Description").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.titleField.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.descriptionField.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this}})}),define("views/shared/documentcontrols/dialogs/DeleteDialog",["underscore","backbone","module","models/Report","views/shared/Modal","views/shared/FlashMessages","uri/route","splunk.util"],function(e,t,n,r,i,s,o,u){return i.extend({moduleId:n.id,initialize:function(e){i.prototype.initialize.apply(this,arguments),this.children.flashMessage=new s({model:this.model.report})},events:$.extend({},i.prototype.events,{"click .btn-primary":function(e){var t=this.model.report.destroy({wait:!0});$.when(t).then(function(){this.hide(),this.options.deleteRedirect&&(this.model.report.isAlert()?window.location=o.alerts(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app")):window.location=o.reports(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app")))}.bind(this)),e.preventDefault()}}),render:function(){return this.$el.html(i.TEMPLATE),this.$(i.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.model.report.isAlert()?this.$(i.HEADER_TITLE_SELECTOR).html(e("Delete Alert").t()):this.$(i.HEADER_TITLE_SELECTOR).html(e("Delete Report").t()),this.$(i.BODY_SELECTOR).append("<span>"+u.sprintf(e("Are you sure you want to delete %s?").t(),"<em>"+e.escape(this.model.report.entry.get("name"))+"</em>")+"</span>"),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_CANCEL),this.$(i.FOOTER_SELECTOR).append(this.compiledTemplate({_:e})),this},template:'            <a href="#" class="btn btn-primary"><%- _("Delete").t() %></a>        '})}),define("views/dashboards/table/controls/ConvertSuccess",["jquery","underscore","module","views/shared/Modal","uri/route","views/shared/documentcontrols/dialogs/permissions_dialog/Master"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,options:{refreshOnDismiss:!1},initialize:function(){r.prototype.initialize.apply(this,arguments),this.options.refreshOnDismiss&&this.on("hide hidden",function(){window.location.reload()})},events:e.extend({},r.prototype.events,{"click .edit-perms":function(n){n.preventDefault();var r=this,i=r.model,o=r.collection.roles;t.defer(function(){var t=new s({model:{document:i.dashboard,nameModel:i.dashboard.entry.content,user:i.user},collection:o,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0});r.options.refreshOnDismiss&&t.on("hide hidden",function(){window.location.reload()}),e("body").append(t.render().el),t.show()}),r.options.refreshOnDismiss&&r.off("hide hidden"),r.hide(),r.remove()}}),render:function(){this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(t("Dashboard has been converted.").t()),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL);var e=this.model.dashboard.entry.acl.get("app"),n=this.model.dashboard.entry.get("name"),s=i.page(this.model.application.get("root"),this.model.application.get("locale"),e,n),o=i.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),this.model.dashboard.entry.get("name")),u="/manager/"+e+"/data/ui/views/"+n+"?action=edit&ns="+e+"&redirect_override="+encodeURIComponent(o);return this.$(r.BODY_FORM_SELECTOR).append(t.template(this.messageTemplate,{dashboardLink:s,_:t})),this.$(r.FOOTER_SELECTOR).append(t.template(this.buttonTemplate,{dashboardLink:s,editLink:u,_:t})),this.$(r.FOOTER_SELECTOR).append(""),this},buttonTemplate:'<a href="<%= editLink %>" class="btn edit-panels"><%- _("Edit HTML").t() %></a><a href="<%= dashboardLink %>" class="btn btn-primary modal-btn-primary"><%- _("View").t() %></a>',messageTemplate:'<p><%- _("You may now view your dashboard, change additional settings, or edit the HTML.").t() %></p><p><%- _("Additional Settings").t() %>:<ul><li><a href="#" class="edit-perms"><%- _("Permissions").t() %></a></li></ul></p>'})}),define("views/shared/delegates/PairedTextControls",["jquery","underscore","backbone","views/shared/controls/TextControl","views/shared/delegates/Base"],function(e,t,n,r,i){return i.extend({transformFunction:undefined,initialize:function(e){e=e||{},this.sourceDelegate=e.sourceDelegate,this.destDelegate=e.destDelegate,this.transformFunction=e.transformFunction;if(!(this.sourceDelegate instanceof r&&this.destDelegate instanceof r))throw new Error("SourceDelegate and destDelegate must be TextControls");this.enablePairing()},enablePairing:function(){this.sourceDelegate.on("keyup",this.sourceChangeHandler,this),this.destDelegate.on("keyup",this.destChangeHandler,this)},disablePairing:function(){this.sourceDelegate.off("keyup",this.sourceChangeHandler,this)},sourceChangeHandler:function(e,t){var n=t;this.transformFunction&&(n=this.transformFunction(t)),this.destDelegate.setValue(n)},destChangeHandler:function(e,t){e.keyCode!=9&&e.keyCode!=16&&(this.disablePairing(),this.destDelegate.off("keyup",this.destChangeHandler))}})}),define("views/dashboards/table/controls/ConvertDashboard",["underscore","jquery","module","views/shared/Modal","views/shared/controls/ControlGroup","models/Base","models/Dashboard","views/shared/FlashMessages","views/dashboards/table/controls/ConvertSuccess","views/shared/delegates/PairedTextControls","views/shared/controls/TextControl","util/splunkd_utils","uri/route","util/xml_utils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={NEW:0,REPLACE:1};return r.extend({moduleId:n.id,initialize:function(){var t=this;r.prototype.initialize.apply(this,arguments),this.model.perms=new s({perms:"private"}),this.model.convertMode=new s({mode:d.NEW}),this.children.flashMessages=new u({model:{dashboard:this.model.dashboard,dashboardMeta:this.model.dashboard.meta}}),this.model.dashboard.meta.set({label:this.model.dashboard.meta.get("label")+e(" HTML").t()}),this.children.titleTextControl=new l({modelAttribute:"label",model:this.model.dashboard.meta,placeholder:"optional",save:!1}),this.children.filenameTextControl=new l({modelAttribute:"name",model:this.model.dashboard.entry.content,save:!1}),this.children.filenameTextControl.setValue(c.nameFromString(this.model.dashboard.meta.get("label"))),this.pairedTextControls=new f({sourceDelegate:this.children.titleTextControl,destDelegate:this.children.filenameTextControl,transformFunction:c.nameFromString}),this.children.mode=new i({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"mode",model:this.model.convertMode,items:[{label:e("Create New").t(),value:d.NEW},{label:e("Replace Current").t(),value:d.REPLACE}],save:!1},label:e("Dashboard").t(),help:e("Recommended").t()}),this.children.title=new i({controls:this.children.titleTextControl,label:e("Title").t()}),this.children.filename=new i({controls:this.children.filenameTextControl,label:e("ID").t(),help:e("Can only contain letters, numbers and underscores.").t(),tooltip:e("The ID is used as the filename on disk. Cannot be changed later.").t()}),this.children.description=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1},label:e("Description").t()}),this.children.permissions=new i({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"perms",model:this.model.perms,items:[{label:e("Private").t(),value:"private"},{label:e("Shared").t(),value:"shared"}],save:!1},label:e("Permissions").t()}),this.model.convertMode.on("change:mode",function(){t.children.flashMessages.flashMsgCollection.reset(),t.model.convertMode.get("mode")===d.NEW?(t.children.title.show(),t.children.filename.show(),t.children.description.show(),t.children.permissions.show()):(t.children.flashMessages.flashMsgCollection.add({type:"warning",html:e("This change cannot be undone.").t()}),t.children.title.hide(),t.children.filename.hide(),t.children.description.hide(),t.children.permissions.hide())})},events:t.extend({},r.prototype.events,{"click a.modal-btn-primary":function(e){e.preventDefault(),this.submit()}}),submit:function(){var n=this,r=n.model.dashboard,i=n.model.currentDashboard,s=n.model.application,o=n.model.user,u=h.page(s.get("root"),s.get("locale"),i.entry.acl.get("app"),i.entry.get("name"))+"/converttohtml",f=n.collection&&n.collection.dashboards;if(this.model.convertMode.get("mode")===d.NEW){r.meta.validate();if(r.meta.isValid()){var l=r.meta.toJSON();r.entry.content.set("eai:data",i.entry.content.get("eai:data")),r.entry.content.set("eai:type","views"),r.meta.set(l),r.meta.apply(),t.post(u,{xmlString:r.entry.content.get("eai:data"),newViewID:r.entry.content.get("name")}).done(function(t){r.entry.content.set("eai:type","html"),r.entry.content.set("eai:data",t),r.save({},{data:s.getPermissions(n.model.perms.get("perms"))}).done(function(){f&&n.collection.dashboards.add(n.model.dashboard),e.defer(function(){var e=new a({model:{dashboard:r,application:s,user:o},collection:n.collection});e.render().show()}),n.hide(),n.remove()})})}}else t.post(u,{xmlString:i.entry.content.get("eai:data")}).done(function(t){i.entry.content.set("eai:type","html"),i.entry.content.set("eai:data",t),i.save().done(function(){f&&i.trigger("updateCollection"),e.defer(function(){var e=new a({model:{dashboard:i,application:s},collection:n.collection,refreshOnDismiss:!f});e.render().show()}),n.hide(),n.remove()})})},render:function(){var t=h.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.html.dashboard");return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Convert Dashboard to HTML").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(r.BODY_SELECTOR).append("<p>"+e("HTML dashboards cannot be edited using Splunk's visual editors.").t()+"<br />"+e("Integrated PDF generation is not available for HTML dashboards.").t()+"<br />"+"<a href="+t+">"+e("Learn More").t()+' <i class="icon-external"></i></a></p>'),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.mode.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.title.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.filename.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.description.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.permissions.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Convert Dashboard").t()+"</a>"),this}})}),define("models/services/ScheduledView",["jquery","underscore","backbone","models/SplunkDBase","models/Base","backbone_validation"],function(e,t,n,r,i,s){var o=r.extend({defaults:{is_scheduled:!1,"action.email.subject":"Splunk Alert: $name$","action.email.papersize":"letter","action.email.paperorientation":"portrait",cron_schedule:"0 6 * * 1"},initialize:function(){r.prototype.initialize.apply(this,arguments)},url:function(){return"scheduled/views/"+this.viewName},findByName:function(e,n,r){this.viewName=e,this.id="scheduled/views/"+e;var i=this.fetch({data:{app:n,owner:r}});return i.done(t.bind(this.applyDefaultsIfNotScheduled,this)),i},applyDefaultsIfNotScheduled:function(){this.entry.content.get("is_scheduled")||this.entry.content.set(this.defaults)}});return o.Entry=o.Entry.extend({}),o.Entry.Content=o.Entry.Content.extend({validation:{"action.email.to":[{fn:"validateEmailList"}],"action.email.subject":{required:!0,msg:t("Subject is empty").t()}},validateEmailList:function(e,n,r){if(r.is_scheduled){if(!e)return t("Email Address list is empty").t();if(t(e.split(/\s*,\s*/)).any(function(e){return!s.patterns.email.test(e)}))return t("Email Address list is invalid").t()}}}),o}),define("views/dashboards/table/controls/SchedulePDF",["module","jquery","underscore","backbone","util/console","util/pdf_utils","models/services/ScheduledView","models/Cron","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/ScheduleSentence","views/shared/FlashMessages","uri/route"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=a.extend({render:function(){this.el.innerHTML||this.$el.html(n.template(this.template,{label:this.options.label||"",controlClass:this.options.controlClass||"",body:n.template(this.options.body||"")(this.model?this.model.toJSON?this.model.toJSON():this.model:{})}));var e=this.$(".controls");return n.each(this.options.children,function(t){t.render().appendTo(e)}),this},template:'<label class="control-label"><%- label %></label><div class="controls <%- controlClass %>"><%= body %></div>'});return f.extend({moduleId:e.id,className:"modal schedule-pdf",initialize:function(){f.prototype.initialize.apply(this,arguments),this.model.inmem=new o.Entry.Content(this.model.scheduledView.entry.content.toJSON());var e=this.model.cron=u.createFromCronString(this.model.inmem.get("cron_schedule")||"0 6 * * 1");this.listenTo(e,"change",function(){this.model.inmem.set("cron_schedule",e.getCronString())},this);var t=p.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email");this.children.flashMessages=new h({model:{scheduledView:this.model.scheduledView,content:this.model.inmem}}),this.children.name=new l({controlType:"Label",controlOptions:{modelAttribute:"label",model:this.model.dashboard.entry.content},label:n("Dashboard").t()}),this.children.schedule=new l({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"is_scheduled",model:this.model.inmem,save:!1},label:n("Schedule PDF").t()}),this.conditionalControls=[this.children.scheduleSentence=new c({model:{cron:this.model.cron},lineOneLabel:n("Schedule").t(),popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}),this.children.emailAddresses=new l({controlType:"Textarea",controlOptions:{modelAttribute:"action.email.to",model:this.model.inmem,save:!1},label:n("Email Addresses").t(),help:n("Comma separated list.").t()+"<br/>"+n("Email must be configured in System&nbsp;Settings > Alert&nbsp;Email&nbsp;Settings.").t()+" <a href="+t+">"+n("Learn More").t()+' <i class="icon-external"></i></a>'}),this.children.emailSubject=new l({controlType:"Text",controlOptions:{modelAttribute:"action.email.subject",model:this.model.inmem,save:!1},label:n("Email Subject Line").t()}),this.children.paperSize=new l({className:"control-group",controlType:"SyntheticSelect",controlOptions:{modelAttribute:"action.email.papersize",model:this.model.inmem,items:[{label:n("A2").t(),value:"a2"},{label:n("A3").t(),value:"a3"},{label:n("A4").t(),value:"a4"},{label:n("A5").t(),value:"a5"},{label:n("Letter").t(),value:"letter"},{label:n("Legal").t(),value:"legal"}],save:!1,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},label:n("Paper Size").t()}),this.children.paperLayout=new l({controlType:"SyntheticRadio",controlOptions:{modelAttribute:"action.email.paperorientation",model:this.model.inmem,items:[{label:n("Portrait").t(),value:"portrait"},{label:n("Landscape").t(),value:"landscape"}],save:!1},label:n("Paper Layout").t()}),this.children.previewLinks=new d({body:'<div class="preview-actions"><div class="test-email"><a href="#" class="action-send-test">'+n("Send Test Email").t()+"</a></div> "+'<a href="#" class="action-preview">'+n("Preview PDF").t()+"</a>"+"</div>"})],this.model.inmem.on("change:is_scheduled",this._toggle,this)},events:t.extend({},f.prototype.events,{"click .action-send-test":function(e){e.preventDefault(),this.model.inmem.validate();if(this.model.inmem.isValid()){var t=this.$(".test-email"),r=this.children.flashMessages.flashMsgCollection;t.html(n("Sending...").t()),s.sendTestEmail(this.model.dashboard.entry.get("name"),this.model.dashboard.entry.acl.get("app"),this.model.inmem.get("action.email.to"),{paperSize:this.model.inmem.get("action.email.papersize"),paperOrientation:this.model.inmem.get("action.email.paperorientation")}).done(function(){t.html('<i class="icon-check"></i> '+n("Email sent.").t())}).fail(function(e){t.html('<span class="error"><i class="icon-warning-sign"></i> '+n("Failed!").t()+"</span>"),e&&r.add({type:"warning",html:n("Sending the test email failed: ").t()+n.escape(e)})}).always(function(){setTimeout(function(){t.html('<a href="#" class="action-send-test">'+n("Send Test Email").t()+"</a>")},5e3)})}},"click .action-preview":function(e){e.preventDefault();var t="",n=this.model.inmem.get("action.email.paperorientation"),r=this.model.inmem.get("action.email.papersize")||"a2";n==="landscape"&&(t="-landscape"),s.getRenderURL(this.model.dashboard.entry.get("name"),this.model.dashboard.entry.acl.get("app"),{"paper-size":r+t}).done(function(e){window.open(e)})},"click .modal-btn-primary":function(e){e.preventDefault(),this.model.inmem.validate();if(this.model.inmem.isValid())if(this.model.inmem.get("is_scheduled")==0&&this.model.scheduledView.entry.content.get("is_scheduled")===!1)this.hide();else{this.model.scheduledView.entry.content.set(this.model.inmem.toJSON());var t=this;this.model.scheduledView.save({},{success:function(){t.hide()}})}}}),_toggle:function(){n.chain(this.conditionalControls).pluck("$el").invoke(this.model.inmem.get("is_scheduled")?"show":"hide")},render:function(){return this.$el.html(f.TEMPLATE),this.$(f.HEADER_TITLE_SELECTOR).html(n("Edit PDF Schedule").t()),this.$(f.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(f.BODY_SELECTOR).append(f.FORM_HORIZONTAL),this.$(f.BODY_FORM_SELECTOR).append(this.children.name.render().el),this.$(f.BODY_FORM_SELECTOR).append(this.children.schedule.render().el),n.each(this.conditionalControls,function(e){this.$(f.BODY_FORM_SELECTOR).append(e.render().el)},this),this.$(f.FOOTER_SELECTOR).append(f.BUTTON_CANCEL),this.$(f.FOOTER_SELECTOR).append(f.BUTTON_SAVE),this._toggle(),this}})}),define("views/dashboards/table/controls/CloneSuccess",["underscore","module","views/shared/Modal","uri/route","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/dashboards/table/controls/SchedulePDF","models/services/ScheduledView"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,events:$.extend({},n.prototype.events,{"click .edit-perms":function(t){t.preventDefault();var n=this.model,r=this.collection.roles;e.defer(function(){var e=new i({model:{document:n.dashboard,nameModel:n.dashboard.entry.content,user:n.user},collection:r,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0});$("body").append(e.render().el),e.show()}),this.hide(),this.remove()},"click .schedule-pdf":function(t){t.preventDefault();var n=this.model,r=function(){var e=new s({model:{scheduledView:n.scheduledView,dashboard:n.dashboard,application:n.application,appLocal:n.appLocal},onHiddenRemove:!0});$("body").append(e.render().el),e.show()};if(!this.model.scheduledView){var i=n.scheduledView=new o,u=i.findByName(this.model.dashboard.entry.get("name"),this.model.application.get("app"),this.model.application.get("owner"));u.done(r)}else e.defer(r);this.hide(),this.remove()}}),render:function(){this.$el.html(n.TEMPLATE),this.$(n.HEADER_TITLE_SELECTOR).html(e("Dashboard has been cloned.").t()),this.$(n.BODY_SELECTOR).append(n.FORM_HORIZONTAL);var t=r.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.dashboard.entry.acl.get("app"),this.model.dashboard.entry.get("name")),i=this.model.dashboard.entry.acl.get("can_change_perms"),s=this.model.user.canScheduleSearch()&&!this.model.user.isFree()&&(this.model.dashboard.isSimpleXML()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated");return this.$(n.BODY_FORM_SELECTOR).append(e.template(this.messageTemplate,{dashboardLink:t,canChangePerms:i,canSchedule:s})),this.$(n.FOOTER_SELECTOR).append(e.template(this.buttonTemplate,{dashboardLink:t,_:e})),this.$(n.FOOTER_SELECTOR).append(""),this},buttonTemplate:'<a href="<%= dashboardLink %>/edit" class="btn edit-panels"><%- _("Edit Panels").t() %></a><a href="<%= dashboardLink %>" class="btn btn-primary modal-btn-primary"><%- _("View").t() %></a>',messageTemplate:'<p><%- _("You may now view your dashboard, change additional settings, or edit the panels.").t() %></p><p><% if(canChangePerms || canSchedule){ %><%- _("Additional Settings").t() %>:<ul><% if(canChangePerms) { %><li><a href="#" class="edit-perms"><%- _("Permissions").t() %><% } %></a></li><% if(canSchedule) { %><li><a href="#" class="schedule-pdf"><%- _("Schedule PDF Delivery").t() %><% } %></a></li></ul><% } %></p>'})}),define("views/dashboards/table/controls/CloneDashboard",["underscore","module","views/shared/Modal","views/shared/controls/ControlGroup","models/Base","models/Dashboard","views/shared/FlashMessages","util/splunkd_utils","views/dashboards/table/controls/CloneSuccess","views/shared/delegates/PairedTextControls","views/shared/controls/TextControl"],function(e,t,n,r,i,s,o,u,a,f,l){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.perms=new i({clonePermissions:!1}),this.children.flashMessages=new o({model:{dashboard:this.model.dashboard,dashboardMeta:this.model.dashboard.meta}}),this.model.dashboard.meta.set({label:this.model.dashboard.meta.get("label")+e(" Clone").t()}),this.children.titleTextControl=new l({modelAttribute:"label",model:this.model.dashboard.meta,placeholder:"optional",save:!1}),this.children.filenameTextControl=new l({modelAttribute:"name",model:this.model.dashboard.entry.content,save:!1}),this.children.filenameTextControl.setValue(u.nameFromString(this.model.dashboard.meta.get("label"))),this.pairedTextControls=new f({sourceDelegate:this.children.titleTextControl,destDelegate:this.children.filenameTextControl,transformFunction:u.nameFromString}),this.children.title=new r({controls:this.children.titleTextControl,label:e("Title").t()}),this.children.filename=new r({controls:this.children.filenameTextControl,label:e("ID").t(),help:e("Can only contain letters, numbers and underscores.").t(),tooltip:e("The ID is used as the filename on disk. Cannot be changed later.").t()}),this.children.description=new r({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1},label:e("New Description").t()}),this.children.permissions=new r({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"clonePermissions",model:this.model.perms,items:[{label:e("Private").t(),value:!1},{label:e("Clone").t(),value:!0}],save:!1},label:e("Permissions").t()})},events:$.extend({},n.prototype.events,{"click a.modal-btn-primary":function(e){e.preventDefault(),this.submit()}}),createSuccess:function(){this.collection&&this.collection.dashboards&&this.collection.dashboards.add(this.model.dashboard),e.defer(function(){var e=new a({model:{dashboard:this.model.dashboard,application:this.model.application,scheduledView:this.model.scheduledView,appLocal:this.model.appLocal,state:this.model.state,user:this.model.user},collection:this.collection});e.render().show()}.bind(this)),this.hide(),this.remove()},submit:function(){var e=this.model.dashboard;e.meta.validate();if(e.meta.isValid()){e.entry.content.get("eai:type")==="views"&&e.meta.apply();var t=this.model.perms.get("clonePermissions"),n={app:this.model.application.get("app")};n.owner=t&&this.model.acl.get("sharing")!==u.USER?u.NOBODY:this.model.application.get("owner"),e.save({},{data:n,success:function(n,r){if(t){var i=this.model.acl.toDataPayload();i.owner=this.model.application.get("owner"),e.acl.save({},{data:i,success:function(e,t){this.createSuccess()}.bind(this)})}else this.createSuccess()}.bind(this)})}},render:function(){this.$el.html(n.TEMPLATE),this.$(n.HEADER_TITLE_SELECTOR).html(e("Clone").t()),this.$(n.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(n.BODY_SELECTOR).append(n.FORM_HORIZONTAL),this.$(n.BODY_FORM_SELECTOR).append(this.children.title.render().el),this.$(n.BODY_FORM_SELECTOR).append(this.children.filename.render().el),this.$(n.BODY_FORM_SELECTOR).append(this.children.description.render().el);var t=this.model.acl.get("sharing");return(t===u.APP&&this.model.dashboard.entry.acl.get("can_share_app")||t===u.GLOBAL&&this.model.dashboard.entry.acl.get("can_share_global"))&&this.$(n.BODY_FORM_SELECTOR).append(this.children.permissions.render().el),this.$(n.FOOTER_SELECTOR).append(n.BUTTON_CANCEL),this.$(n.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Clone Dashboard").t()+"</a>"),this}})}),define("splunkjs/mvc/simplexml/dialog/dashboardtitle",["underscore","backbone","module","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,initialize:function(t){r.prototype.initialize.apply(this,arguments),this.workingModel=this.model.clone(),this.children.flashMessage=new s({model:this.model}),this.children.titleField=new i({controlType:"Text",controlOptions:{modelAttribute:"label",model:this.workingModel,placeholder:"optional"},label:e("Title").t()}),this.children.descriptionField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.workingModel,placeholder:"optional"},label:e("Description").t()})},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.set("label",this.workingModel.get("label")),this.model.set("description",this.workingModel.get("description")),this.hide(),e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Title or Description").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.titleField.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.descriptionField.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this}})}),define("splunkjs/mvc/simplexml/editdashboard/editmenu",["module","jquery","underscore","models/classicurl","views/shared/PopTart","views/shared/documentcontrols/dialogs/TitleDescriptionDialog","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/shared/documentcontrols/dialogs/DeleteDialog","uri/route","bootstrap.modal","models/Dashboard","views/dashboards/table/controls/ConvertDashboard","views/dashboards/table/controls/CloneDashboard","views/dashboards/table/controls/SchedulePDF","views/shared/dialogs/TextDialog","splunk.util","../dialog/dashboardtitle","models/services/ScheduledView","../../utils","models/ACLReadOnly"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){return i.extend({moduleId:e.id,className:"dropdown-menu",initialize:function(){i.prototype.initialize.apply(this,arguments);var e={button:!0,showOpenActions:!0,deleteRedirect:!1};n.defaults(this.options,e)},events:{"click a.edit-panels":function(e){e.preventDefault(),this.hide(),this.remove(),this.model.state.set("edit",!0)},"click a.schedule-pdf":function(e){e.preventDefault();if(t(e.currentTarget).is(".disabled"))return;this.hide(),this.remove();var n=new p({model:{scheduledView:this.model.scheduledView,dashboard:this.model.dashboard,application:this.model.application,appLocal:this.model.state.appLocal},onHiddenRemove:!0});n.render().appendTo(t("body")),n.show()},"click a.delete":function(e){e.preventDefault(),this.hide(),this.remove();var t=new d({id:"modal-delete-dashboard"});t.dialogShown=function(){this.trigger("show"),n.debounce(function(){this.$(".btn-primary:first").focus()}.bind(this),0)();return},t.settings.set("primaryButtonLabel",n("Delete").t()),t.settings.set("cancelButtonLabel",n("Cancel").t()),t.settings.set("titleLabel",n("Delete").t()),t.setText(v.sprintf(n("Are you sure you want to delete %s?").t(),"<em>"+(this.model.state.get("label")!==""?this.model.state.get("label"):this.model.dashboard.entry.get("name"))+"</em>")),t.render().appendTo(document.body),t.once("click:primaryButton",function(){this.model.dashboard.destroy().done(function(){var e=y.getPageInfo();y.redirect(a.page(e.root,e.locale,e.app,"dashboards"))})},this),t.on("hidden",function(){t.remove()},this),t.show()},"click a.edit-title-desc":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.titleDialog=new m({model:this.model.state,onHiddenRemove:!0}),t("body").append(this.children.titleDialog.render().el),this.children.titleDialog.show()},"click a.edit-perms":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.permissionsDialog=new o({model:{document:this.model.dashboard,nameModel:this.model.dashboard.entry.content,user:this.model.state.user},collection:this.collection,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0}),t("body").append(this.children.permissionsDialog.render().el),this.children.permissionsDialog.show()},"click a.convert-to-html":function(e){e.preventDefault(),this.hide(),this.remove();var n=new l;n.meta.set(this.model.dashboard.meta.toJSON());var r=this.children.convertDialog=new c({model:{dashboard:n,currentDashboard:this.model.dashboard,application:this.model.application,user:this.model.state.user},collection:{roles:this.collection},onHiddenRemove:!0});t("body").append(r.render().el),r.show()},"click a.clone":function(e){e.preventDefault(),this.hide(),this.remove();var n=new l;n.fetch({success:function(){this.model.dashboard.entry.content.get("eai:type")==="html"?n.setHTML(this.model.dashboard.entry.content.get("eai:data")):n.setXML(this.model.dashboard.entry.content.get("eai:data")),n.meta.set(this.model.dashboard.meta.toJSON());var e=this.children.cloneDialog=new h({model:{dashboard:n,acl:new b(t.extend(!0,{},this.model.dashboard.entry.acl.toJSON())),application:this.model.application,appLocal:this.model.state.appLocal,state:this.model.state,user:this.model.state.user},collection:{roles:this.collection},onHiddenRemove:!0});t("body").append(e.render().el),e.show()}.bind(this)})}},render:function(){var e=this.model.application.toJSON(),t={dashboard:this.model.dashboard.isDashboard(),editLinkViewMode:a.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:a.page(e.root,e.locale,e.app,e.page)}}),editLinkEditMode:a.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:a.page(e.root,e.locale,e.app,e.page)+"/edit"}}),dashboardType:this.model.dashboard.getViewType(),editable:this.model.state.get("editable"),canWrite:this.model.dashboard.entry.acl.canWrite(),canCangePerms:this.model.dashboard.entry.acl.get("can_change_perms"),canEditHtml:this.model.state.user.canEditViewHtml(),removable:this.model.dashboard.entry.acl.get("removable"),isXML:this.model.dashboard.isXML(),isForm:this.model.dashboard.isForm(),isSimpleXML:this.model.dashboard.isSimpleXML(),isHTML:this.model.dashboard.isHTML(),canSchedulePDF:this.model.state.user.canScheduleSearch()&&!this.model.state.user.isFree()&&(this.model.dashboard.isSimpleXML()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated"),isPdfServiceAvailable:this.model.state.get("pdf_available"),showAddTRP:!this.model.state.get("default_timerange"),_:n},r=this.compiledTemplate(t);return this.$el.html(i.prototype.template_menu),this.$el.append(r),this},template:'                <% if (canWrite && (editable || (!isHTML || canEditHtml) || (isSimpleXML && canEditHtml))) { %>                    <ul class="first-group">                        <% if(editable) { %>                        <li><a href="#" class="edit-panels"><%- _("Edit Panels").t() %></a></li>                        <% } %>                        <% if (!isHTML || canEditHtml) { %>                        <li><a href="<%- editLinkViewMode %>" class="edit-source"><%- _("Edit Source").t() %> <span class="dashboard-source-type"><%= dashboardType %></span></a></li>                        <% } %>                        <% if (isSimpleXML && canEditHtml) { %>                        <li><a href="#" class="convert-to-html"><%- _("Convert to HTML").t() %></a></li>                        <% } %>                    </ul>                    <% } %>                    <% if(canCangePerms || (canWrite && isXML) || canSchedulePDF) { %>                    <ul class="second-group">                        <% if(isXML && canWrite) { %>                        <li><a href="#" class="edit-title-desc"><%- _("Edit Title or Description").t() %></a></li>                        <% } %>                        <% if(canCangePerms) { %>                            <li><a href="#" class="edit-perms"><%- _("Edit Permissions").t() %></a></li>                        <% } %>                        <% if(canSchedulePDF) { %>                        <li>                        <% if(isForm) {%>                            <a class="schedule-pdf disabled" href="#" title="<%- _("You cannot schedule PDF delivery for a dashboard with form elements.").t() %>">                        <% } else { %>                            <a class="schedule-pdf" href="#">                        <% } %>                                <%- _("Schedule PDF Delivery").t() %>                            </a>                        </li>                        <% } %>                    </ul>                    <% } %>                    <% if ((!isHTML || canEditHtml) || (canWrite && removable)) { %>                    <ul class="third-group">                        <% if (!isHTML || canEditHtml) { %>                        <li><a href="#" class="clone"><%- _("Clone").t() %></a></li>                        <% } %>                        <% if(canWrite && removable) { %>                        <li><a href="#" class="delete"><%- _("Delete").t() %></a></li>                        <% } %>                    </ul>                <% } %>            '})}),define("splunkjs/mvc/simplexml/editdashboard/moreinfomenu",["module","jquery","underscore","models/classicurl","views/shared/PopTart","views/shared/documentcontrols/dialogs/TitleDescriptionDialog","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/shared/documentcontrols/dialogs/DeleteDialog","uri/route","bootstrap.modal","util/splunkd_utils","views/dashboards/table/controls/SchedulePDF","models/services/ScheduledView","models/Cron"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return i.extend({moduleId:e.id,className:"dropdown-menu more-info popdown-dialog",initialize:function(){i.prototype.initialize.apply(this,arguments);var e={button:!0,showOpenActions:!0,deleteRedirect:!1};n.defaults(this.options,e)},events:{"click .edit-schedule":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.schedulePDF=new c({model:{scheduledView:this.model.scheduledView,dashboard:this.model.dashboard,application:this.model.application,appLocal:this.model.state.appLocal},onHiddenRemove:!0}),t("body").append(this.children.schedulePDF.render().el),this.children.schedulePDF.show()},"click a.edit-permissions":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.permissionsDialog=new o({model:{document:this.model.dashboard,nameModel:this.model.dashboard.entry.content,user:this.model.state.user},collection:this.collection,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0}),t("body").append(this.children.permissionsDialog.render().el),this.children.permissionsDialog.show()}},render:function(){var e=this.model.scheduledView.entry.content.get("is_scheduled"),t="-",r=[],s=this.model.dashboard.entry.acl.get("sharing"),o=this.model.dashboard.entry.acl.get("owner"),u=l.getPermissionLabel(s,o),a=this.model.dashboard.entry.acl.get("app");if(e){var f=this.model.scheduledView.entry.content.get("cron_schedule"),c=f?p.createFromCronString(f):null;if(c)switch(c.get("cronType")){case"hourly":t=n("Sent Hourly").t();break;case"daily":t=n("Sent Daily").t();break;case"weekly":t=n("Sent Weekly").t();break;case"monthly":t=n("Sent Monthly").t();break;case"custom":t=n("Sent on a custom schedule").t()}r=(this.model.scheduledView.entry.content.get("action.email.to")||"").split(/\s*,\s*/)}var h={_:n,isScheduled:e,schedule:t,recipients:n(r).chain().filter(n.identity).map(function(e){return['<a href="mailto:',encodeURIComponent(e),'">',n.escape(e),"</a>"].join("")}).value(),shared:this.model.dashboard.entry.acl.get("perms"),owner:o,permissionString:u,canChangePerms:this.model.dashboard.entry.acl.get("can_change_perms"),canSchedulePDF:this.model.state.user.canScheduleSearch()&&!this.model.state.user.isFree()&&(this.model.dashboard.isSimpleXML()&&!this.model.dashboard.isForm()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated"),isPdfServiceAvailable:this.model.state.get("pdf_available"),appString:a},d=this.compiledTemplate(h);return this.$el.html(i.prototype.template_menu),this.$el.append(d),this},template:'                <div class="popdown-dialog-body">                    <div>                        <dl class="list-dotted">                            <dt class="app"><%- _("App").t() %></dt>                            <dd>                                <%= appString %>                            </dd>                            <dt class="schedule"><%- _("Schedule").t() %></dt>                            <dd>                                <% if(isScheduled) { %>                                    <%= schedule %> <%- _("to").t() %>                                     <%= recipients.join(", ") %>.                                <% } else { %>                                    <%- _("Not scheduled").t() %>.                                <% } %>                                 <% if(canSchedulePDF && isPdfServiceAvailable) { %>                                    <a href="#" class="edit-schedule"><%- _("Edit").t() %></a>                                <% } %>                             </dd>                            <dt class="permissions"><%- _("Permissions").t() %></dt>                            <dd class="edit-permissions">                                <%- _(permissionString).t() %>                                <% if(canChangePerms) { %>                                    <a href="#" class="edit-permissions"><%- _("Edit").t() %></a>                                <% } %>                         </dl>                    </div>                </div>            '})}),define("splunkjs/mvc/simplexml/editdashboard/menuview",["require","exports","module","underscore","jquery","views/Base","../dialog/addpanel","util/pdf_utils","models/Dashboard","../controller","util/console","../../../mvc","../../utils","uri/route","../../simpleform/input/timerange","splunk.config","util/splunkd_utils","./editmenu","./moreinfomenu"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/Base"),o=e("../dialog/addpanel"),u=e("util/pdf_utils"),a=e("models/Dashboard"),f=e("../controller"),l=e("util/console"),c=e("../../../mvc"),h=e("../../utils"),p=e("uri/route"),d=e("../../simpleform/input/timerange"),v=e("splunk.config"),m=e("util/splunkd_utils"),g=e("./editmenu"),y=e("./moreinfomenu"),b=s.extend({moduleId:n.id,className:"edit-menu",initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.state.on("change:edit",this.onEditModeChange,this),this.model.state.on("change:editable change:pdf_available",this.render,this),this.model.state.on("change:default_timerange",this.handleDefaultTimeRangeChange,this),this.model.state.user.on("change",this.render,this),this._ready=!1;var e=this;r.defer(function(){e._ready=!0})},events:{"click a.edit-btn":function(e){e.preventDefault();var t=i(e.currentTarget);if(this.children.editMenu&&this.children.editMenu.shown){this.children.editMenu.hide();return}this.children.moreInfoMenu&&this.children.moreInfoMenu.shown&&this.children.moreInfoMenu.hide(),t.addClass("active"),this.children.editMenu=new g({model:{application:this.model.application,dashboard:this.model.dashboard,state:this.model.state,scheduledView:this.model.scheduledView},collection:this.collection,showOpenActions:this.options.showOpenActions,deleteRedirect:this.options.deleteRedirect,onHiddenRemove:!0}),i("body").append(this.children.editMenu.render().el),this.children.editMenu.show(t),this.children.editMenu.on("hide",function(){t.removeClass("active")},this)},"click a.more-info-btn":function(e){e.preventDefault();var t=i(e.currentTarget);if(this.children.moreInfoMenu&&this.children.moreInfoMenu.shown){this.children.moreInfoMenu.hide();return}this.children.editMenu&&this.children.editMenu.shown&&this.children.editMenu.hide(),t.addClass("active"),this.children.moreInfoMenu=new y({model:{application:this.model.application,dashboard:this.model.dashboard,state:this.model.state,scheduledView:this.model.scheduledView},collection:this.collection,onHiddenRemove:!0}),i("body").append(this.children.moreInfoMenu.render().el),this.children.moreInfoMenu.show(t),this.children.moreInfoMenu.on("hide",function(){t.removeClass("active")},this)},"click a.edit-done":function(e){e.preventDefault(),this.model.state.set("edit",!1)},"click a.add-panel":function(e){e.preventDefault(),this.children.addPanelDialog=new o({controller:this.options.controller}),this.children.addPanelDialog.render().appendTo(i("body")).show()},"click a.add-trp":function(e){e.preventDefault();var t=i('<div class="input input-timerangepicker" id="field3"><label>&nbsp;</label></div>'),n=i("body>.dashboard-body>.fieldset"),r=n.find(".form-submit");r.length?t.insertBefore(r):t.appendTo(n);var s="timerange",o=1;while(c.Components.has(s))s="timerange"+o++;var u=(new d({id:"timerange",isGlobal:!0,earliest_time:"$earliest$",latest_time:"$latest$",el:t},{tokens:!0})).render();u.on("change",function(){var e=c.Components.getInstance("default"),t=c.Components.getInstance("submitted");t.set(e.toJSON())}),f.trigger("formupdate")},"click a.print-dashboard":function(e){e.preventDefault(),window.print()},"click a.generate-pdf":function(e){e.preventDefault();var t=this.model.dashboard.entry.get("name"),n=this.model.dashboard.entry.acl.get("app"),i={},s=0;r.map(c.Components.get("dashboard").getElementIds(),function(e){var t=c.Components.get(e);t&&t.getExportParams&&r.extend(i,t.getExportParams("sid_"+s)),s++}),u.isPdfServiceAvailable().done(function(e,r){if(r==="pdfgen"){var s=f.model.view.getFlattenedXML({useLoadjob:!1,indent:!1});l.DEBUG_ENABLED&&l.log(s),u.downloadReportFromXML(s,n,i)}else r==="deprecated"&&u.getRenderURL(t,n,i).done(function(e){window.open(e)})})}},onEditModeChange:function(){var e=this.model.state.get("edit");this.$(".dashboard-view-controls")[e?"hide":"show"](),this.$(".dashboard-edit-controls")[e?"show":"hide"]()},handleDefaultTimeRangeChange:function(e){if(this._ready&&this.model.state.get("edit")){var t=i("body>.dashboard-body>.fieldset").children().length>0,n=e.get("default_timerange"),r;n&&(r=n),this.model.dashboard.saveFormSettings(t,n,r)}this.render()},render:function(){var e=this.model.application.toJSON(),t={dashboard:this.model.dashboard.isDashboard(),editLinkViewMode:p.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:p.page(e.root,e.locale,e.app,e.page)}}),editLinkEditMode:p.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:p.page(e.root,e.locale,e.app,e.page)+"/edit"}}),dashboardType:this.model.dashboard.getViewType(),editable:this.model.state.get("editable"),canWrite:this.model.dashboard.entry.acl.canWrite(),removable:this.model.dashboard.entry.links.get("remove")?!0:!1,isSimpleXML:this.model.dashboard.isSimpleXML(),isHTML:this.model.dashboard.isHTML(),isPdfServiceAvailable:this.model.state.get("pdf_available"),showAddTRP:!this.model.state.get("default_timerange"),_:r};return this.$el.html(this.compiledTemplate(t)),this.$(".generate-pdf").tooltip({animation:!1,title:r("Export PDF").t()}),this.$(".print-dashboard").tooltip({animation:!1,title:r("Print").t()}),this.onEditModeChange(),this},template:'            <span class="dashboard-view-controls">                <% if(canWrite) { %>                    <div class="btn-group">                        <a class="btn edit-btn" href="#"><%- _("Edit").t() %> <span class="caret"></span></a>                        <a class="btn more-info-btn" href="#"><%- _("More Info").t() %> <span class="caret"></span></a>                    </div>                <% }else{ %>                    <div class="btn-group">                        <a class="btn edit-btn" href="#"><%- _("Edit").t() %> <span class="caret"></span></a>                    </div>                <% } %>                <div class="btn-group">                    <% if(isSimpleXML && isPdfServiceAvailable) { %>                        <a class="btn generate-pdf" href="#"><i class="icon-export icon-large"></i></a>                    <% } %>                        <a class="btn print-dashboard" href="#"><i class="icon-print icon-large"></i></a>                </div>            </span>            <span class="dashboard-edit-controls" style="display:none;">                <div class="btn-group">                    <a class="btn add-panel" href="#"><i class="icon-plus"></i> <%- _("Add Panel").t() %></a>                     <% if(showAddTRP) { %>                        <a class="btn add-trp" href="#"><i class="icon-clock"></i> <%- _("Add Time Range Picker").t() %></a>                     <% } %>                    <a class="btn edit-source" href="<%- editLinkEditMode %>"><i class="icon-code"></i> <%- _("Edit Source").t() %></a>                 </div>                <a class="btn btn-primary edit-done" href="#"><%- _("Done").t() %></a>            </span>        '});return b}),define("splunkjs/mvc/simplexml/editdashboard/master",["require","exports","module","underscore","jquery","views/Base","collections/services/authorization/Roles","./menuview"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/Base"),o=e("collections/services/authorization/Roles"),u=e("./menuview");return s.extend({className:"splunk-dashboard-controls",initialize:function(){s.prototype.initialize.apply(this,arguments),this.rolesCollection=new o,this.rolesCollection.fetch(),this.children.menuView=new u({model:{state:this.model.state,dashboard:this.model.dashboard,application:this.model.application,scheduledView:this.model.scheduledView},collection:this.rolesCollection,controller:this.options.controller})},render:function(){return this.$el.append(this.children.menuView.render().el),this}})}),define("splunkjs/mvc/simplexml/dragndrop",["require","backbone","underscore","jquery","util/console"],function(e){var t=e("backbone"),n=e("underscore"),r=e("jquery"),i=e("util/console"),s=r.Deferred(),o=document.createElement("div"),u="draggable"in o||"ondragstart"in o&&"ondrop"in o,a=!1,f=a?"sortable5":"sortable";return a?(i.log("loading html5 sortable"),e(["splunkjs/contrib/jquery.sortable.html5"],s.resolve)):(i.log("loading jquery ui sortable"),e(["jquery.ui.sortable"],s.resolve)),t.View.extend({render:function(){return s.done(this.startDragAndDrop.bind(this)),this},events:{"mouseover .drag-handle":function(e){r(e.target).parents(".dashboard-panel").addClass("drag-hover")},"mouseout .drag-handle":function(e){r(e.target).parents(".dashboard-panel").removeClass("drag-hover")}},startDragAndDrop:function(){this.$el.addClass("dragndrop-enabled"),n.defer(this.enableDragAndDrop.bind(this))},enableDragAndDrop:function(){var e=this,t,s=n.debounce(e.updateDimensions.bind(this),0),o=this.enableDragAndDrop.bind(this),u=n.once(function(){i.log("sort STOP");if(t){try{t[f]("destroy")}catch(s){}n.defer(o),e.trigger("sortupdate"),t=null,r(window).trigger("resize")}});this.createNewDropRow(),t=this.$(".dashboard-row")[f]({handle:".drag-handle",connectWith:this.$(".dashboard-row"),placeholder:{element:function(){return r('<div class="sortable-placeholder"><div class="dashboard-panel"></div></div>')},update:function(t,n){e.updateRow(n.parents(".dashboard-row"))}},tolerance:"pointer"}).on("sort",function(e){s()}).on("sortupdate",function(e){u()}).on("stop",function(e){u()}),s(),r(window).trigger("resize")},destroy:function(){this.$el.removeClass("dragndrop-enabled"),this.cleanupEmptyRows();try{this.$(".dashboard-row")[f]("destroy")}catch(e){}this.updateDimensions()},updateRow:function(e){var t=r(e).children().not(".ui-sortable-helper"),i=String(Math.floor(1e4/t.not(".sortable-dragging").length)/100)+"%";t.css({width:i});var s=r(e).find(".dashboard-panel");s.css({"min-height":100}).css({"min-height":n.max(n.map(s,function(e){return r(e).height()}))})},updateDimensions:function(){n(this.$(".dashboard-row")).each(this.updateRow)},createNewDropRow:function(){this.cleanupEmptyRows(),this.$(".dashboard-row").after(r('<div class="dashboard-row empty"></div>')),this.$(".dashboard-row").first().before(r('<div class="dashboard-row empty"></div>'))},cleanupEmptyRows:function(){this.$(".dashboard-row").each(function(){var e=r(this);(e.is(":empty")||e.html().match(/^\s+$/))&&e.remove()}),this.$(".dashboard-row.empty").removeClass("empty")},getItemOrder:function(){return n(this.$(".dashboard-row")).map(function(e){return n(r(e).find(".dashboard-panel")).map(function(e){return n(r(e).find(".dashboard-element")).map(function(e){return r(e).attr("id")})})})}})}),define("splunkjs/mvc/simpleform/fieldsetview",["require","exports","module","underscore","jquery","views/Base","../simplexml/controller"],function(e,t){var n=e("underscore"),r=e("jquery"),i=e("views/Base"),s=e("../simplexml/controller");return i.extend({moduleId:t.id,className:"fieldset",initialize:function(){s.on("formupdate",this.render,this),i.prototype.initialize.apply(this,arguments)},render:function(){return n.any(this.$el.find("label"),function(e){var t=r(e).text();return!!r.trim(t)})?this.$el.removeClass("hide-label"):this.$el.addClass("hide-label"),this}})}),define("splunkjs/mvc/simplexml/dashboard/title",["require","underscore","jquery","backbone"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=r.View.extend({initialize:function(){this.model.on("change:edit change:label",this.render,this)},render:function(){return this.model.has("label")||this.model.set({label:this.$el.text()},{silent:!0}),this.$(".edit-label").remove(),this.$el.text(t(this.model.get("label")).t()),this.model.get("edit")&&n('<span class="edit-label">'+t("Edit").t()+": </span>").prependTo(this.$el),this}});return i}),define("splunkjs/mvc/simplexml/dashboard/description",["require","underscore","backbone"],function(e){var t=e("underscore"),n=e("backbone");return n.View.extend({initialize:function(){this.listenTo(this.model,"change:description",this.render,this),this.listenTo(this.model,"change:edit",this.render,this)},render:function(){if(this.model.has("description")){var e=t(this.model.get("description")||"").t(),n=this.model.get("edit");this.$el.text(e)[e&&!n?"show":"hide"]()}return this}})}),define("splunkjs/mvc/simplexml/dashboard/row",["require","underscore","jquery","backbone"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone");return r.View.extend({events:{cellRemoved:"onContentChange"},initialize:function(){this.listenTo(this.model,"change:edit",this.onEditStateChange,this)},onEditStateChange:function(){this.$el.off("DOMSubtreeModified");if(!this.model.get("edit")&&this.$(".dashboard-panel").length>1){var e=t.debounce(this.alignItemHeights.bind(this),1e3);this.$el.bind("DOMSubtreeModified",e),e()}},onContentChange:function(){this.$el.off("DOMSubtreeModified");var e=this.$(".dashboard-cell");if(e.length===0)return this.remove();e.css({width:String(100/e.length)+"%"}).find(".panel-element-row").each(function(){var e=n(this).find(".dashboard-element");e.css({width:String(100/e.length)+"%"})}),e.length>1&&this.alignItemHeights(),this.onEditStateChange()},alignItemHeights:function(){var e=this.$el,r=e.find(".dashboard-panel");r.css({"min-height":0}).css({"min-height":t.max(t.map(r,function(e){return n(e).height()}))})},render:function(){return this.onEditStateChange(),this}})}),define("splunkjs/mvc/simplexml/dashboard/panel",["require","jquery","backbone"],function(e){var t=e("jquery"),n=e("backbone");return n.View.extend({initialize:function(){this.listenTo(this.model,"change:edit",this.onEditStateChange,this)},onEditStateChange:function(e){e.get("edit")?(this._dragHandle||(this._dragHandle=t('<div class="drag-handle"><div class="handle-inner"></div></div>')),this._dragHandle.prependTo(this.el)):this._dragHandle&&this._dragHandle.detach()},render:function(){return this.onEditStateChange(this.model),this}})}),define("splunkjs/mvc/simplexml/dashboard",["require","../basesplunkview","../mvc","underscore","jquery","./controller","./editdashboard/master","./dragndrop","util/console","../simpleform/fieldsetview","./dashboard/title","./dashboard/description","./dashboard/row","./dashboard/panel","models/services/ScheduledView"],function(e){var t=e("../basesplunkview"),n=e("../mvc"),r=e("underscore"),i=e("jquery"),s=e("./controller"),o=e("./editdashboard/master"),u=e("./dragndrop"),a=e("util/console"),f=e("../simpleform/fieldsetview"),l=e("./dashboard/title"),c=e("./dashboard/description"),h=e("./dashboard/row"),p=e("./dashboard/panel"),d=e("models/services/ScheduledView"),v=t.extend({initialize:function(){this.model=s.getStateModel(),this.model.scheduledView=new d,this.scheduledViewDfd=i.Deferred(),s.onViewModelLoad(function(){var e=this.model.scheduledView.findByName(this.model.view.entry.get("name"),this.model.app.get("app"),this.model.app.get("owner"));e.done(r.bind(this.scheduledViewDfd.resolve,this.scheduledViewDfd)),e.fail(r.bind(this.scheduledViewDfd.reject,this.scheduledViewDfd))},this),this.editControls=new o({model:{state:this.model,dashboard:this.model.view,application:this.model.app,scheduledView:this.model.scheduledView},controller:s}),this.model.on("change:edit",this.onEditStateChange,this)},render:function(){var e=this.model;this.rows=r.map(this.$(".dashboard-row"),function(t){return(new h({el:t,model:e})).render()}),this.titleView=(new l({model:this.model,el:this.$(".dashboard-header h2")})).render();var t=this.$("p.description");t.length||(t=i('<p class="description"></p>').appendTo(this.$(".dashboard-header")).hide()),this.descriptionView=(new c({el:t,model:e})).render();var n=this.$el.children(".fieldset");n.length||(n=i('<div class="fieldset"></div>').insertAfter(this.$(".dashboard-header"))),this.fieldsetView=(new f({el:n})).render();var s=i('<div class="edit-dashboard-menu pull-right"></div>').prependTo(this.$(".dashboard-header"));return i.when(this.scheduledViewDfd).then(function(){this.editControls.render().appendTo(s)}.bind(this)),this.panels=r(this.$(".dashboard-panel")).map(function(t){return(new p({el:t,model:e})).render()}),this.onEditStateChange(),r.defer(function(){i("body").removeClass("preload")}),this.model.view.captureItemOrder(this.getItemOrder()),this},getController:function(){return s},getStateModel:function(){return this.model},getItemOrder:function(){return r(this.$(".dashboard-row")).map(function(e){return r(i(e).find(".dashboard-panel")).map(function(e){return r(i(e).find(".dashboard-element")).map(function(e){return i(e).attr("id")})})})},getElementIds:function(){return r.flatten(this.getItemOrder())},enterEditMode:function(){this.leaveEditMode(),this.model.get("editable")?(a.log("Entering edit mode"),this.dragnDrop=new u({el:this.el}),this.model.view.captureItemOrder(this.getItemOrder()),this.dragnDrop.on("sortupdate",r.debounce(this.updatePanelOrder,0),this),this.dragnDrop.render()):(a.log("Aborting edit mode: Dashboard is not editable"),this.model.set("edit",!1))},updatePanelOrder:function(){this.model.view.setItemOrder(this.getItemOrder())},leaveEditMode:function(){this.dragnDrop&&(this.dragnDrop.off(),this.dragnDrop.destroy(),this.updatePanelOrder(),this.dragnDrop=null)},onEditStateChange:function(){this.model.get("edit")?s.onViewModelLoad(this.enterEditMode,this):this.leaveEditMode()},removeElement:function(e){var t=this.$("#"+e),n=t.parents(".dashboard-row");if(t.siblings(".dashboard-element").length)t.remove();else{var r=t.parents(".panel-element-row");r.siblings(".panel-element-row").length?r.remove():t.parents(".dashboard-cell").remove()}n.trigger("cellRemoved")},createNewElement:function(e){var t=i(r.template(this.rowTemplate,e));return t.appendTo(this.$el),this.rows.push((new h({el:t,model:this.model})).render()),this.panels.push((new p({el:t.find(".dashboard-panel"),model:this.model})).render()),t.find(".dashboard-element")},rowTemplate:'  <div class="dashboard-row">                            <div class="dashboard-cell" style="width: 100%;">                                <div class="dashboard-panel clearfix">                                    <div class="panel-element-row">                                        <div class="dashboard-element" id="<%= id %>" style="width: 100%">                                            <div class="panel-head"><h3><%- title %></h3></div>                                            <div class="panel-body"></div>                                        </div>                                    </div>                                </div>                            </div>                        </div>'});return v}),define("splunkjs/mvc/simplexml/element/table",["require","underscore","jquery","backbone","../../../mvc","./base","../../tableview","util/console","../mapper","splunk.util"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../tableview"),u=e("util/console"),a=e("../mapper"),f=e("splunk.util"),l=a.extend({tagName:"table",map:function(e,n,r){n.options.wrap=String(f.normalizeBoolean(e.get("display.statistics.wrap",r))),n.options.rowNumbers=String(f.normalizeBoolean(e.get("display.statistics.rowNumbers",r))),n.options.dataOverlayMode=e.get("display.statistics.overlay",r),n.options.drilldown=e.get("display.statistics.drilldown",r),n.options.count=e.get("display.prefs.statistics.count",r),n.options.labelField=null,n.options.valueField=null;var i=e.get("display.statistics.fields",r);n.tags.fields=t.isArray(i)?t.isEmpty(i)?null:JSON.stringify(i):i==="[]"?null:i,n.options.drilldown===!1?delete n.options.drilldown:n.options.drilldown===!0&&(n.options.drilldown="row")}});a.register("statistics",l);var c=o.extend({panelClassName:"table",prefix:"display.statistics.",reportDefaults:{"display.general.type":"statistics","display.prefs.statistics.count":10,"display.statistics.drilldown":"cell"},getResultsLinkOptions:function(e){return{}}});s.registerVisualization("statistics",c);var h=s.extend({initialVisualization:"statistics"});return h}),define("splunkjs/mvc/simplexml/element/chart",["require","underscore","jquery","backbone","../../../mvc","./base","../../chartview","../mapper","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../chartview"),u=e("../mapper"),a=e("util/console"),f="display.visualizations.charting.",l="display.visualizations.";u.register("visualizations:charting",u.extend({tagName:"chart",map:function(e,n,r){t(e.toJSON(r)).each(function(t,i){i.substring(0,f.length)===f&&(n.options[i.substring(l.length)]=e.get(i,r))}),r["charting.drilldown"]&&(n.removeOptions=["drilldown"])}}));var c=o.extend({panelClassName:"chart",reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"charting","display.general.type":"visualizations"},options:t.defaults({resizable:!0},o.prototype.options),getResultsLinkOptions:function(){return{}}});s.registerVisualization("visualizations:charting",c),s.registerVisualization("visualizations",c);var h=s.extend({initialVisualization:"visualizations:charting"});return h}),define("splunkjs/mvc/simplexml/element/event",["require","underscore","jquery","backbone","../../../mvc","./base","../../eventsviewerview","../mapper","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../eventsviewerview"),u=e("../mapper"),a=e("util/console"),f="display.events.",l=u.extend({tagName:"event",map:function(e,n,r){n.options.count=e.get("display.prefs.events.count",r),t(e.toJSON(r)).each(function(i,s){if(s.indexOf(f)===0){var o=e.get(s,r);t.isArray(o)&&(o=JSON.stringify(o)),n.options[s.substring(f.length)]=o!=null?String(o):null}})}});u.register("events:raw",l),u.register("events:list",l),u.register("events:table",l);var c=o.extend({reportDefaults:{"display.general.type":"events","display.prefs.events.count":10},getResultsLinkOptions:function(){return{}}});s.registerVisualization("events",c),s.registerVisualization("events:raw",c),s.registerVisualization("events:list",c),s.registerVisualization("events:table",c);var h=s.extend({initialVisualization:"events"});return h}),define("splunkjs/mvc/simplexml/element/single",["require","underscore","../../../mvc","./base","../../singleview","../mapper","util/console"],function(e){var t=e("underscore"),n=e("../../../mvc"),r=e("./base"),i=e("../../singleview"),s=e("../mapper"),o=e("util/console");s.register("visualizations:singlevalue",s.extend({tagName:"single",map:function(e,n,r){var i="display.visualizations.singlevalue.";o.log(e.toJSON(r)),t(e.toJSON(r)).each(function(e,t){t.substring(0,i.length)===i&&(n.options[t.substring(i.length)]=e)}),o.log("single export options: ",n.options)}}));var u=i.extend({panelClassName:"single",reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"singlevalue","display.general.type":"visualizations"},getResultsLinkOptions:function(e){return{"link.visible":!1}}});r.registerVisualization("visualizations:singlevalue",u);var a=r.extend({initialVisualization:"visualizations:singlevalue"});return a}),define("splunkjs/mvc/simplexml/element/map",["require","underscore","jquery","backbone","../../../mvc","./base","../../splunkmapview","../mapper","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../splunkmapview"),u=e("../mapper"),a=e("util/console"),f="display.visualizations.mapping.",l="display.visualizations.";u.register("visualizations:mapping",u.extend({tagName:"map",map:function(e,n,r){t(e.toJSON()).each(function(t,i){i.substring(0,f.length)===f&&(n.options[i.substring(l.length)]=e.get(i,r))})}}));var c=o.extend({panelClassName:"map",options:t.defaults({drilldown:!0,resizable:!0},o.prototype.options),reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"mapping","display.general.type":"visualizations"},getResultsLinkOptions:function(){return{}}});s.registerVisualization("visualizations:mapping",c);var h=s.extend({initialVisualization:"visualizations:mapping",createPanelElementEditor:function(){}});return h}),define("splunkjs/mvc/simplexml/element/list",["require","underscore","jquery","backbone","../../../mvc","./base","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("util/console"),u=s.extend({initialVisualization:"statistics",constructor:function(e){return t.extend(e,{displayRowNumbers:!1,fields:[e.labelField||"",e.valueField||""],sortKey:e.initialSort||e.labelField,sortDirection:e.initialSortDir||"asc"}),o.log("[%o] Creating table with options: %o",e.id,e),s.prototype.constructor.call(this,e)}});return u}),define("splunkjs/mvc/simplexml/element/html",["require","underscore","jquery","backbone","../../../mvc","../../utils","./base","../controller","../../tokenutils","splunk.util"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("../../utils"),o=e("./base"),u=e("../controller"),a=e("../../tokenutils"),f=e("splunk.util"),l=o.extend({configure:function(){this.options.settingsOptions=t.extend({tokenEscaper:a.getEscaper("html")},this.options.settingsOptions||{}),o.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.model=new r.Model,this.reportReady=n.Deferred(),this.reportReady.resolve(this.model),this.model.mapToXML=t.bind(this.mapToXML,this),this.settings.on("change",this.render,this),this.listenTo(u.getStateModel(),"change:edit",this.onEditModeChange,this)},mapToXML:function(e,t,n){return{type:"html",content:this.settings.get("html",n),cdata:!0,attributes:{encoded:"1"}}},updateTitle:function(){this.$(".panel-head").remove(),u.isEditMode()&&n('<div class="panel-head"><h3><span class="untitled">HTML Panel</span></h3></div>').prependTo(this.$el)},createPanelElementEditor:function(){},createRefreshTimeIndicator:function(){},render:function(){return this.$("script").remove(),this.settings.has("html")||this.settings.set("html",n.trim(this.$(".panel-body").html()),{tokens:!0}),this.$(".panel-body").html(this.settings.get("html")),this.$("a").each(function(){var e=n(this),t=e.attr("href");t&&t[0]==="/"&&t[1]!=="/"&&e.attr("href",f.make_url(t))}),this.onEditModeChange(u.getStateModel()),this},getExportParams:function(){return{}}});return l}),define("splunkjs/mvc/simplexml/urltokenmodel",["require","exports","module","../basetokenmodel","models/classicurl","./controller","underscore","util/general_utils"],function(e,t,n){var r=e("../basetokenmodel"),i=e("models/classicurl"),s=e("./controller"),o=e("underscore"),u=e("util/general_utils"),a=r.extend({moduleId:n.id,initialize:function(){i.on("change",function(e,t){this.set(e.toJSON())},this),this.set(i.toJSON()),s.router.on("route",function(){this.trigger("url:navigate")},this)},save:function(e,t){var n={};this.set(e),o.each(this.toJSON(),function(e,t){o.isObject(e)||(n[t]=e)}),i.save(n,t)},saveOnlyWithPrefix:function(e,t,n){var r=["^"+e+".*","^earliest$","^latest$"];this.save(u.filterObjectByRegexes(t,r,{allowEmpty:!0}),n)}});return a}),define("splunkjs/mvc/simpleform/input/submit",["require","underscore","jquery","../../basesplunkview","../../mvc"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../../basesplunkview"),i=e("../../mvc"),s=r.extend({className:"splunk-submit-button",options:{text:t("Search").t(),useIcon:!1,submitType:undefined},events:{"click button":"onButtonClick"},initialize:function(){this.configure(),this.settings.on("change",this.render,this)},onButtonClick:function(){this.trigger("submit",this)},render:function(){var e=this.$("button");return e.length||(e=n('<button class="btn btn-primary"></button>').appendTo(this.el)),this.settings.get("useIcon")?e.html('<i class="icon-search"></i>'):this.settings.has("text")?e.text(this.settings.get("text")):this.settings.set("text",e.text()),this}});return s}),define("splunkjs/mvc/simpleform/input/text",["require","underscore","jquery","./base","../../textinputview"],function(e){var t=e("underscore"),n=e("jquery"),r=e("./base"),i=e("../../textinputview"),s=r.extend({initialize:function(){var e=t.defaults({el:n('<div class="splunk-view"></div>').appendTo(this.el),id:t.uniqueId(this.id+"-input")},this.options);this.textbox=new i(e),this.textbox.on("change",this.handleChange,this),this.options.settings=this.textbox.settings,r.prototype.initialize.call(this,{inputId:this.textbox.getInputId()}),this.delegateEvents({"change input":"handleChange","keyup input":"checkEnterKey"})},getValue:function(){return this.textbox.val()},setValue:function(e){this.textbox.val(e)},render:function(){return this.renderLabel(),this.textbox.render(),this},_getWrappedView:function(){return this.textbox},checkEnterKey:function(e){e.keyCode===13&&this.submit()}});return s}),define("splunkjs/mvc/simpleform/input/dropdown",["require","underscore","jquery","./base","../../dropdownview"],function(e){var t=e("underscore"),n=e("jquery"),r=e("./base"),i=e("../../dropdownview"),s=r.extend({initialize:function(){var e=t.defaults({el:n('<div class="splunk-view"></div>').appendTo(this.el),id:t.uniqueId(this.id+"-input")},this.options);this.select=new i(e),this.select.on("change",this.handleChange,this),this.options.settings=this.select.settings,r.prototype.initialize.call(this,{inputId:e.id})},getValue:function(){return this.select.val()},setValue:function(e){this.select.val(e)},render:function(){return this.renderLabel(),this.select.render(),this},_getWrappedView:function(){return this.select}});return s}),define("splunkjs/mvc/simpleform/input/radiogroup",["require","underscore","jquery","./base","../../radiogroupview"],function(e){var t=e("underscore"),n=e("jquery"),r=e("./base"),i=e("../../radiogroupview"),s=r.extend({events:{"change input":"handleChange"},initialize:function(){var e=t.defaults({el:n('<div class="splunk-view"></div>').appendTo(this.el),id:t.uniqueId(this.id+"-input")},this.options);this.radiogroup=new i(e),this.options.settings=this.radiogroup.settings,r.prototype.initialize.call(this,{inputId:e.id})},getValue:function(){return this.radiogroup.val()},setValue:function(e){this.radiogroup.settings.set("default",e),this.radiogroup.val(e)},render:function(){return this.renderLabel(),this.radiogroup.render(),this},_getWrappedView:function(){return this.radiogroup}});return s}),define("splunkjs/mvc/simpleform/input",["require","./input/submit","./input/text","./input/dropdown","./input/radiogroup","./input/timerange","./input/submit","./input/text","./input/dropdown","./input/radiogroup","./input/timerange"],function(e){return{SubmitButton:e("./input/submit"),TextInput:e("./input/text"),DropdownInput:e("./input/dropdown"),RadioGroupInput:e("./input/radiogroup"),TimeRangeInput:e("./input/timerange"),Submit:e("./input/submit"),Text:e("./input/text"),Dropdown:e("./input/dropdown"),Radio:e("./input/radiogroup"),TimeRangePicker:e("./input/timerange")}}),define("splunkjs/mvc/simplexml",["require","./simplexml/controller","./simplexml/dashboard","./simplexml/element/table","./simplexml/element/chart","./simplexml/element/event","./simplexml/element/single","./simplexml/element/map","./simplexml/element/list","./simplexml/element/html","./simplexml/urltokenmodel","./searchmanager","./savedsearchmanager","./postprocessmanager","./drilldown","./headerview","./footerview","./simpleform/input","./simpleform/input/submit","./simpleform/input/text","./simpleform/input/dropdown","./simpleform/input/radiogroup","./simpleform/input/timerange","./utils"],function(e){var t=e("./simplexml/controller");return e("./simplexml/dashboard"),e("./simplexml/element/table"),e("./simplexml/element/chart"),e("./simplexml/element/event"),e("./simplexml/element/single"),e("./simplexml/element/map"),e("./simplexml/element/list"),e("./simplexml/element/html"),e("./simplexml/urltokenmodel"),e("./searchmanager"),e("./savedsearchmanager"),e("./postprocessmanager"),e("./drilldown"),e("./headerview"),e("./footerview"),e("./simpleform/input"),e("./simpleform/input/submit"),e("./simpleform/input/text"),e("./simpleform/input/dropdown"),e("./simpleform/input/radiogroup"),e("./simpleform/input/timerange"),e("./utils"),t});